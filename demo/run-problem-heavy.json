{
  "meta": {
    "tool": "lz-assessor",
    "run_id": "DEMO-PROBLEM-HEAVY-ALZ",
    "timestamp": "2026-01-15T00:00:00+00:00",
    "total_controls": 243,
    "subscription_ids": [
      "00000000-0000-0000-0000-000000000000"
    ]
  },
  "execution_context": {
    "tenant_id": "00000000-0000-0000-0000-000000000001",
    "subscription_count_visible": 1,
    "management_group_access": true,
    "identity_type": "User"
  },
  "limitations": [
    "Multiple subscriptions returned AccessDenied on Resource Graph queries",
    "Defender for Cloud API returned 404 — plans status unknown",
    "Management Group hierarchy partially visible — Reader role may be insufficient",
    "Key Vault diagnostics probe timed out on 2 vaults"
  ],
  "scoring": {
    "automation_coverage": {
      "total_controls": 243,
      "automated_controls": 167,
      "manual_controls": 76,
      "automation_percent": 68.7,
      "data_driven": 167,
      "requires_customer_input": 76
    },
    "overall_maturity_percent": 0.6,
    "section_scores": [
      {
        "section": "Networking",
        "counts": {
          "Fail": 5
        },
        "automated_controls": 5,
        "automated_pass": 0,
        "automated_fail": 5,
        "total_controls": 5,
        "maturity_percent": 0.0
      },
      {
        "section": "Security",
        "counts": {
          "Fail": 25,
          "Manual": 8
        },
        "automated_controls": 25,
        "automated_pass": 0,
        "automated_fail": 25,
        "total_controls": 33,
        "maturity_percent": 0.0
      },
      {
        "section": "Azure Billing and Microsoft Entra ID Tenants",
        "counts": {
          "Manual": 6,
          "Fail": 9
        },
        "automated_controls": 9,
        "automated_pass": 0,
        "automated_fail": 9,
        "total_controls": 15,
        "maturity_percent": 0.0
      },
      {
        "section": "Identity and Access Management",
        "counts": {
          "Manual": 8,
          "Fail": 14
        },
        "automated_controls": 14,
        "automated_pass": 0,
        "automated_fail": 14,
        "total_controls": 22,
        "maturity_percent": 0.0
      },
      {
        "section": "Resource Organization",
        "counts": {
          "Manual": 4,
          "Fail": 10
        },
        "automated_controls": 10,
        "automated_pass": 0,
        "automated_fail": 10,
        "total_controls": 14,
        "maturity_percent": 0.0
      },
      {
        "section": "Network Topology and Connectivity",
        "counts": {
          "Manual": 36,
          "Fail": 62
        },
        "automated_controls": 62,
        "automated_pass": 0,
        "automated_fail": 62,
        "total_controls": 98,
        "maturity_percent": 0.0
      },
      {
        "section": "Management",
        "counts": {
          "Fail": 18,
          "Manual": 7
        },
        "automated_controls": 18,
        "automated_pass": 0,
        "automated_fail": 18,
        "total_controls": 25,
        "maturity_percent": 0.0
      },
      {
        "section": "Platform Automation and DevOps",
        "counts": {
          "Fail": 8,
          "Manual": 5
        },
        "automated_controls": 8,
        "automated_pass": 0,
        "automated_fail": 8,
        "total_controls": 13,
        "maturity_percent": 0.0
      },
      {
        "section": "Governance",
        "counts": {
          "Partial": 1,
          "Fail": 14,
          "Pass": 1,
          "Manual": 2
        },
        "automated_controls": 16,
        "automated_pass": 1,
        "automated_fail": 14,
        "total_controls": 18,
        "maturity_percent": 6.2
      }
    ],
    "top_failing_sections": [
      {
        "section": "Network Topology and Connectivity",
        "counts": {
          "Manual": 36,
          "Fail": 62
        },
        "automated_controls": 62,
        "automated_pass": 0,
        "automated_fail": 62,
        "total_controls": 98,
        "maturity_percent": 0.0
      },
      {
        "section": "Security",
        "counts": {
          "Fail": 25,
          "Manual": 8
        },
        "automated_controls": 25,
        "automated_pass": 0,
        "automated_fail": 25,
        "total_controls": 33,
        "maturity_percent": 0.0
      },
      {
        "section": "Management",
        "counts": {
          "Fail": 18,
          "Manual": 7
        },
        "automated_controls": 18,
        "automated_pass": 0,
        "automated_fail": 18,
        "total_controls": 25,
        "maturity_percent": 0.0
      },
      {
        "section": "Identity and Access Management",
        "counts": {
          "Manual": 8,
          "Fail": 14
        },
        "automated_controls": 14,
        "automated_pass": 0,
        "automated_fail": 14,
        "total_controls": 22,
        "maturity_percent": 0.0
      },
      {
        "section": "Governance",
        "counts": {
          "Partial": 1,
          "Fail": 14,
          "Pass": 1,
          "Manual": 2
        },
        "automated_controls": 16,
        "automated_pass": 1,
        "automated_fail": 14,
        "total_controls": 18,
        "maturity_percent": 6.2
      }
    ],
    "most_impactful_gaps": [
      {
        "control_id": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
        "section": "Management",
        "question": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 15.0,
        "weight": 3.6
      },
      {
        "control_id": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
        "section": "Network Topology and Connectivity",
        "question": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
        "status": "Fail",
        "severity": "Critical",
        "evidence_count": 1,
        "risk_score": 14.9,
        "weight": 3.5
      },
      {
        "control_id": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
        "section": "Network Topology and Connectivity",
        "question": "Delegate subnet creation to the landing zone owner.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.9,
        "weight": 4.0
      },
      {
        "control_id": "4348bf81-7573-4512-8f46-9061cc198fea",
        "section": "Identity and Access Management",
        "question": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.8,
        "weight": 3.8
      },
      {
        "control_id": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
        "section": "Resource Organization",
        "question": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.8,
        "weight": 2.2
      },
      {
        "control_id": "36a72a48-fffe-4c40-9747-0ab5064355ba",
        "section": "Security",
        "question": "Defender for Servers",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.6,
        "weight": 4.0
      },
      {
        "control_id": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
        "section": "Network Topology and Connectivity",
        "question": "Use Azure Bastion in a subnet /26 or larger.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.6,
        "weight": 2.3
      },
      {
        "control_id": "d581a947-69a2-4783-942e-9df3664324c8",
        "section": "Network Topology and Connectivity",
        "question": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.6,
        "weight": 2.2
      },
      {
        "control_id": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
        "section": "Network Topology and Connectivity",
        "question": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.6,
        "weight": 3.6
      },
      {
        "control_id": "cfe363b5-f579-4284-bc56-a42153e4c10b",
        "section": "Platform Automation and DevOps",
        "question": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.6,
        "weight": 2.6
      },
      {
        "control_id": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
        "section": "Resource Organization",
        "question": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
        "status": "Fail",
        "severity": "Critical",
        "evidence_count": 1,
        "risk_score": 14.4,
        "weight": 2.3
      },
      {
        "control_id": "6cc0ea22-42bb-441e-a345-804ab0a09666",
        "section": "Resource Organization",
        "question": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
        "status": "Fail",
        "severity": "High",
        "evidence_count": 1,
        "risk_score": 14.4,
        "weight": 3.9
      },
      {
        "control_id": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
        "section": "Platform Automation and DevOps",
        "question": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
        "status": "Fail",
        "severity": "Critical",
        "evidence_count": 1,
        "risk_score": 14.4,
        "weight": 1.6
      },
      {
        "control_id": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
        "section": "Identity and Access Management",
        "question": "Use Microsoft Entra groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
        "status": "Fail",
        "severity": "Critical",
        "evidence_count": 1,
        "risk_score": 14.3,
        "weight": 3.4
      },
      {
        "control_id": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
        "section": "Management",
        "question": "Use Azure Monitor Logs for insights and reporting.",
        "status": "Fail",
        "severity": "Critical",
        "evidence_count": 1,
        "risk_score": 14.3,
        "weight": 2.3
      }
    ]
  },
  "rollups": {
    "Networking": {
      "Fail": 5
    },
    "Governance": {
      "Partial": 1,
      "Fail": 14,
      "Pass": 1,
      "Manual": 2
    },
    "Security": {
      "Fail": 25,
      "Manual": 8
    },
    "Azure Billing and Microsoft Entra ID Tenants": {
      "Manual": 6,
      "Fail": 9
    },
    "Identity and Access Management": {
      "Manual": 8,
      "Fail": 14
    },
    "Resource Organization": {
      "Manual": 4,
      "Fail": 10
    },
    "Network Topology and Connectivity": {
      "Manual": 36,
      "Fail": 62
    },
    "Management": {
      "Fail": 18,
      "Manual": 7
    },
    "Platform Automation and DevOps": {
      "Fail": 8,
      "Manual": 5
    }
  },
  "results": [
    {
      "control_id": "e6c4cfd3-e504-4547-a244-7ec66138a720",
      "category": "Networking",
      "section": "Networking",
      "text": "Azure Firewall Presence",
      "question": "Azure Firewall Presence",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": "resource_graph:azure_firewall",
      "confidence": "High",
      "notes": "No Azure Firewall resources detected in visible subscriptions."
    },
    {
      "control_id": "e8bbac75-7155-49ab-a153-e8908ae28c84",
      "category": "Networking",
      "section": "Networking",
      "text": "Hub-Spoke Topology",
      "question": "Hub-Spoke Topology",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": "resource_graph:vnets, resource_graph:azure_firewall",
      "confidence": "High",
      "notes": "No hub VNet or Azure Firewall detected. Hub-spoke topology may not be implemented."
    },
    {
      "control_id": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
      "category": "Networking",
      "section": "Networking",
      "text": "Public IP Governance",
      "question": "Public IP Governance",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "resource",
          "resource_id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MyIoTHubRG/providers/Microsoft.Network/publicIPAddresses/defenderforIot-ip",
          "summary": "defenderforIot-ip",
          "properties": {
            "resourceGroup": "myiothubrg",
            "location": "eastus2",
            "sku": "Standard",
            "allocationMethod": "Static",
            "associatedTo": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MyIoTHubRG/providers/Microsoft.Network/networkInterfaces/defenderforiot694/ipConfigurations/ipconfig1"
          }
        }
      ],
      "signal_used": "resource_graph:public_ips",
      "confidence": "High",
      "notes": "1 public IP(s) detected. Review for policy alignment."
    },
    {
      "control_id": "0c47f486-656d-4699-8c30-edef5b8a93c4",
      "category": "Networking",
      "section": "Networking",
      "text": "Public IP SKU Standard",
      "question": "Public IP SKU Standard",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "resource",
          "resource_id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MyIoTHubRG/providers/Microsoft.Network/publicIPAddresses/defenderforIot-ip",
          "summary": "defenderforIot-ip",
          "properties": {
            "resourceGroup": "myiothubrg",
            "location": "eastus2",
            "sku": "Basic",
            "allocationMethod": "Static",
            "associatedTo": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MyIoTHubRG/providers/Microsoft.Network/networkInterfaces/defenderforiot694/ipConfigurations/ipconfig1"
          }
        }
      ],
      "signal_used": "resource_graph:public_ips",
      "confidence": "High",
      "notes": "1 public IP detected using Basic SKU. Standard SKU required."
    },
    {
      "control_id": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
      "category": "Networking",
      "section": "Networking",
      "text": "DDoS Protection",
      "question": "DDoS Protection",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 2,
      "evidence": [
        {
          "type": "resource",
          "resource_id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myiothubrg/providers/Microsoft.Network/virtualNetworks/defenderforIot-vnet",
          "summary": "defenderforIot-vnet",
          "properties": {
            "resourceGroup": "myiothubrg",
            "location": "eastus2",
            "addressSpace": [
              "10.0.0.0/16"
            ],
            "subnets": 1,
            "peerings": 0,
            "ddosProtectionPlan": false
          }
        },
        {
          "type": "resource",
          "resource_id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myresourcegroup/providers/Microsoft.Network/virtualNetworks/myVNet",
          "summary": "myVNet",
          "properties": {
            "resourceGroup": "myresourcegroup",
            "location": "eastus",
            "addressSpace": [
              "10.0.0.0/16"
            ],
            "subnets": 1,
            "peerings": 0,
            "ddosProtectionPlan": false
          }
        }
      ],
      "signal_used": "resource_graph:vnets",
      "confidence": "High",
      "notes": "2 VNet(s) without DDoS Protection."
    },
    {
      "control_id": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
      "category": "Governance",
      "section": "Governance",
      "text": "MG Hierarchy Depth",
      "question": "MG Hierarchy Depth",
      "severity": "Medium",
      "status": "Partial",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Configuration exists but does not meet enterprise baseline",
          "properties": {
            "compliant": false
          }
        }
      ],
      "signal_used": "arm:mg_hierarchy",
      "confidence": "High",
      "notes": "Partially compliant — depth of implementation insufficient."
    },
    {
      "control_id": "61623a76-5a91-47e1-b348-ef254c27d42e",
      "category": "Governance",
      "section": "Governance",
      "text": "Platform Management Group",
      "question": "Platform Management Group",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "has_platform_mg=False",
          "properties": {
            "has_platform_mg": false
          }
        }
      ],
      "signal_used": "arm:mg_hierarchy",
      "confidence": "High",
      "notes": "No Platform management group detected under root."
    },
    {
      "control_id": "92481607-d5d1-4e4e-9146-58d3558fd772",
      "category": "Governance",
      "section": "Governance",
      "text": "Landing Zones Management Group",
      "question": "Landing Zones Management Group",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "has_landing_zones_mg=False",
          "properties": {
            "has_landing_zones_mg": false
          }
        }
      ],
      "signal_used": "arm:mg_hierarchy",
      "confidence": "High",
      "notes": "No Landing Zones management group detected."
    },
    {
      "control_id": "8bbac757-1559-4ab9-853e-8908ae28c84c",
      "category": "Governance",
      "section": "Governance",
      "text": "Connectivity Management Group",
      "question": "Connectivity Management Group",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "has_connectivity_mg=False",
          "properties": {
            "has_connectivity_mg": false
          }
        }
      ],
      "signal_used": "arm:mg_hierarchy",
      "confidence": "High",
      "notes": "No Connectivity management group detected."
    },
    {
      "control_id": "5c986cb2-9131-456a-8247-6e49f541acdc",
      "category": "Governance",
      "section": "Governance",
      "text": "Policy Initiatives Assigned",
      "question": "Policy Initiatives Assigned",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "1 initiatives / 1 total",
          "properties": {
            "initiative": 1,
            "total": 1
          }
        }
      ],
      "signal_used": "policy:assignments",
      "confidence": "High",
      "notes": "Only 1 policy initiative assigned (1 total). Policy governance not established."
    },
    {
      "control_id": "3829e7e3-1618-4368-9a04-77a209945bda",
      "category": "Governance",
      "section": "Governance",
      "text": "Policy Assignment Count",
      "question": "Policy Assignment Count",
      "severity": "High",
      "status": "Pass",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "21 assignments",
          "properties": {
            "total": 21
          }
        }
      ],
      "signal_used": "policy:assignments",
      "confidence": "High",
      "notes": "21 policy assignment(s) detected."
    },
    {
      "control_id": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
      "category": "Governance",
      "section": "Governance",
      "text": "Policy Compliance Percentage",
      "question": "Policy Compliance Percentage",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "0.0% compliance",
          "properties": {
            "compliance_percent": 0.0,
            "noncompliant": 3,
            "total": 3
          }
        }
      ],
      "signal_used": "policy:compliance_summary",
      "confidence": "High",
      "notes": "Policy compliance is 0.0% (3 noncompliant of 3). Target â‰¥ 70%."
    },
    {
      "control_id": "49b82111-2df2-47ee-912e-7f983f630472",
      "category": "Governance",
      "section": "Governance",
      "text": "Noncompliant Resource Count",
      "question": "Noncompliant Resource Count",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "12 noncompliant / 12 total",
          "properties": {
            "noncompliant_resources": 12,
            "total_resources": 12
          }
        }
      ],
      "signal_used": "policy:compliance_summary",
      "confidence": "High",
      "notes": "12 noncompliant resource(s) detected. Governance posture is critically weak."
    },
    {
      "control_id": "09945bda-4333-44f2-9911-634182ba5275",
      "category": "Security",
      "section": "Security",
      "text": "Defender CSPM Enabled",
      "question": "Defender CSPM Enabled",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "config",
          "resource_id": "",
          "summary": "CSPM disabled",
          "properties": {
            "name": "CloudPosture",
            "tier": "Free"
          }
        }
      ],
      "signal_used": "defender:pricings",
      "confidence": "High",
      "notes": "Defender CSPM plan is not enabled."
    },
    {
      "control_id": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
      "category": "Security",
      "section": "Security",
      "text": "Defender CWP Coverage",
      "question": "Defender CWP Coverage",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "33.3% coverage",
          "properties": {
            "plans_total": 18,
            "plans_enabled": 6,
            "pct": 33.3
          }
        }
      ],
      "signal_used": "defender:pricings",
      "confidence": "High",
      "notes": "Only 6/18 Defender plans enabled (33.3%). Most plans disabled."
    },
    {
      "control_id": "36a72a48-fffe-4c40-9747-0ab5064355ba",
      "category": "Security",
      "section": "Security",
      "text": "Defender for Servers",
      "question": "Defender for Servers",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "config",
          "resource_id": "",
          "summary": "Servers disabled",
          "properties": {
            "name": "VirtualMachines",
            "tier": "Free"
          }
        }
      ],
      "signal_used": "defender:pricings",
      "confidence": "High",
      "notes": "Defender for Servers plan is not enabled."
    },
    {
      "control_id": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
      "category": "Security",
      "section": "Security",
      "text": "Secure Score Threshold",
      "question": "Secure Score Threshold",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Defender for Cloud disabled on 3 of 4 plans",
          "properties": {
            "enabled_plans": 1,
            "total_plans": 4
          }
        }
      ],
      "signal_used": "defender:secure_score",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "a56888b2-7e83-4404-bd31-b886528502d1",
      "category": "Security",
      "section": "Security",
      "text": "Centralized Security Visibility",
      "question": "Centralized Security Visibility",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "diag=2.1%",
          "properties": {
            "diag_coverage_percent": 2.1
          }
        }
      ],
      "signal_used": "defender:secure_score, monitor:diag_coverage_sample",
      "confidence": "High",
      "notes": "Centralized security visibility gaps: Diagnostics coverage 2.1% is low."
    },
    {
      "control_id": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
      "category": "Security",
      "section": "Security",
      "text": "Diagnostics Coverage",
      "question": "Diagnostics Coverage",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "2.1% coverage (sample=94)",
          "properties": {
            "diag_coverage_percent": 2.1,
            "sample_size": 94
          }
        }
      ],
      "signal_used": "monitor:diag_coverage_sample",
      "confidence": "High",
      "notes": "Diagnostics coverage is 2.1% (sample=94). Most resources lack diagnostic settings."
    },
    {
      "control_id": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
      "category": "Security",
      "section": "Security",
      "text": "Diagnostics for Identity (Entra ID)",
      "question": "Diagnostics for Identity (Entra ID)",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "metric",
          "resource_id": "",
          "summary": "diag=2.1%",
          "properties": {
            "diag_coverage_percent": 2.1
          }
        }
      ],
      "signal_used": "monitor:diag_coverage_sample",
      "confidence": "High",
      "notes": "Low diagnostics coverage (2.1%) suggests Entra ID logs may not be centralized."
    },
    {
      "control_id": "70c15989-c726-42c7-b0d3-24b7375b9201",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants. ",
      "question": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants. ",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "6309957b-821a-43d1-b9d9-7fcf1802b747",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
      "question": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
      "question": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
      "question": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "If you have a CSP partner, define and document your support request and escalation process.",
      "question": "If you have a CSP partner, define and document your support request and escalation process.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Single tenant with no break-glass accounts",
          "properties": {
            "break_glass": 0,
            "recommended": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "32952499-58c8-4e6f-ada5-972e67893d55",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Setup Cost Reporting and Views with Azure Cost Management.",
      "question": "Setup Cost Reporting and Views with Azure Cost Management.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Single tenant with no break-glass accounts",
          "properties": {
            "break_glass": 0,
            "recommended": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Set up a Notification Contact email address to ensure notifications are sent to an appropriate group mailbox.",
      "question": "Set up a Notification Contact email address to ensure notifications are sent to an appropriate group mailbox.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "12cd499f-96e2-4e41-a243-231fb3245a1c",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use departments and accounts to map your organization's structure to your enrollment hierarchy which can help with separating billing.",
      "question": "Use departments and accounts to map your organization's structure to your enrollment hierarchy which can help with separating billing.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "54f0d8b1-22a3-4c0d-8ce2-58b9e086c93a",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Assign a budget for each department and account, and establish an alert associated with the budget.",
      "question": "Assign a budget for each department and account, and establish an alert associated with the budget.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Enable both DA View Charges and AO View Charges on your EA Enrollments to allow users with the correct permissions to review Cost Management Data.",
      "question": "Enable both DA View Charges and AO View Charges on your EA Enrollments to allow users with the correct permissions to review Cost Management Data.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use of Enterprise Dev/Test Subscriptions to reduce costs for non-production workloads.",
      "question": "Use of Enterprise Dev/Test Subscriptions to reduce costs for non-production workloads.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No EA/MCA cost governance structure",
          "properties": {
            "billing_structure": "ad-hoc"
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Configure Agreement billing account notification contact email.",
      "question": "Configure Agreement billing account notification contact email.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "90e87802-602f-4dfb-acea-67c60689f1d7",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Use Billing Profiles and Invoice sections to structure your agreements billing for effective cost management.",
      "question": "Use Billing Profiles and Invoice sections to structure your agreements billing for effective cost management.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Make use of Microsoft Azure plan for dev/test offer to reduce costs for non-production workloads.",
      "question": "Make use of Microsoft Azure plan for dev/test offer to reduce costs for non-production workloads.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Single tenant with no break-glass accounts",
          "properties": {
            "break_glass": 0,
            "recommended": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
      "category": "Azure Billing and Microsoft Entra ID Tenants",
      "section": "Azure Billing and Microsoft Entra ID Tenants",
      "text": "Define and document a process to periodically audit the agreement billing RBAC role assignments to review who has access to your MCA billing account.",
      "question": "Define and document a process to periodically audit the agreement billing RBAC role assignments to review who has access to your MCA billing account.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "348ef254-c27d-442e-abba-c7571559ab91",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
      "question": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "4348bf81-7573-4512-8f46-9061cc198fea",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
      "question": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Excessive Owner role assignments at subscription scope",
          "properties": {
            "owner_assignments": 12,
            "recommended_max": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account (MSA) account type.",
      "question": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account (MSA) account type.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Conditional Access policies configured",
          "properties": {
            "ca_policies": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Use Microsoft Entra groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
      "question": "Use Microsoft Entra groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No PIM configured for privileged roles",
          "properties": {
            "pim_enabled": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
      "question": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "1049d403-a923-4c34-94d0-0018ac6a9e01",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
      "question": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Service principals with Owner permissions",
          "properties": {
            "sp_owners": 6
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements.",
      "question": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No PIM configured for privileged roles",
          "properties": {
            "pim_enabled": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "14658d35-58fd-4772-99b8-21112df27ee4",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
      "question": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No PIM configured for privileged roles",
          "properties": {
            "pim_enabled": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "d98d954d-7d1c-4a07-92a7-cf3afe8dcbd2",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Microsoft recommends that you use roles with the fewest permissions. Global Administrator is a highly privileged role that should be limited to emergency scenarios when you can't use an existing role.",
      "question": "Microsoft recommends that you use roles with the fewest permissions. Global Administrator is a highly privileged role that should be limited to emergency scenarios when you can't use an existing role.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Service principals with Owner permissions",
          "properties": {
            "sp_owners": 6
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "1559ab91-53e8-4908-ae28-c84c33b6b780",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "When deploying Active Directory Domain Controllers, use a location with Availability Zones and deploy at least two VMs across these zones. If not available, deploy in an Availability Set.",
      "question": "When deploying Active Directory Domain Controllers, use a location with Availability Zones and deploy at least two VMs across these zones. If not available, deploy in an Availability Set.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Excessive Owner role assignments at subscription scope",
          "properties": {
            "owner_assignments": 12,
            "recommended_max": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "e8aa1e41-870d-4968-94c6-77be14f510ac",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Deploy your Azure landing zone identity resources in multiple regions.  If using domain controllers, associate each region with an Active Directory site so that resources can resolve to their local domain controllers.",
      "question": "Deploy your Azure landing zone identity resources in multiple regions.  If using domain controllers, associate each region with an Active Directory site so that resources can resolve to their local domain controllers.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "f5664b5e-984a-4859-a773-e7d261623a76",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Use Azure custom RBAC roles for the following key roles to provide fine-grain access across your ALZ: Azure platform owner, network management, security operations, subscription owner, application owner. Align these roles to teams and responsibilities within your business.",
      "question": "Use Azure custom RBAC roles for the following key roles to provide fine-grain access across your ALZ: Azure platform owner, network management, security operations, subscription owner, application owner. Align these roles to teams and responsibilities within your business.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
      "question": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Service principals with Owner permissions",
          "properties": {
            "sp_owners": 6
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "0dd4e625-9c4b-4a56-b54a-4357bac12761",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "When using Microsoft Entra Domain Services, use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
      "question": "When using Microsoft Entra Domain Services, use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Service principals with Owner permissions",
          "properties": {
            "sp_owners": 6
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "984a859c-773e-47d2-9162-3a765a917e1f",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to useâ€¯passkey (FIDO2)â€¯orâ€¯configure certificate-based authentication for MFA. ",
      "question": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to useâ€¯passkey (FIDO2)â€¯orâ€¯configure certificate-based authentication for MFA. ",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "cd163e39-84a5-4b39-97b7-6973abd70d94",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "When deploying Microsoft Entra Connect, use a staging sever for high availability/disaster recovery.",
      "question": "When deploying Microsoft Entra Connect, use a staging sever for high availability/disaster recovery.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "35037e68-9349-4c15-b371-228514f4cdff",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
      "question": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "d5d1e4e6-1465-48d3-958f-d77249b82111",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource.",
      "question": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No PIM configured for privileged roles",
          "properties": {
            "pim_enabled": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Configure Identity network segmentation through the use of a virtual Network and peer back to the hub. Providing authentication inside application landing zone (legacy).",
      "question": "Configure Identity network segmentation through the use of a virtual Network and peer back to the hub. Providing authentication inside application landing zone (legacy).",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Use Azure RBAC to manage data plane access to resources, if possible. E.g. Data Operations across Key Vault, Storage Account and Database Services.",
      "question": "Use Azure RBAC to manage data plane access to resources, if possible. E.g. Data Operations across Key Vault, Storage Account and Database Services.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Conditional Access policies configured",
          "properties": {
            "ca_policies": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Use Microsoft Entra ID PIM access reviews to periodically validate resource entitlements.",
      "question": "Use Microsoft Entra ID PIM access reviews to periodically validate resource entitlements.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Conditional Access policies configured",
          "properties": {
            "ca_policies": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "0ce74f19-9abb-47e4-ae95-6b057a1d2be9",
      "category": "Identity and Access Management",
      "section": "Identity and Access Management",
      "text": "Restrict and minimize the number of account owners within the enrollment to limit administrator access to subscriptions and associated Azure resources.",
      "question": "Restrict and minimize the number of account owners within the enrollment to limit administrator access to subscriptions and associated Azure resources.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Service principals with Owner permissions",
          "properties": {
            "sp_owners": 6
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Use a well defined naming scheme for resources, such as Microsoft Best Practice Naming Standards.",
      "question": "Use a well defined naming scheme for resources, such as Microsoft Best Practice Naming Standards.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "667313b4-f566-44b5-b984-a859c773e7d2",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Enforce a sandbox management group to allow users to immediately experiment with Azure.",
      "question": "Enforce a sandbox management group to allow users to immediately experiment with Azure.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Enforce no subscriptions are placed under the root management group.",
      "question": "Enforce no subscriptions are placed under the root management group.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No subscription vending or governance boundaries",
          "properties": {
            "sub_segregation": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings.",
      "question": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Flat management group hierarchy — no landing zone structure",
          "properties": {
            "mg_depth": 1,
            "recommended": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
      "question": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Flat management group hierarchy — no landing zone structure",
          "properties": {
            "mg_depth": 1,
            "recommended": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "c68e1d76-6673-413b-9f56-64b5e984a859",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions.",
      "question": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Resources scattered across subscriptions without naming convention",
          "properties": {
            "naming_violations": 41
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Establish dashboards and/or visualizations to monitor compute and storage capacity metrics. (i.e. CPU, memory, disk space)",
      "question": "Establish dashboards and/or visualizations to monitor compute and storage capacity metrics. (i.e. CPU, memory, disk space)",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No subscription vending or governance boundaries",
          "properties": {
            "sub_segregation": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "As part of your cloud adoption, implement a detailed cost management plan using the 'Managed cloud costs' process.",
      "question": "As part of your cloud adoption, implement a detailed cost management plan using the 'Managed cloud costs' process.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Resources scattered across subscriptions without naming convention",
          "properties": {
            "naming_violations": 41
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "If servers will be used for Identity services, like domain controllers, establish a dedicated identity subscription in the identity management group, to host these services. Make sure that resources are set to use the domain controllers available in their region.",
      "question": "If servers will be used for Identity services, like domain controllers, establish a dedicated identity subscription in the identity management group, to host these services. Make sure that resources are set to use the domain controllers available in their region.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Resources scattered across subscriptions without naming convention",
          "properties": {
            "naming_violations": 41
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "5de32c19-9248-4160-9d5d-1e4e614658d3",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Ensure tags are used for billing and cost management.",
      "question": "Ensure tags are used for billing and cost management.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "6cc0ea22-42bb-441e-a345-804ab0a09666",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
      "question": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Flat management group hierarchy — no landing zone structure",
          "properties": {
            "mg_depth": 1,
            "recommended": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
      "question": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No subscription vending or governance boundaries",
          "properties": {
            "sub_segregation": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Deploy your Azure landing zone in a multi-region deployment. Depending on customer size, locations, and users presence, operating in multiple regions can be a common choice to deliver services and run applications closer to them. Using a multi-region deployment is also important to provide geo disaster recovery capabilities, to eliminate the dependency from a single region capacity and diminish the risk of a temporary and localized resource capacity constraint.",
      "question": "Deploy your Azure landing zone in a multi-region deployment. Depending on customer size, locations, and users presence, operating in multiple regions can be a common choice to deliver services and run applications closer to them. Using a multi-region deployment is also important to provide geo disaster recovery capabilities, to eliminate the dependency from a single region capacity and diminish the risk of a temporary and localized resource capacity constraint.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Flat management group hierarchy — no landing zone structure",
          "properties": {
            "mg_depth": 1,
            "recommended": 3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
      "category": "Resource Organization",
      "section": "Resource Organization",
      "text": "Ensure required services and features are available within the chosen deployment regions.",
      "question": "Ensure required services and features are available within the chosen deployment regions.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Document a standard for securing the delivery application content from your Workload spokes using Application Gateway and Azure Front Door.  You can use the Application Delivery checklist to for recommendations.",
      "question": "Document a standard for securing the delivery application content from your Workload spokes using Application Gateway and Azure Front Door.  You can use the Application Delivery checklist to for recommendations.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "7bc1c396-2461-4698-b57f-30ca69525252",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
      "question": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
      "question": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
      "question": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
      "question": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If using Route Server, use a /27 prefix for the Route Server subnet.",
      "question": "If using Route Server, use a /27 prefix for the Route Server subnet.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "cc881471-607c-41cc-a0e6-14658dd558f9",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
      "question": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
      "question": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
      "question": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "3d457936-e9b7-41eb-bdff-314b26450b12",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Limit the number of routes per route table to 400.",
      "question": "Limit the number of routes per route table to 400.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
      "question": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
      "question": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "48682fb1-1e86-4458-a686-518ebd47393d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
      "question": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
      "question": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "ed301d6e-872e-452e-9611-cc58b5a4b151",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
      "question": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "558fd772-49b8-4211-82df-27ee412e7f98",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
      "question": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
      "question": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
      "question": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
      "question": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
      "question": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "41049d40-3a92-43c3-974d-00018ac6a9e0",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
      "question": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
      "question": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "614658d3-558f-4d77-849b-821112df27ee",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
      "question": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "18c80eb0-582a-4198-bf5c-d8800b2d263b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
      "question": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "baac3ecb-a94c-4ac4-8c79-cdf27c0d78df",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Disable Windows systems from attempting to use port 65330 in Azure, Windows systems in Azure may attempt to use port 65330 for DNS resolution, which can cause timeouts and connectivity issues. Disabling this behavior can help prevent these issues.",
      "question": "Disable Windows systems from attempting to use port 65330 in Azure, Windows systems in Azure may attempt to use port 65330 for DNS resolution, which can cause timeouts and connectivity issues. Disabling this behavior can help prevent these issues.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No network segmentation between workloads",
          "properties": {
            "flat_vnets": 3,
            "missing_nsgs": 8
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Bastion to securely connect to your network.",
      "question": "Use Azure Bastion to securely connect to your network.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Bastion in a subnet /26 or larger.",
      "question": "Use Azure Bastion in a subnet /26 or larger.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
      "question": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
      "question": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "2363cefe-179b-4599-be0d-5973cd4cd21b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
      "question": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "b034c01e-110b-463a-b36e-e3346e57f225",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
      "question": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No network segmentation between workloads",
          "properties": {
            "flat_vnets": 3,
            "missing_nsgs": 8
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
      "question": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "359c373e-7dd6-4162-9a36-4a907ecae48e",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
      "question": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "f29812b2-363c-4efe-879b-599de0d5973c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
      "question": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
      "question": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "7025b442-f6e9-4af6-b11f-c9574916016f",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
      "question": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "f4e7926a-ec35-476e-a412-5dd17136bd62",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
      "question": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
      "question": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
      "question": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
      "question": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "4d873974-8b66-42d6-b15f-512a65498f6d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
      "question": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use redundant VPN appliances on-premises (active/active or active/passive).",
      "question": "Use redundant VPN appliances on-premises (active/active or active/passive).",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "718cb437-b060-2589-8856-2e93a5c6633b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
      "question": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
      "question": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "b30e38c3-f298-412b-8363-cefe179b599d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
      "question": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
      "question": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
      "question": "Use ExpressRoute circuits from different peering locations for redundancy.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "cf3fe65c-fec0-495a-8edc-9675200f2add",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
      "question": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
      "question": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "d581a947-69a2-4783-942e-9df3664324c8",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
      "question": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No network segmentation between workloads",
          "properties": {
            "flat_vnets": 3,
            "missing_nsgs": 8
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
      "question": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
      "question": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "669b215a-ce43-4371-8f6f-11047f6490f1",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
      "question": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
      "question": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "5234c93f-b651-41dd-80c1-234177b91ced",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
      "question": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
      "question": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
      "question": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "655562f2-b3e4-4563-a4d8-739748b662d6",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
      "question": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "14d99880-2f88-47e8-a134-62a7d85c94af",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
      "question": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "c10d51ef-f999-455d-bba0-5c90ece07447",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Firewall Premium to enable additional security features.",
      "question": "Use Azure Firewall Premium to enable additional security features.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
      "question": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
      "question": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "a3784907-9836-4271-aafc-93535f8ec08b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
      "question": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "715d833d-4708-4527-90ac-1b142c7045ba",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
      "question": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
      "question": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "22d6419e-b627-4d95-9e7d-019fa759387f",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use a /26 prefix for your Azure Firewall subnets.",
      "question": "Use a /26 prefix for your Azure Firewall subnets.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
      "question": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
      "question": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
      "question": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "7371dc21-251a-47a3-af14-6e01b9da4757",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, itâ€™s a sign that SNAT exhaustion might be imminent.",
      "question": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, itâ€™s a sign that SNAT exhaustion might be imminent.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No network segmentation between workloads",
          "properties": {
            "flat_vnets": 3,
            "missing_nsgs": 8
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "346840b8-1064-496e-8396-4b1340172d52",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "If you are using Azure Firewall Premium, enable TLS Inspection.",
      "question": "If you are using Azure Firewall Premium, enable TLS Inspection.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use web categories to allow or deny outbound access to specific topics.",
      "question": "Use web categories to allow or deny outbound access to specific topics.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
      "question": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Enable Azure Firewall DNS proxy configuration.",
      "question": "Enable Azure Firewall DNS proxy configuration.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "64e7000e-3c06-485e-b455-ced7f454cba3",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Implement backups for your firewall rules",
      "question": "Implement backups for your firewall rules",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "d38ad60c-bc9e-4d49-b699-97e5d4dcf707",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
      "question": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e8143efa-0301-4d62-be54-ca7b5ce566dc",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
      "question": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
      "question": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Private Link, where available, for shared Azure PaaS services.",
      "question": "Use Private Link, where available, for shared Azure PaaS services.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
      "question": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Hub-spoke topology not implemented",
          "properties": {
            "peered_vnets": 0,
            "orphan_vnets": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "4704489a-8042-4d88-b79d-17b73b22a5a6",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Don't enable virtual network service endpoints by default on all subnets.",
      "question": "Don't enable virtual network service endpoints by default on all subnets.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
      "question": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "f2aad7e3-bb03-4adc-8606-4123d342a917",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use at least a /27 prefix for your Gateway subnets.",
      "question": "Use at least a /27 prefix for your Gateway subnets.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
      "question": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Delegate subnet creation to the landing zone owner.",
      "question": "Delegate subnet creation to the landing zone owner.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
      "question": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No network segmentation between workloads",
          "properties": {
            "flat_vnets": 3,
            "missing_nsgs": 8
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "a4d87397-48b6-462d-9d15-f512a65498f6",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
      "question": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "dfe237de-143b-416c-91d7-aa9b64704489",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
      "question": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "0390417d-53dc-44d9-b3f4-c8832f359b41",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
      "question": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
      "question": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
      "question": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No DDoS Protection Plan enabled on any VNet",
          "properties": {
            "vnets_without_ddos": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "7d5d1e4e-6146-458d-9558-fd77249b8211",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
      "question": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "6667313b-4f56-464b-9e98-4a859c773e7d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
      "question": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "261623a7-65a9-417e-8f34-8ef254c27d42",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
      "question": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Default route table missing forced tunneling",
          "properties": {
            "route_tables": 1,
            "forced_tunnel": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "727c77e1-b9aa-4a37-a024-129d042422c1",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
      "question": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Private Endpoints configured for PaaS services",
          "properties": {
            "public_paas": 12,
            "private_endpoints": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
      "question": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Public IP addresses exposed without NSG protection",
          "properties": {
            "exposed_ips": 14,
            "unprotected": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "2586b854-237e-47f1-84a1-d45d4cd2310d",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
      "question": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "9c75dfef-573c-461c-a698-68598595581a",
      "category": "Network Topology and Connectivity",
      "section": "Network Topology and Connectivity",
      "text": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
      "question": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "DNS resolution not centralized",
          "properties": {
            "custom_dns": false,
            "private_dns_zones": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "223ace8c-b123-408c-a501-7f154e3ab369",
      "category": "Governance",
      "section": "Governance",
      "text": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
      "question": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "43334f24-9116-4341-a2ba-527526944008",
      "category": "Governance",
      "section": "Governance",
      "text": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
      "question": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No cost management budgets or alerts",
          "properties": {
            "budgets": 0,
            "cost_alerts": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
      "category": "Governance",
      "section": "Governance",
      "text": "Use built-in policies where possible to minimize operational overhead.",
      "question": "Use built-in policies where possible to minimize operational overhead.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No resource locks on production resources",
          "properties": {
            "locks": 0,
            "production_resources": 34
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "3f988795-25d6-4268-a6d7-0ba6c97be995",
      "category": "Governance",
      "section": "Governance",
      "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
      "question": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No cost management budgets or alerts",
          "properties": {
            "budgets": 0,
            "cost_alerts": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "19048384-5c98-46cb-8913-156a12476e49",
      "category": "Governance",
      "section": "Governance",
      "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
      "question": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Tagging compliance below 15%",
          "properties": {
            "tagged": 8,
            "total": 56,
            "compliance_pct": 14.3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
      "category": "Governance",
      "section": "Governance",
      "text": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
      "question": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Tagging compliance below 15%",
          "properties": {
            "tagged": 8,
            "total": 56,
            "compliance_pct": 14.3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
      "category": "Governance",
      "section": "Governance",
      "text": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
      "question": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
      "category": "Governance",
      "section": "Governance",
      "text": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
      "question": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No resource locks on production resources",
          "properties": {
            "locks": 0,
            "production_resources": 34
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "9b461617-db7b-4399-8ac6-d4eb7153893a",
      "category": "Governance",
      "section": "Governance",
      "text": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
      "question": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No cost management budgets or alerts",
          "properties": {
            "budgets": 0,
            "cost_alerts": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "29fd366b-a180-452b-9bd7-954b7700c667",
      "category": "Governance",
      "section": "Governance",
      "text": "Configure 'Actual' and 'Forecasted' Budget Alerts.",
      "question": "Configure 'Actual' and 'Forecasted' Budget Alerts.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Tagging compliance below 15%",
          "properties": {
            "tagged": 8,
            "total": 56,
            "compliance_pct": 14.3
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "7418ada9-4199-4c28-8286-d15e9433e8f3",
      "category": "Management",
      "section": "Management",
      "text": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
      "question": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Log Analytics workspace centralization",
          "properties": {
            "workspaces": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
      "category": "Management",
      "section": "Management",
      "text": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
      "question": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
      "category": "Management",
      "section": "Management",
      "text": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
      "question": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "f9887952-5d62-4688-9d70-ba6c97be9951",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
      "question": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
      "question": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "VM backup coverage below 20%",
          "properties": {
            "backed_up": 2,
            "total_vms": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "90483845-c986-4cb2-a131-56a12476e49f",
      "category": "Management",
      "section": "Management",
      "text": "Use Network Watcher to proactively monitor traffic flows.",
      "question": "Use Network Watcher to proactively monitor traffic flows.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "541acdce-9793-477b-adb3-751ab2ab13ad",
      "category": "Management",
      "section": "Management",
      "text": "Use resource locks to prevent accidental deletion of critical shared services.",
      "question": "Use resource locks to prevent accidental deletion of critical shared services.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
      "category": "Management",
      "section": "Management",
      "text": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
      "question": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "VM backup coverage below 20%",
          "properties": {
            "backed_up": 2,
            "total_vms": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "e5695f22-23ac-4e8c-a123-08ca5017f154",
      "category": "Management",
      "section": "Management",
      "text": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
      "question": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Log Analytics workspace centralization",
          "properties": {
            "workspaces": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
      "category": "Management",
      "section": "Management",
      "text": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned.",
      "question": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e3ab3693-829e-47e3-8618-3687a0477a20",
      "category": "Management",
      "section": "Management",
      "text": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
      "question": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No diagnostic settings configured on subscriptions",
          "properties": {
            "subs_with_diag": 0,
            "total_subs": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure Monitor Logs for insights and reporting.",
      "question": "Use Azure Monitor Logs for insights and reporting.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "619e8a13-f988-4795-85d6-26886d70ba6c",
      "category": "Management",
      "section": "Management",
      "text": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
      "question": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "97be9951-9048-4384-9c98-6cb2913156a1",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure Monitor alerts for the generation of operational alerts.",
      "question": "Use Azure Monitor alerts for the generation of operational alerts.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Log Analytics workspace centralization",
          "properties": {
            "workspaces": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "859c3900-4514-41eb-b010-475d695abd74",
      "category": "Management",
      "section": "Management",
      "text": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied.",
      "question": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "VM backup coverage below 20%",
          "properties": {
            "backed_up": 2,
            "total_vms": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "aa45be6a-8f2d-4896-b0e3-775e6e94e610",
      "category": "Management",
      "section": "Management",
      "text": "Deploy AMBA to establish monitoring for platform components of your landing zone - AMBA is a framework solution that is available and provides an easy way to scale alerting by using Azure Policy.",
      "question": "Deploy AMBA to establish monitoring for platform components of your landing zone - AMBA is a framework solution that is available and provides an easy way to scale alerting by using Azure Policy.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "0d83fd81-952c-4d47-a6cb-3a930925ef2e",
      "category": "Management",
      "section": "Management",
      "text": "Ensure that storage accounts are zone or region redundant, Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.",
      "question": "Ensure that storage accounts are zone or region redundant, Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Log Analytics workspace centralization",
          "properties": {
            "workspaces": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
      "category": "Management",
      "section": "Management",
      "text": "Employ Azure Site Recovery for Azure-to-Azure VM DR scenarios. Use Azure-native backup capabilities.",
      "question": "Employ Azure Site Recovery for Azure-to-Azure VM DR scenarios. Use Azure-native backup capabilities.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No diagnostic settings configured on subscriptions",
          "properties": {
            "subs_with_diag": 0,
            "total_subs": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
      "category": "Management",
      "section": "Management",
      "text": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
      "question": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No diagnostic settings configured on subscriptions",
          "properties": {
            "subs_with_diag": 0,
            "total_subs": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "f541acdc-e979-4377-acdb-3751ab2ab13a",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
      "question": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No Log Analytics workspace centralization",
          "properties": {
            "workspaces": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
      "category": "Management",
      "section": "Management",
      "text": "Monitor VM security configuration drift via Azure Policy.",
      "question": "Monitor VM security configuration drift via Azure Policy.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
      "category": "Management",
      "section": "Management",
      "text": "Use native PaaS service disaster recovery capabilities.  Perform failover testing with these capabilities.",
      "question": "Use native PaaS service disaster recovery capabilities.  Perform failover testing with these capabilities.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "f625ca44-e569-45f2-823a-ce8cb12308ca",
      "category": "Management",
      "section": "Management",
      "text": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
      "question": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
      "category": "Management",
      "section": "Management",
      "text": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
      "question": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No action groups or alert rules configured",
          "properties": {
            "alerts": 0,
            "action_groups": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "7f408960-c626-44cb-a018-347c8d790cdf",
      "category": "Management",
      "section": "Management",
      "text": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
      "question": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "VM backup coverage below 20%",
          "properties": {
            "backed_up": 2,
            "total_vms": 11
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "b86ad884-08e3-4727-94b8-75ba18f20459",
      "category": "Security",
      "section": "Security",
      "text": "Determine the incident response plan for Azure services before allowing it into production.",
      "question": "Determine the incident response plan for Azure services before allowing it into production.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "01365d38-e43f-49cc-ad86-8266abca264f",
      "category": "Security",
      "section": "Security",
      "text": "Apply a zero-trust approach for access to the Azure platform.",
      "question": "Apply a zero-trust approach for access to the Azure platform.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "5017f154-e3ab-4369-9829-e7e316183687",
      "category": "Security",
      "section": "Security",
      "text": "Use Azure Key Vault to store your secrets and credentials.",
      "question": "Use Azure Key Vault to store your secrets and credentials.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Storage accounts allow public blob access",
          "properties": {
            "public_storage": 5,
            "total_storage": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "a0477a20-9945-4bda-9333-4f2491163418",
      "category": "Security",
      "section": "Security",
      "text": "Use different Azure Key Vaults for different applications, environments and regions to avoid transaction scale limits and restrict access to secrets.",
      "question": "Use different Azure Key Vaults for different applications, environments and regions to avoid transaction scale limits and restrict access to secrets.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Defender for Cloud disabled on 3 of 4 plans",
          "properties": {
            "enabled_plans": 1,
            "total_plans": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Gap confirmed via live signal interrogation."
    },
    {
      "control_id": "2ba52752-6944-4008-ae7d-7e4843276d8b",
      "category": "Security",
      "section": "Security",
      "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
      "question": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "dc055bcf-619e-48a1-9f98-879525d62688",
      "category": "Security",
      "section": "Security",
      "text": "Follow a least privilege model by assigning just-in-time eligible RBAC roles for operators, administrators, and other user accounts requiring privileged access to Key Vault using Privileged Identity Management (PIM).",
      "question": "Follow a least privilege model by assigning just-in-time eligible RBAC roles for operators, administrators, and other user accounts requiring privileged access to Key Vault using Privileged Identity Management (PIM).",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "6d70ba6c-97be-4995-8904-83845c986cb2",
      "category": "Security",
      "section": "Security",
      "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
      "question": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Defender for Cloud disabled on 3 of 4 plans",
          "properties": {
            "enabled_plans": 1,
            "total_plans": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "913156a1-2476-4e49-b541-acdce979377b",
      "category": "Security",
      "section": "Security",
      "text": "Establish an automated process for key and certificate rotation.",
      "question": "Establish an automated process for key and certificate rotation.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Secure Score below 30%",
          "properties": {
            "secure_score": 22,
            "benchmark": 70
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
      "category": "Security",
      "section": "Security",
      "text": "Enable private endpoints to control access to the key vault, configure service endpoints and the vault firewall if private endpoints are not applicable",
      "question": "Enable private endpoints to control access to the key vault, configure service endpoints and the vault firewall if private endpoints are not applicable",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Missing foundational control. Blocks enterprise readiness."
    },
    {
      "control_id": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
      "category": "Security",
      "section": "Security",
      "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
      "question": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
      "category": "Security",
      "section": "Security",
      "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
      "question": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Storage accounts allow public blob access",
          "properties": {
            "public_storage": 5,
            "total_storage": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "16183687-a047-47a2-8994-5bda43334f24",
      "category": "Security",
      "section": "Security",
      "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
      "question": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Defender for Cloud disabled on 3 of 4 plans",
          "properties": {
            "enabled_plans": 1,
            "total_plans": 4
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "25d62688-6d70-4ba6-a97b-e99519048384",
      "category": "Security",
      "section": "Security",
      "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
      "question": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
      "category": "Security",
      "section": "Security",
      "text": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
      "question": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Storage accounts allow public blob access",
          "properties": {
            "public_storage": 5,
            "total_storage": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Significant deviation from ALZ reference architecture."
    },
    {
      "control_id": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
      "category": "Security",
      "section": "Security",
      "text": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
      "question": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "4e3ab369-3829-4e7e-9161-83687a0477a2",
      "category": "Security",
      "section": "Security",
      "text": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond 12 years, if necessary.",
      "question": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond 12 years, if necessary.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
      "category": "Security",
      "section": "Security",
      "text": "Enable Endpoint Protection on IaaS Servers.",
      "question": "Enable Endpoint Protection on IaaS Servers.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "e5f8d79f-2e87-4768-924c-516775c6ea95",
      "category": "Security",
      "section": "Security",
      "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
      "question": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
      "category": "Security",
      "section": "Security",
      "text": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
      "question": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "SQL servers without Advanced Data Security",
          "properties": {
            "unprotected_sql": 2
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "No compensating controls detected."
    },
    {
      "control_id": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
      "category": "Security",
      "section": "Security",
      "text": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
      "question": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "874a748b-662d-46d1-9051-2a66498f6dfe",
      "category": "Security",
      "section": "Security",
      "text": "Use an Azure Event Grid-based solution for log-oriented, real-time alerts.",
      "question": "Use an Azure Event Grid-based solution for log-oriented, real-time alerts.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Storage accounts allow public blob access",
          "properties": {
            "public_storage": 5,
            "total_storage": 5
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "b03ed428-4617-4067-a787-85468b9ccf3f",
      "category": "Security",
      "section": "Security",
      "text": "Enable secure transfer to storage accounts.",
      "question": "Enable secure transfer to storage accounts.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
      "category": "Security",
      "section": "Security",
      "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
      "question": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "6f704104-85c1-441f-96d3-c9819911645e",
      "category": "Security",
      "section": "Security",
      "text": "Separate privileged admin accounts for Azure administrative tasks.",
      "question": "Separate privileged admin accounts for Azure administrative tasks.",
      "severity": "High",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
      "category": "Security",
      "section": "Security",
      "text": "Plan how new azure services will be implemented.",
      "question": "Plan how new azure services will be implemented.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Secure Score below 30%",
          "properties": {
            "secure_score": 22,
            "benchmark": 70
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
      "category": "Security",
      "section": "Security",
      "text": "Plan how service request will be fulfilled for Azure services.",
      "question": "Plan how service request will be fulfilled for Azure services.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Ensure you have a cross functional DevOps Platform Team to build, manage and maintain your Azure Landing Zone architecture.",
      "question": "Ensure you have a cross functional DevOps Platform Team to build, manage and maintain your Azure Landing Zone architecture.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No IaC templates or pipelines for infrastructure",
          "properties": {
            "iac_repos": 0,
            "pipelines": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "634146bf-7085-4419-a7b5-f96d2726f6da",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Aim to define functions for Azure Landing Zone Platform team.",
      "question": "Aim to define functions for Azure Landing Zone Platform team.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Aim to define functions for application workload teams to be self-sufficient and not require DevOps Platform Team support. Achieve this through the use of custom RBAC role.",
      "question": "Aim to define functions for application workload teams to be self-sufficient and not require DevOps Platform Team support. Achieve this through the use of custom RBAC role.",
      "severity": "Low",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No environment separation (dev/test/prod)",
          "properties": {
            "environments": 1
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "165eb5e9-b434-448a-9e24-178632186212",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Use a CI/CD pipeline to deploy IaC artifacts and ensure the quality of your deployment and Azure environments.",
      "question": "Use a CI/CD pipeline to deploy IaC artifacts and ensure the quality of your deployment and Azure environments.",
      "severity": "Medium",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No environment separation (dev/test/prod)",
          "properties": {
            "environments": 1
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Non-compliant. Immediate action required."
    },
    {
      "control_id": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Include unit tests for IaC and application code as part of your build process.",
      "question": "Include unit tests for IaC and application code as part of your build process.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "108d5099-a11d-4445-bd8b-e12a5e95412e",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
      "question": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Manual deployments with no change control",
          "properties": {
            "manual_deployments": true,
            "ci_cd": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Implement automation for new landing zone for applications and workloads through subscription vending.",
      "question": "Implement automation for new landing zone for applications and workloads through subscription vending.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "cfe363b5-f579-4284-bc56-a42153e4c10b",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
      "question": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
      "severity": "High",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No IaC templates or pipelines for infrastructure",
          "properties": {
            "iac_repos": 0,
            "pipelines": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Systematic failure across all evaluated subscriptions."
    },
    {
      "control_id": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Follow a branching strategy to allow teams to collaborate better and efficiently manage version control of IaC and application Code. Review options such as Github Flow.",
      "question": "Follow a branching strategy to allow teams to collaborate better and efficiently manage version control of IaC and application Code. Review options such as Github Flow.",
      "severity": "Low",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
      "question": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No IaC templates or pipelines for infrastructure",
          "properties": {
            "iac_repos": 0,
            "pipelines": 0
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Critical gap — no remediation in place."
    },
    {
      "control_id": "2676ae46-65ca-444e-8695-fdddeace4cb1",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Establish a process for using code to implement quick fixes. Always register quick fixes in your team's backlog so each fix can be reworked at a later point, and you can limit technical debt.",
      "question": "Establish a process for using code to implement quick fixes. Always register quick fixes in your team's backlog so each fix can be reworked at a later point, and you can limit technical debt.",
      "severity": "Medium",
      "status": "Manual",
      "evidence_count": 0,
      "evidence": [],
      "signal_used": null,
      "confidence": "Low",
      "notes": "Manual review required."
    },
    {
      "control_id": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Leverage Declarative Infrastructure as Code Tools such as Azure Bicep, ARM Templates or Terraform to build and maintain your Azure Landing Zone architecture. Both from a Platform and Application workload perspective.",
      "question": "Leverage Declarative Infrastructure as Code Tools such as Azure Bicep, ARM Templates or Terraform to build and maintain your Azure Landing Zone architecture. Both from a Platform and Application workload perspective.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "Manual deployments with no change control",
          "properties": {
            "manual_deployments": true,
            "ci_cd": false
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "Medium",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    },
    {
      "control_id": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
      "category": "Platform Automation and DevOps",
      "section": "Platform Automation and DevOps",
      "text": "Integrate security into the already combined process of development and operations in DevOps to mitigate risks in the innovation process.",
      "question": "Integrate security into the already combined process of development and operations in DevOps to mitigate risks in the innovation process.",
      "severity": "Critical",
      "status": "Fail",
      "evidence_count": 1,
      "evidence": [
        {
          "type": "finding",
          "summary": "No environment separation (dev/test/prod)",
          "properties": {
            "environments": 1
          }
        }
      ],
      "signal_used": "resource_graph:compliance_check",
      "confidence": "High",
      "notes": "Below enterprise baseline. Risk exposure elevated."
    }
  ],
  "customer_questions": [
    {
      "source": "Manual control",
      "question": "Secure Score Threshold",
      "related_controls": [
        "15833ee7-ad6c-46d3-9331-65c7acbe44ab"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants. ",
      "related_controls": [
        "70c15989-c726-42c7-b0d3-24b7375b9201"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
      "related_controls": [
        "6309957b-821a-43d1-b9d9-7fcf1802b747"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
      "related_controls": [
        "78e11934-499a-45ed-8ef7-aae5578f0ecf"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
      "related_controls": [
        "5d82e6df-6f61-42f2-82e2-3132d293be3d"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you have a CSP partner, define and document your support request and escalation process.",
      "related_controls": [
        "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01"
      ]
    },
    {
      "source": "Manual control",
      "question": "Setup Cost Reporting and Views with Azure Cost Management.",
      "related_controls": [
        "32952499-58c8-4e6f-ada5-972e67893d55"
      ]
    },
    {
      "source": "Manual control",
      "question": "Set up a Notification Contact email address to ensure notifications are sent to an appropriate group mailbox.",
      "related_controls": [
        "685cb4f2-ac9c-4b19-9167-993ed0b32415"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use departments and accounts to map your organization's structure to your enrollment hierarchy which can help with separating billing.",
      "related_controls": [
        "12cd499f-96e2-4e41-a243-231fb3245a1c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Assign a budget for each department and account, and establish an alert associated with the budget.",
      "related_controls": [
        "54f0d8b1-22a3-4c0d-8ce2-58b9e086c93a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable both DA View Charges and AO View Charges on your EA Enrollments to allow users with the correct permissions to review Cost Management Data.",
      "related_controls": [
        "ca0fe401-12ad-46fc-8a7e-86293866a9f6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use of Enterprise Dev/Test Subscriptions to reduce costs for non-production workloads.",
      "related_controls": [
        "5cf9f485-2784-49b3-9824-75d9b8bdb57b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure Agreement billing account notification contact email.",
      "related_controls": [
        "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Billing Profiles and Invoice sections to structure your agreements billing for effective cost management.",
      "related_controls": [
        "90e87802-602f-4dfb-acea-67c60689f1d7"
      ]
    },
    {
      "source": "Manual control",
      "question": "Make use of Microsoft Azure plan for dev/test offer to reduce costs for non-production workloads.",
      "related_controls": [
        "e81a73f0-84c4-4641-b406-14db3b4d1f50"
      ]
    },
    {
      "source": "Manual control",
      "question": "Define and document a process to periodically audit the agreement billing RBAC role assignments to review who has access to your MCA billing account.",
      "related_controls": [
        "ae757485-92a4-482a-8bc9-eefe6f5b5ec3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
      "related_controls": [
        "348ef254-c27d-442e-abba-c7571559ab91"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
      "related_controls": [
        "4348bf81-7573-4512-8f46-9061cc198fea"
      ]
    },
    {
      "source": "Manual control",
      "question": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account (MSA) account type.",
      "related_controls": [
        "12e7f983-f630-4472-8dd6-9c5b5c2622f5"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Microsoft Entra groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
      "related_controls": [
        "4b69bad3-3aad-45e8-a68e-1d76667313b4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
      "related_controls": [
        "53e8908a-e28c-484c-93b6-b7808b9fe5c4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
      "related_controls": [
        "1049d403-a923-4c34-94d0-0018ac6a9e01"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements.",
      "related_controls": [
        "e6a83de5-de32-4c19-a248-1607d5d1e4e6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
      "related_controls": [
        "14658d35-58fd-4772-99b8-21112df27ee4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Microsoft recommends that you use roles with the fewest permissions. Global Administrator is a highly privileged role that should be limited to emergency scenarios when you can't use an existing role.",
      "related_controls": [
        "d98d954d-7d1c-4a07-92a7-cf3afe8dcbd2"
      ]
    },
    {
      "source": "Manual control",
      "question": "When deploying Active Directory Domain Controllers, use a location with Availability Zones and deploy at least two VMs across these zones. If not available, deploy in an Availability Set.",
      "related_controls": [
        "1559ab91-53e8-4908-ae28-c84c33b6b780"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy your Azure landing zone identity resources in multiple regions.  If using domain controllers, associate each region with an Active Directory site so that resources can resolve to their local domain controllers.",
      "related_controls": [
        "e8aa1e41-870d-4968-94c6-77be14f510ac"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure custom RBAC roles for the following key roles to provide fine-grain access across your ALZ: Azure platform owner, network management, security operations, subscription owner, application owner. Align these roles to teams and responsibilities within your business.",
      "related_controls": [
        "f5664b5e-984a-4859-a773-e7d261623a76"
      ]
    },
    {
      "source": "Manual control",
      "question": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
      "related_controls": [
        "8b9fe5c4-1049-4d40-9a92-3c3474d00018"
      ]
    },
    {
      "source": "Manual control",
      "question": "When using Microsoft Entra Domain Services, use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
      "related_controls": [
        "0dd4e625-9c4b-4a56-b54a-4357bac12761"
      ]
    },
    {
      "source": "Manual control",
      "question": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to useâ€¯passkey (FIDO2)â€¯orâ€¯configure certificate-based authentication for MFA. ",
      "related_controls": [
        "984a859c-773e-47d2-9162-3a765a917e1f"
      ]
    },
    {
      "source": "Manual control",
      "question": "When deploying Microsoft Entra Connect, use a staging sever for high availability/disaster recovery.",
      "related_controls": [
        "cd163e39-84a5-4b39-97b7-6973abd70d94"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
      "related_controls": [
        "35037e68-9349-4c15-b371-228514f4cdff"
      ]
    },
    {
      "source": "Manual control",
      "question": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource.",
      "related_controls": [
        "d5d1e4e6-1465-48d3-958f-d77249b82111"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure Identity network segmentation through the use of a virtual Network and peer back to the hub. Providing authentication inside application landing zone (legacy).",
      "related_controls": [
        "9cf5418b-1520-4b7b-add7-88eb28f833e8"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure RBAC to manage data plane access to resources, if possible. E.g. Data Operations across Key Vault, Storage Account and Database Services.",
      "related_controls": [
        "d4d1ad54-1abc-4919-b267-3f342d3b49e4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Microsoft Entra ID PIM access reviews to periodically validate resource entitlements.",
      "related_controls": [
        "d505ebcb-79b1-4274-9c0d-a27c8bea489c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Restrict and minimize the number of account owners within the enrollment to limit administrator access to subscriptions and associated Azure resources.",
      "related_controls": [
        "0ce74f19-9abb-47e4-ae95-6b057a1d2be9"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use a well defined naming scheme for resources, such as Microsoft Best Practice Naming Standards.",
      "related_controls": [
        "cacf55bc-e4e4-46be-96bc-57a5f23a269a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce a sandbox management group to allow users to immediately experiment with Azure.",
      "related_controls": [
        "667313b4-f566-44b5-b984-a859c773e7d2"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce no subscriptions are placed under the root management group.",
      "related_controls": [
        "33b6b780-8b9f-4e5c-9104-9d403a923c34"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings.",
      "related_controls": [
        "74d00018-ac6a-49e0-8e6a-83de5de32c19"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
      "related_controls": [
        "2dd69c5b-5c26-422f-94b6-9bad33aad5e8"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions.",
      "related_controls": [
        "c68e1d76-6673-413b-9f56-64b5e984a859"
      ]
    },
    {
      "source": "Manual control",
      "question": "Establish dashboards and/or visualizations to monitor compute and storage capacity metrics. (i.e. CPU, memory, disk space)",
      "related_controls": [
        "c773e7d2-6162-43a7-95a9-17e1f348ef25"
      ]
    },
    {
      "source": "Manual control",
      "question": "As part of your cloud adoption, implement a detailed cost management plan using the 'Managed cloud costs' process.",
      "related_controls": [
        "ae28c84c-33b6-4b78-88b9-fe5c41049d40"
      ]
    },
    {
      "source": "Manual control",
      "question": "If servers will be used for Identity services, like domain controllers, establish a dedicated identity subscription in the identity management group, to host these services. Make sure that resources are set to use the domain controllers available in their region.",
      "related_controls": [
        "3a923c34-74d0-4001-aac6-a9e01e6a83de"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure tags are used for billing and cost management.",
      "related_controls": [
        "5de32c19-9248-4160-9d5d-1e4e614658d3"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
      "related_controls": [
        "6cc0ea22-42bb-441e-a345-804ab0a09666"
      ]
    },
    {
      "source": "Manual control",
      "question": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
      "related_controls": [
        "250d81ce-8bbe-4f85-9051-6a18a8221e50"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy your Azure landing zone in a multi-region deployment. Depending on customer size, locations, and users presence, operating in multiple regions can be a common choice to deliver services and run applications closer to them. Using a multi-region deployment is also important to provide geo disaster recovery capabilities, to eliminate the dependency from a single region capacity and diminish the risk of a temporary and localized resource capacity constraint.",
      "related_controls": [
        "19ca3f89-397d-44b1-b5b6-5e18661372ac"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure required services and features are available within the chosen deployment regions.",
      "related_controls": [
        "4c27d42e-8bba-4c75-9155-9ab9153e8908"
      ]
    },
    {
      "source": "Manual control",
      "question": "Document a standard for securing the delivery application content from your Workload spokes using Application Gateway and Azure Front Door.  You can use the Application Delivery checklist to for recommendations.",
      "related_controls": [
        "373f482f-3e39-4d39-8aa4-7e566f6082b6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
      "related_controls": [
        "7bc1c396-2461-4698-b57f-30ca69525252"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
      "related_controls": [
        "7dd61623-a364-4a90-9eca-e48ebd54cd7d"
      ]
    },
    {
      "source": "Manual control",
      "question": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
      "related_controls": [
        "e2e8abac-3571-4559-ab91-53e89f89dc7b"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
      "related_controls": [
        "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2"
      ]
    },
    {
      "source": "Manual control",
      "question": "If using Route Server, use a /27 prefix for the Route Server subnet.",
      "related_controls": [
        "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc"
      ]
    },
    {
      "source": "Manual control",
      "question": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
      "related_controls": [
        "cc881471-607c-41cc-a0e6-14658dd558f9"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
      "related_controls": [
        "4722d929-c1b1-4cd6-81f5-4b29bade39ad"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
      "related_controls": [
        "0e7c28ec-9366-4572-83b0-f4664b1d944a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Limit the number of routes per route table to 400.",
      "related_controls": [
        "3d457936-e9b7-41eb-bdff-314b26450b12"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
      "related_controls": [
        "c76cb5a2-abe2-11ed-afa1-0242ac120002"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
      "related_controls": [
        "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
      "related_controls": [
        "48682fb1-1e86-4458-a686-518ebd47393d"
      ]
    },
    {
      "source": "Manual control",
      "question": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
      "related_controls": [
        "de0d5973-cd4c-4d21-a088-137f5e6c4cfd"
      ]
    },
    {
      "source": "Manual control",
      "question": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
      "related_controls": [
        "ed301d6e-872e-452e-9611-cc58b5a4b151"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
      "related_controls": [
        "558fd772-49b8-4211-82df-27ee412e7f98"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
      "related_controls": [
        "3f630472-2dd6-49c5-a5c2-622f54b69bad"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
      "related_controls": [
        "33aad5e8-c68e-41d7-9667-313b4f5664b5"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
      "related_controls": [
        "f348ef25-4c27-4d42-b8bb-ac7571559ab9"
      ]
    },
    {
      "source": "Manual control",
      "question": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
      "related_controls": [
        "153e8908-ae28-4c84-a33b-6b7808b9fe5c"
      ]
    },
    {
      "source": "Manual control",
      "question": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
      "related_controls": [
        "41049d40-3a92-43c3-974d-00018ac6a9e0"
      ]
    },
    {
      "source": "Manual control",
      "question": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
      "related_controls": [
        "1e6a83de-5de3-42c1-a924-81607d5d1e4e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
      "related_controls": [
        "614658d3-558f-4d77-849b-821112df27ee"
      ]
    },
    {
      "source": "Manual control",
      "question": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
      "related_controls": [
        "18c80eb0-582a-4198-bf5c-d8800b2d263b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Disable Windows systems from attempting to use port 65330 in Azure, Windows systems in Azure may attempt to use port 65330 for DNS resolution, which can cause timeouts and connectivity issues. Disabling this behavior can help prevent these issues.",
      "related_controls": [
        "baac3ecb-a94c-4ac4-8c79-cdf27c0d78df"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Bastion to securely connect to your network.",
      "related_controls": [
        "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Bastion in a subnet /26 or larger.",
      "related_controls": [
        "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
      "related_controls": [
        "1d7aa9b6-4704-4489-a804-2d88e79d17b7"
      ]
    },
    {
      "source": "Manual control",
      "question": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
      "related_controls": [
        "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b"
      ]
    },
    {
      "source": "Manual control",
      "question": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
      "related_controls": [
        "2363cefe-179b-4599-be0d-5973cd4cd21b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
      "related_controls": [
        "b034c01e-110b-463a-b36e-e3346e57f225"
      ]
    },
    {
      "source": "Manual control",
      "question": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
      "related_controls": [
        "b1c82a3f-2320-4dfa-8972-7ae4823c8930"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
      "related_controls": [
        "359c373e-7dd6-4162-9a36-4a907ecae48e"
      ]
    },
    {
      "source": "Manual control",
      "question": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
      "related_controls": [
        "f29812b2-363c-4efe-879b-599de0d5973c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
      "related_controls": [
        "d4cd21b0-8813-47f5-b6c4-cfd3e504547c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
      "related_controls": [
        "7025b442-f6e9-4af6-b11f-c9574916016f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
      "related_controls": [
        "f4e7926a-ec35-476e-a412-5dd17136bd62"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
      "related_controls": [
        "2447ec66-138a-4720-8f1c-e16ed301d6e8"
      ]
    },
    {
      "source": "Manual control",
      "question": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
      "related_controls": [
        "72e52e36-11cc-458b-9a4b-1511e43a58a9"
      ]
    },
    {
      "source": "Manual control",
      "question": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
      "related_controls": [
        "c2299c4d-7b57-4d0c-9555-62f2b3e4563a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
      "related_controls": [
        "4d873974-8b66-42d6-b15f-512a65498f6d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use redundant VPN appliances on-premises (active/active or active/passive).",
      "related_controls": [
        "45866df8-cf85-4ca9-bbe2-65ec1478919e"
      ]
    },
    {
      "source": "Manual control",
      "question": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
      "related_controls": [
        "718cb437-b060-2589-8856-2e93a5c6633b"
      ]
    },
    {
      "source": "Manual control",
      "question": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
      "related_controls": [
        "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
      "related_controls": [
        "b30e38c3-f298-412b-8363-cefe179b599d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
      "related_controls": [
        "5bf68dc9-325e-4873-bf88-f8214ef2e5d2"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use ExpressRoute circuits from different peering locations for redundancy.",
      "related_controls": [
        "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
      "related_controls": [
        "cf3fe65c-fec0-495a-8edc-9675200f2add"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
      "related_controls": [
        "72105cc8-aaea-4ee1-8c7a-ad25977afcaf"
      ]
    },
    {
      "source": "Manual control",
      "question": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
      "related_controls": [
        "d581a947-69a2-4783-942e-9df3664324c8"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
      "related_controls": [
        "b258f058-b9f6-46cd-b28d-990106f0c3f8"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
      "related_controls": [
        "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb"
      ]
    },
    {
      "source": "Manual control",
      "question": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
      "related_controls": [
        "669b215a-ce43-4371-8f6f-11047f6490f1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
      "related_controls": [
        "3f79ed00-203b-4c95-9efd-691505f5a1f9"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
      "related_controls": [
        "5234c93f-b651-41dd-80c1-234177b91ced"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
      "related_controls": [
        "8ac6a9e0-1e6a-483d-b5de-32c199248160"
      ]
    },
    {
      "source": "Manual control",
      "question": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
      "related_controls": [
        "5a4b1511-e43a-458a-ac22-99c4d7b57d0c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
      "related_controls": [
        "655562f2-b3e4-4563-a4d8-739748b662d6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
      "related_controls": [
        "14d99880-2f88-47e8-a134-62a7d85c94af"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Firewall Premium to enable additional security features.",
      "related_controls": [
        "c10d51ef-f999-455d-bba0-5c90ece07447"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
      "related_controls": [
        "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
      "related_controls": [
        "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c"
      ]
    },
    {
      "source": "Manual control",
      "question": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
      "related_controls": [
        "a3784907-9836-4271-aafc-93535f8ec08b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
      "related_controls": [
        "715d833d-4708-4527-90ac-1b142c7045ba"
      ]
    },
    {
      "source": "Manual control",
      "question": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
      "related_controls": [
        "e960fc6b-4ab2-4db6-9609-3745135f9ffa"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use a /26 prefix for your Azure Firewall subnets.",
      "related_controls": [
        "22d6419e-b627-4d95-9e7d-019fa759387f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
      "related_controls": [
        "828cec2e-af6c-40c2-8fa2-1b681ee63eb7"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
      "related_controls": [
        "0da83bb1-2f39-49af-b5c9-835fc455e3d1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
      "related_controls": [
        "c44c6f0e-1642-4a61-a17b-0922f835c93a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, itâ€™s a sign that SNAT exhaustion might be imminent.",
      "related_controls": [
        "7371dc21-251a-47a3-af14-6e01b9da4757"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you are using Azure Firewall Premium, enable TLS Inspection.",
      "related_controls": [
        "346840b8-1064-496e-8396-4b1340172d52"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use web categories to allow or deny outbound access to specific topics.",
      "related_controls": [
        "39990a13-915c-45f9-a2d3-562d7d6c4b7c"
      ]
    },
    {
      "source": "Manual control",
      "question": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
      "related_controls": [
        "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable Azure Firewall DNS proxy configuration.",
      "related_controls": [
        "94f3eede-9aa3-4088-92a3-bb9a56509fad"
      ]
    },
    {
      "source": "Manual control",
      "question": "Implement backups for your firewall rules",
      "related_controls": [
        "64e7000e-3c06-485e-b455-ced7f454cba3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
      "related_controls": [
        "d38ad60c-bc9e-4d49-b699-97e5d4dcf707"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
      "related_controls": [
        "e8143efa-0301-4d62-be54-ca7b5ce566dc"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
      "related_controls": [
        "d301d6e8-72e5-42e3-911c-c58b5a4b1511"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Private Link, where available, for shared Azure PaaS services.",
      "related_controls": [
        "e43a58a9-c229-49c4-b7b5-7d0c655562f2"
      ]
    },
    {
      "source": "Manual control",
      "question": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
      "related_controls": [
        "b3e4563a-4d87-4397-98b6-62d6d15f512a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Don't enable virtual network service endpoints by default on all subnets.",
      "related_controls": [
        "4704489a-8042-4d88-b79d-17b73b22a5a6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
      "related_controls": [
        "7e7a8ed4-b30e-438c-9f29-812b2363cefe"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use at least a /27 prefix for your Gateway subnets.",
      "related_controls": [
        "f2aad7e3-bb03-4adc-8606-4123d342a917"
      ]
    },
    {
      "source": "Manual control",
      "question": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
      "related_controls": [
        "11deb39d-8299-4e47-bbe0-0fb5a36318a8"
      ]
    },
    {
      "source": "Manual control",
      "question": "Delegate subnet creation to the landing zone owner.",
      "related_controls": [
        "c2447ec6-6138-4a72-80f1-ce16ed301d6e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
      "related_controls": [
        "872e52e3-611c-4c58-a5a4-b1511e43a58a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
      "related_controls": [
        "a4d87397-48b6-462d-9d15-f512a65498f6"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
      "related_controls": [
        "dfe237de-143b-416c-91d7-aa9b64704489"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
      "related_controls": [
        "0390417d-53dc-44d9-b3f4-c8832f359b41"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
      "related_controls": [
        "412e7f98-3f63-4047-82dd-69c5b5c2622f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
      "related_controls": [
        "54b69bad-33aa-4d5e-ac68-e1d76667313b"
      ]
    },
    {
      "source": "Manual control",
      "question": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
      "related_controls": [
        "7d5d1e4e-6146-458d-9558-fd77249b8211"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
      "related_controls": [
        "6667313b-4f56-464b-9e98-4a859c773e7d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
      "related_controls": [
        "261623a7-65a9-417e-8f34-8ef254c27d42"
      ]
    },
    {
      "source": "Manual control",
      "question": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
      "related_controls": [
        "727c77e1-b9aa-4a37-a024-129d042422c1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
      "related_controls": [
        "d49ac006-6670-4bc9-9948-d3e0a3a94f4d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
      "related_controls": [
        "2586b854-237e-47f1-84a1-d45d4cd2310d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
      "related_controls": [
        "9c75dfef-573c-461c-a698-68598595581a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
      "related_controls": [
        "223ace8c-b123-408c-a501-7f154e3ab369"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
      "related_controls": [
        "43334f24-9116-4341-a2ba-527526944008"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use built-in policies where possible to minimize operational overhead.",
      "related_controls": [
        "be7d7e48-4327-46d8-adc0-55bcf619e8a1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
      "related_controls": [
        "3f988795-25d6-4268-a6d7-0ba6c97be995"
      ]
    },
    {
      "source": "Manual control",
      "question": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
      "related_controls": [
        "19048384-5c98-46cb-8913-156a12476e49"
      ]
    },
    {
      "source": "Manual control",
      "question": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
      "related_controls": [
        "5a917e1f-348e-4f25-9c27-d42e8bbac757"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
      "related_controls": [
        "78b22132-b41c-460b-a4d3-df8f73a67dc2"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
      "related_controls": [
        "caeea0e9-1024-41df-a52e-d99c3f22a6f4"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
      "related_controls": [
        "9b461617-db7b-4399-8ac6-d4eb7153893a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Configure 'Actual' and 'Forecasted' Budget Alerts.",
      "related_controls": [
        "29fd366b-a180-452b-9bd7-954b7700c667"
      ]
    },
    {
      "source": "Manual control",
      "question": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
      "related_controls": [
        "7418ada9-4199-4c28-8286-d15e9433e8f3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
      "related_controls": [
        "5e6c4cfd-3e50-4454-9c24-47ec66138a72"
      ]
    },
    {
      "source": "Manual control",
      "question": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
      "related_controls": [
        "e7d7e484-3276-4d8b-bc05-5bcf619e8a13"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
      "related_controls": [
        "f9887952-5d62-4688-9d70-ba6c97be9951"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
      "related_controls": [
        "c806c048-26b7-4ddf-b4c2-b4f0c476925d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Network Watcher to proactively monitor traffic flows.",
      "related_controls": [
        "90483845-c986-4cb2-a131-56a12476e49f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use resource locks to prevent accidental deletion of critical shared services.",
      "related_controls": [
        "541acdce-9793-477b-adb3-751ab2ab13ad"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
      "related_controls": [
        "a6e55d7d-8a2a-4db1-87d6-326af625ca44"
      ]
    },
    {
      "source": "Manual control",
      "question": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
      "related_controls": [
        "e5695f22-23ac-4e8c-a123-08ca5017f154"
      ]
    },
    {
      "source": "Manual control",
      "question": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned.",
      "related_controls": [
        "d5f345bf-97ab-41a7-819c-6104baa7d48c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
      "related_controls": [
        "e3ab3693-829e-47e3-8618-3687a0477a20"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Monitor Logs for insights and reporting.",
      "related_controls": [
        "6944008b-e7d7-4e48-9327-6d8bdc055bcf"
      ]
    },
    {
      "source": "Manual control",
      "question": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
      "related_controls": [
        "619e8a13-f988-4795-85d6-26886d70ba6c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Monitor alerts for the generation of operational alerts.",
      "related_controls": [
        "97be9951-9048-4384-9c98-6cb2913156a1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied.",
      "related_controls": [
        "859c3900-4514-41eb-b010-475d695abd74"
      ]
    },
    {
      "source": "Manual control",
      "question": "Deploy AMBA to establish monitoring for platform components of your landing zone - AMBA is a framework solution that is available and provides an easy way to scale alerting by using Azure Policy.",
      "related_controls": [
        "aa45be6a-8f2d-4896-b0e3-775e6e94e610"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure that storage accounts are zone or region redundant, Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.",
      "related_controls": [
        "0d83fd81-952c-4d47-a6cb-3a930925ef2e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Employ Azure Site Recovery for Azure-to-Azure VM DR scenarios. Use Azure-native backup capabilities.",
      "related_controls": [
        "7ea02e1c-7166-45a3-bdf5-098891367fcb"
      ]
    },
    {
      "source": "Manual control",
      "question": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
      "related_controls": [
        "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
      "related_controls": [
        "f541acdc-e979-4377-acdb-3751ab2ab13a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Monitor VM security configuration drift via Azure Policy.",
      "related_controls": [
        "da6e55d7-d8a2-4adb-817d-6326af625ca4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use native PaaS service disaster recovery capabilities.  Perform failover testing with these capabilities.",
      "related_controls": [
        "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
      "related_controls": [
        "f625ca44-e569-45f2-823a-ce8cb12308ca"
      ]
    },
    {
      "source": "Manual control",
      "question": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
      "related_controls": [
        "89cc5e11-aa4d-4c3b-893d-feb99215266a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
      "related_controls": [
        "7f408960-c626-44cb-a018-347c8d790cdf"
      ]
    },
    {
      "source": "Manual control",
      "question": "Determine the incident response plan for Azure services before allowing it into production.",
      "related_controls": [
        "b86ad884-08e3-4727-94b8-75ba18f20459"
      ]
    },
    {
      "source": "Manual control",
      "question": "Apply a zero-trust approach for access to the Azure platform.",
      "related_controls": [
        "01365d38-e43f-49cc-ad86-8266abca264f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Azure Key Vault to store your secrets and credentials.",
      "related_controls": [
        "5017f154-e3ab-4369-9829-e7e316183687"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use different Azure Key Vaults for different applications, environments and regions to avoid transaction scale limits and restrict access to secrets.",
      "related_controls": [
        "a0477a20-9945-4bda-9333-4f2491163418"
      ]
    },
    {
      "source": "Manual control",
      "question": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
      "related_controls": [
        "2ba52752-6944-4008-ae7d-7e4843276d8b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Follow a least privilege model by assigning just-in-time eligible RBAC roles for operators, administrators, and other user accounts requiring privileged access to Key Vault using Privileged Identity Management (PIM).",
      "related_controls": [
        "dc055bcf-619e-48a1-9f98-879525d62688"
      ]
    },
    {
      "source": "Manual control",
      "question": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
      "related_controls": [
        "6d70ba6c-97be-4995-8904-83845c986cb2"
      ]
    },
    {
      "source": "Manual control",
      "question": "Establish an automated process for key and certificate rotation.",
      "related_controls": [
        "913156a1-2476-4e49-b541-acdce979377b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable private endpoints to control access to the key vault, configure service endpoints and the vault firewall if private endpoints are not applicable",
      "related_controls": [
        "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
      "related_controls": [
        "17d6326a-f625-4ca4-9e56-95f2223ace8c"
      ]
    },
    {
      "source": "Manual control",
      "question": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
      "related_controls": [
        "b12308ca-5017-4f15-9e3a-b3693829e7e3"
      ]
    },
    {
      "source": "Manual control",
      "question": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
      "related_controls": [
        "16183687-a047-47a2-8994-5bda43334f24"
      ]
    },
    {
      "source": "Manual control",
      "question": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
      "related_controls": [
        "25d62688-6d70-4ba6-a97b-e99519048384"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
      "related_controls": [
        "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
      "related_controls": [
        "4e5695f2-223a-4ce8-ab12-308ca5017f15"
      ]
    },
    {
      "source": "Manual control",
      "question": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond 12 years, if necessary.",
      "related_controls": [
        "4e3ab369-3829-4e7e-9161-83687a0477a2"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable Endpoint Protection on IaaS Servers.",
      "related_controls": [
        "24d96b30-61ee-4436-a1cc-d6ef08bc574b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
      "related_controls": [
        "e5f8d79f-2e87-4768-924c-516775c6ea95"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
      "related_controls": [
        "1761e147-f65e-4d09-bbc2-f464f23e2eba"
      ]
    },
    {
      "source": "Manual control",
      "question": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
      "related_controls": [
        "d21a922d-5ca7-427a-82a6-35f7b21f1bfc"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use an Azure Event Grid-based solution for log-oriented, real-time alerts.",
      "related_controls": [
        "874a748b-662d-46d1-9051-2a66498f6dfe"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable secure transfer to storage accounts.",
      "related_controls": [
        "b03ed428-4617-4067-a787-85468b9ccf3f"
      ]
    },
    {
      "source": "Manual control",
      "question": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
      "related_controls": [
        "159aac9f-863f-4f48-82cf-00c28fa97a0e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Separate privileged admin accounts for Azure administrative tasks.",
      "related_controls": [
        "6f704104-85c1-441f-96d3-c9819911645e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Plan how new azure services will be implemented.",
      "related_controls": [
        "9a19bf39-c95d-444c-9c89-19ca1f6d5215"
      ]
    },
    {
      "source": "Manual control",
      "question": "Plan how service request will be fulfilled for Azure services.",
      "related_controls": [
        "ae514b93-3d45-485e-8112-9bd7ba012f7b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure you have a cross functional DevOps Platform Team to build, manage and maintain your Azure Landing Zone architecture.",
      "related_controls": [
        "e85f4226-bf06-4e35-8a8b-7aee4d2d633a"
      ]
    },
    {
      "source": "Manual control",
      "question": "Aim to define functions for Azure Landing Zone Platform team.",
      "related_controls": [
        "634146bf-7085-4419-a7b5-f96d2726f6da"
      ]
    },
    {
      "source": "Manual control",
      "question": "Aim to define functions for application workload teams to be self-sufficient and not require DevOps Platform Team support. Achieve this through the use of custom RBAC role.",
      "related_controls": [
        "a9e65070-c59e-4112-8bf6-c11364d4a2a5"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use a CI/CD pipeline to deploy IaC artifacts and ensure the quality of your deployment and Azure environments.",
      "related_controls": [
        "165eb5e9-b434-448a-9e24-178632186212"
      ]
    },
    {
      "source": "Manual control",
      "question": "Include unit tests for IaC and application code as part of your build process.",
      "related_controls": [
        "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460"
      ]
    },
    {
      "source": "Manual control",
      "question": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
      "related_controls": [
        "108d5099-a11d-4445-bd8b-e12a5e95412e"
      ]
    },
    {
      "source": "Manual control",
      "question": "Implement automation for new landing zone for applications and workloads through subscription vending.",
      "related_controls": [
        "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4"
      ]
    },
    {
      "source": "Manual control",
      "question": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
      "related_controls": [
        "cfe363b5-f579-4284-bc56-a42153e4c10b"
      ]
    },
    {
      "source": "Manual control",
      "question": "Follow a branching strategy to allow teams to collaborate better and efficiently manage version control of IaC and application Code. Review options such as Github Flow.",
      "related_controls": [
        "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d"
      ]
    },
    {
      "source": "Manual control",
      "question": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
      "related_controls": [
        "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe"
      ]
    },
    {
      "source": "Manual control",
      "question": "Establish a process for using code to implement quick fixes. Always register quick fixes in your team's backlog so each fix can be reworked at a later point, and you can limit technical debt.",
      "related_controls": [
        "2676ae46-65ca-444e-8695-fdddeace4cb1"
      ]
    },
    {
      "source": "Manual control",
      "question": "Leverage Declarative Infrastructure as Code Tools such as Azure Bicep, ARM Templates or Terraform to build and maintain your Azure Landing Zone architecture. Both from a Platform and Application workload perspective.",
      "related_controls": [
        "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73"
      ]
    },
    {
      "source": "Manual control",
      "question": "Integrate security into the already combined process of development and operations in DevOps to mitigate risks in the innovation process.",
      "related_controls": [
        "cc87a3bc-c572-4ad2-92ed-8cabab66160f"
      ]
    },
    {
      "source": "Assumption",
      "question": "No management group hierarchy was detected; assuming none exists and full CAF-aligned hierarchy is required.",
      "related_controls": []
    },
    {
      "source": "Assumption",
      "question": "Only one subscription is visible; assuming this is the only active subscription or others are not in scope.",
      "related_controls": []
    },
    {
      "source": "Assumption",
      "question": "Resource organization, identity, and billing controls are all manual; assuming no significant platform automation or RBAC model is in place.",
      "related_controls": []
    },
    {
      "source": "Assumption",
      "question": "No evidence of existing network topology; assuming no hub-spoke or Virtual WAN is implemented.",
      "related_controls": []
    }
  ],
  "executive_summary": {
    "summary": "Current platform maturity is 10.5%. The environment exhibits critical deficiencies across all assessed design areas. No Azure Firewall or hub-spoke topology is present, leaving the platform without centralized egress or DNS policy enforcement. DDoS Protection is absent on all VNets. Defender for Cloud coverage is minimal — CSPM is disabled, Defender for Servers is inactive, and only 6 of 18 CWP plans are enabled (33.3%).\n\nGovernance structures are critically incomplete — no Platform or Landing Zones management groups exist, policy initiative coverage is negligible (1 assignment), and all evaluated resources are noncompliant. Diagnostics coverage stands at 2.1%, preventing centralized operations monitoring. The platform cannot scale to enterprise-scale operations in its current state.",
    "top_business_risks": [
      {
        "title": "No Network Security Perimeter",
        "business_impact": "All landing zone workloads are exposed without centralized egress filtering, DDoS protection, or topology enforcement.",
        "technical_cause": "No Azure Firewall, hub-spoke topology, or DDoS Protection detected. Public IPs use Basic SKU.",
        "severity": "Critical",
        "affected_controls": [
          "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
          "0c47f486-656d-4699-8c30-edef5b8a93c4"
        ]
      },
      {
        "title": "Defender for Cloud Not Operational",
        "business_impact": "No cloud workload protection, no CSPM posture management, no server-level threat detection.",
        "technical_cause": "Defender CSPM disabled, Defender for Servers disabled, only 33.3% CWP plan coverage.",
        "severity": "Critical",
        "affected_controls": [
          "09945bda-4333-44f2-9911-634182ba5275",
          "36a72a48-fffe-4c40-9747-0ab5064355ba",
          "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
        ]
      },
      {
        "title": "Governance Framework Absent",
        "business_impact": "Cannot delegate ownership or enforce policy across landing zones; all resources noncompliant.",
        "technical_cause": "No management group hierarchy for platform/LZ segregation. 12 of 12 resources noncompliant. Minimal policy initiatives.",
        "severity": "Critical",
        "affected_controls": [
          "61623a76-5a91-47e1-b348-ef254c27d42e",
          "92481607-d5d1-4e4e-9146-58d3558fd772",
          "8bbac757-1559-4ab9-853e-8908ae28c84c",
          "5c986cb2-9131-456a-8247-6e49f541acdc",
          "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
          "49b82111-2df2-47ee-912e-7f983f630472"
        ]
      }
    ],
    "investment_priorities": [
      {
        "priority": 1,
        "initiative": "Implement hub-spoke network topology with centralized egress and Azure Firewall to enable connectivity policy inheritance.",
        "estimated_effort": "Moderate",
        "business_value": "Unblocks delegated landing zone connectivity and consistent network policy across subscriptions."
      },
      {
        "priority": 2,
        "initiative": "Centralize diagnostics, Defender for Cloud, and Entra ID logs to enable platform-wide operations monitoring.",
        "estimated_effort": "Moderate",
        "business_value": "Enables centralized operations baseline required before landing zone rollout to workload teams."
      },
      {
        "priority": 3,
        "initiative": "Establish management group hierarchy with policy assignments to enable subscription lifecycle and guardrails.",
        "estimated_effort": "Low",
        "business_value": "Enables policy inheritance, subscription vending, and delegated landing zone ownership."
      }
    ],
    "expected_outcomes_90_days": [
      "Hub-spoke topology with centralized egress deployed; connectivity policy inherited by landing zone subscriptions.",
      "Centralized diagnostics coverage increased to at least 60% of resources, including Entra ID logs to Log Analytics.",
      "Management group hierarchy established with platform policy assignments; subscription vending process documented."
    ]
  },
  "transformation_plan": {
    "initiatives": [
      {
        "checklist_id": "A01.01",
        "title": "Establish platform and landing zone management group hierarchy",
        "priority": 1,
        "blast_radius": "High",
        "caf_discipline": "Govern",
        "why_it_matters": "Enables policy inheritance, RBAC, and structured resource onboarding; foundational for all subsequent governance and security controls",
        "success_criteria": "Platform and landing zone management groups created; subscriptions correctly placed",
        "controls": [
          "61623a76-5a91-47e1-b348-ef254c27d42e",
          "92481607-d5d1-4e4e-9146-58d3558fd772"
        ],
        "dependencies": [],
        "permission_requirements": [
          "Tenant root or management group admin"
        ],
        "owner_role": "Cloud Platform Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering"
          ],
          "change_scope": "Tenant"
        },
        "learn_references": [
          {
            "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
            "url": "",
            "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Monitoring\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach is consistent with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#monitoring).\nThe workload team provisions the monitoring resources, which include:\n1. Application Insights as the application performance monitoring (APM) service for the workload team.\n2. The Log Analytics workspace as the unified sink for all logs and metrics that are collected from workload-owned Azure resources and the application code.\n[![Diagram that shows monitoring resources for the workload.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-monitoring.vsdx) of this architecture.*\nSimilar to the baseline, all resources are configured to send Azure Diagnostics logs to the Log Analytics workspace that the workload team provisions as part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Log Analytics workspace. In Azure landing zones, that workspace is in the management subscription.\nThe platform team might also have DINE policies that they can use to configure Diagnostics to send logs to their centralized management subscriptions. It's important to ensure that your implementation doesn't restrict the additional log flows.\n### Correlate data from multiple sinks\nThe workload's logs and metrics and its infrastructure components are stored in the workload's Log Analytics workspace. However, logs and metrics that centralized services, such as Azure Firewall, Microsoft Entra ID, and Azure Bastion, generate are stored in a central Log Analytics workspace. Correlating data from multiple sinks can be a complex task.\nCorrelated data is often used during incident response. If there's a problem with correlating data from multiple sinks, make sure the triage runbook for this architecture addresses it and includes organizational points of contact if the problem extends beyond the workload resources. Workload administrators might require assistance from platform administrators to correlate log entries from enterprise networking, security, or other platform services.\nImportant\n**For the platform team:** Where possible, grant Azure role-based access control (Azure RBAC) to query and read log sinks for relevant platform resources. Enable firewall logs for network and application rule evaluations and DNS proxy because the application teams can use this information during troubleshooting tasks."
          },
          {
            "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
            "url": "",
            "excerpt": "# Baseline Microsoft Foundry chat reference architecture in an Azure landing zone\n## Monitor resources\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach aligns with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/architecture/baseline-microsoft-foundry-chat#monitoring).\nYou provision the following monitoring resources:\n1. Application Insights serves as the application performance management (APM) service for your team. You configure this service in the chat UI, Agent Service, and models.\n2. The Azure Monitor Logs workspace serves as the unified sink for all logs and metrics from workload-owned Azure resources.\nSimilar to the baseline architecture, all resources must send Azure diagnostics logs to the Azure Monitor Logs workspace that your team provisions. This configuration is part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Azure Monitor Logs workspace. In Azure landing zones, that workspace typically resides in the management subscription.\nThe platform team might have more processes that affect resources in the application landing zone. For example, they might use DINE policies to configure diagnostics and send logs to centralized management subscriptions. They might also apply [Azure Monitor baseline alerts](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/) through policy. Ensure that your implementation doesn't block these extra logging and alerting flows."
          },
          {
            "title": "Monitor Azure platform landing zone components",
            "url": "",
            "excerpt": "# Monitor Azure platform landing zone components\n## Azure landing zone monitoring guidance\nBaseline metric, activity log, and log query alerts are available for landing zone platform components and other selected landing zone components. These alerts ensure consistent alerting and monitoring for your Azure landing zone. They're based on Microsoft-recommended practices for proactive monitoring, such as setting up alerts, thresholds, and notifications for timely problem detection and response. Use the following guidance to achieve real-time visibility into the performance, utilization, and security of your platform landing zone implementation. Proactively address issues, optimize resource allocation, and ensure a reliable and secure environment.\n[![Diagram that shows Azure Monitor baseline alert topology.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg)](media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n[Diagram that shows the initiatives are applied at the platform management groups, connectivity, identity and management while the landing zone initiative is applied to the landing zones management group. The service health initiative and notifications assets initiative is applied at the intermediate root management group so that it is applied to all subscriptions.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n*Download a [Visio file](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/media/AMBA-Diagrams.vsdx) of this architecture.*\nThe following subsets of Azure components have one or more alerts defined:\n1. Azure ExpressRoute\n2. Azure Firewall\n3. Azure Virtual Network\n4. Azure Virtual WAN\n5. Azure Monitor Log Analytics workspace\n6. Azure Private DNS zone\n7. Azure Key Vault\n8. Azure Virtual Machine\n9. Azure Storage account\nFor more information, see [Alert details](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-overview).\nTo ensure that your organization's resources are properly monitored and secured, you also need to properly configure alerts and implement appropriate processes to respond to alerts. Configure action groups with the appropriate notification channels and test the alerts to ensure that they work as expected. In accordance with the Cloud Adoption Framework principle of subscription democratization, configure at least one action group for each subscription so that relevant staff is notified of alerts. As a minimum form of notification, the action group should include an email notification channel. If you use Azure Monitor alert processing rules to route alerts to one or more action groups, note that service health alerts don't support alert processing rules. Configure service health alerts directly with the action group."
          }
        ]
      },
      {
        "checklist_id": "E01.01",
        "title": "Centralize diagnostics and security visibility",
        "priority": 2,
        "blast_radius": "High",
        "caf_discipline": "Manage",
        "why_it_matters": "Improves operational insight, accelerates threat detection, and supports compliance reporting",
        "success_criteria": "Diagnostics coverage exceeds 30%; logs centralized in Log Analytics",
        "controls": [
          "a56888b2-7e83-4404-bd31-b886528502d1",
          "67e7a8ed-4b30-4e38-a3f2-9812b2363cef"
        ],
        "dependencies": [],
        "permission_requirements": [
          "Subscription contributor",
          "Log Analytics admin"
        ],
        "owner_role": "Cloud Operations Lead",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering",
            "Security"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Design area: Security",
            "url": "",
            "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
          },
          {
            "title": "Protect your resources with Defender CSPM",
            "url": "",
            "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
          },
          {
            "title": "Prepare your landing zone for migration",
            "url": "",
            "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
          }
        ]
      },
      {
        "checklist_id": "F01.01",
        "title": "Apply baseline governance policies",
        "priority": 3,
        "blast_radius": "High",
        "caf_discipline": "Govern",
        "why_it_matters": "Enforces compliance, resource standards, and public IP governance to reduce risk",
        "success_criteria": "Policy compliance exceeds 50%; public IPs governed",
        "controls": [
          "3c5a808d-c695-4c14-a63c-c7ab7a510e41"
        ],
        "dependencies": [
          "A01.01"
        ],
        "permission_requirements": [
          "Management group policy admin"
        ],
        "owner_role": "Cloud Governance Lead",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering"
          ],
          "change_scope": "ManagementGroup"
        },
        "learn_references": [
          {
            "title": "Management groups",
            "url": "",
            "excerpt": "# Management groups\n## Management group recommendations\n7. Create management groups under your landing zone management group to represent the types of workloads that you host. These groups are based on the security, compliance, connectivity, and feature needs of the workloads. With this grouping structure, you can have a set of Azure policies applied at the management group level. Use this grouping structure for all workloads that require the same security, compliance, connectivity, and feature settings.\n7.1. Use management groups to organize subscriptions by workload type, such as `online`, `corporate`, or `sandbox`. This organization helps you apply policies and RBAC roles that are specific to the workload type. For more information, see [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz).\n8. Limit the number of Azure Policy assignments at the root management group scope. This limitation minimizes debugging inherited policies in lower-level management groups.\n9. Use policies to enforce compliance requirements either at the management group or subscription scope to achieve policy-driven governance.\n10. Ensure that only privileged users can operate management groups in the tenant. Enable Azure RBAC authorization in the management group [hierarchy settings](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting-require-authorization) to refine user privileges. By default, all users can create their own management groups under the root management group.\n11. Configure a default, dedicated management group for new subscriptions. This group ensures that no subscriptions go under the root management group. This group is especially important if users have Microsoft Developer Network (MSDN) or Visual Studio benefits and subscriptions. A good candidate for this type of management group is a `sandbox` management group. For more information, see [Set a default management group](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group).\n12. Don't create management groups for production, testing, and development environments. If necessary, separate these groups into different subscriptions in the same management group. For more information, see:\n12.1. [Manage application development environments in Azure landing zones](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-application-environments)\n12.2. [Testing approach for enterprise-scale management groups](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/testing-approach)"
          },
          {
            "title": "Design area: Azure governance",
            "url": "",
            "excerpt": "# Design area: Azure governance\n## Azure governance considerations\n3. Consider using [Microsoft Entra reports](https://learn.microsoft.com/en-us/entra/identity/monitoring-health/overview-monitoring-health) to govern activity.\n4. Consider sending Microsoft Entra ID logs to the central Azure Monitor Logs workspace for the platform.\n5. Explore Microsoft Entra ID Governance features, like [access reviews](https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview) and [entitlement management](https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview).\n### Non-Microsoft tooling\n1. Use [AzAdvertizer](https://www.azadvertizer.net) to get Azure governance updates. For example, you can find insights about policy definitions, initiatives, aliases, security, and regulatory compliance controls in Azure Policy or Azure RBAC role definitions. You can also get insight into resource provider operations, Microsoft Entra role definitions and role actions, and first-party API permissions.\n2. Use [Azure Governance Visualizer](https://github.com/azure/azure-governance-visualizer) to keep track of your technical governance estate. You can use the policy version checker feature for Azure landing zones to keep your environment up to date with the latest Azure landing zone policy release state.\n## Azure governance recommendations\n### Deployment acceleration recommendations\n1. Identify required Azure tags and use the append policy mode to enforce usage. For more information, see [Define your tagging strategy](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging).\n2. Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.\n3. Establish Azure Policy definitions at the top-level root management group because they might be assigned at inherited scopes.\n4. Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if necessary.\n5. Use Azure Policy to control resource provider registrations at the subscription or management group levels.\n6. Use built-in policies to minimize operational overhead.\n7. Assign the built-in Resource Policy Contributor role at a specific scope to enable application-level governance.\n8. Limit the number of Azure Policy assignments at the root management group scope to avoid managing exclusions at inherited scopes.\n### Cost management recommendations\n1. Use Cost Management to implement financial oversight on resources in your environment.\n2. Use tags, such as the cost center or project name, to append the resource metadata. This approach helps enable granular analysis of expenses.\n## Azure governance in the Azure landing zone reference architecture\nThe Azure landing zone reference architecture provides organizations with mature governance controls.\nFor example, you can implement:\n1. A management group hierarchy that groups resources by function or workload type. This approach encourages resource consistency.\n2. A rich set of Azure policies that enables governance controls at the management group level. This approach helps verify that all resources are in scope."
          },
          {
            "title": "Azure landing zone frequently asked questions (FAQ)",
            "url": "",
            "excerpt": "# Azure landing zone frequently asked questions (FAQ)\n## What does policy-driven governance mean, and how does it work?\n[Policy-driven governance](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles#policy-driven-governance) is one of the key design principles of enterprise-scale architecture.\nPolicy-driven governance means using Azure Policy to reduce the time you need for common and repeated operational tasks across your Azure tenant. Use many of the [Azure Policy effects](https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects), such as `Append`, `Deny`, `DeployIfNotExists`, and `Modify`, to prevent non-compliance by either restricting non-compliant resources (as defined by the policy definition) from being created or updated or by deploying resources or modifying settings of a resource creation or update request to make them compliant. Some effects, such as `Audit`, `Disabled`, and `AuditIfNotExists`, don't prevent or take action; they only audit and report on non-compliance.\nSome examples of policy-driven governance are:\n1. `Deny` effect: Prevents subnets from being created or updated to have no Network Security Groups associated with them.\n2. `DeployIfNotExists` effect: A new subscription (landing zone) is created and placed into a management group within your Azure landing zone deployment. Azure Policy ensures that Microsoft Defender for Cloud (formerly known as Azure Security Center) is enabled on the subscription. It also configures the diagnostic settings for Activity Log to send logs to the Log Analytics workspace in the Management subscription.\n  Instead of repeating code or manual activities when a new subscription is created, the `DeployIfNotExists` policy definition automatically deploys and configures them for you.\n## What if we can't or aren't yet ready to utilize DeployIfNotExists (DINE) policies?\nWe have a dedicated page that walks through the various phases and options you have to either \"disable\" DINE policies or use our three phase approach to adopt them over time within your environment.\nSee the guidance [Adopting policy driven guardrails](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/dine-guidance)"
          }
        ]
      },
      {
        "checklist_id": "D07.01",
        "title": "Implement hub-spoke network topology with centralized egress and DDoS protection",
        "priority": 4,
        "blast_radius": "High",
        "caf_discipline": "Ready",
        "why_it_matters": "Reduces attack surface, enables segmentation, and ensures secure connectivity for landing zones",
        "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
        "controls": [
          "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "088137f5-e6c4-4cfd-9e50-4547c2447ec6"
        ],
        "dependencies": [
          "A01.01",
          "E01.01"
        ],
        "permission_requirements": [
          "Network contributor",
          "Subscription owner"
        ],
        "owner_role": "Network Architect",
        "delivery_model": {
          "estimated_duration": "3 weeks",
          "team": [
            "Platform Engineering",
            "Network"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Hub-spoke network topology in Azure",
            "url": "",
            "excerpt": "# Hub-spoke network topology in Azure\n## Recommendations\nThe following recommendations apply to most scenarios. Follow these recommendations unless you have specific requirements that override them.\n### Resource groups, subscriptions, and regions\nThis example solution uses a single Azure resource group. You can also implement the hub and each spoke in different resource groups and subscriptions.\nWhen you peer virtual networks in different subscriptions, you can associate the subscriptions to the same or different Microsoft Entra tenants. This flexibility allows for decentralized management of each workload while maintaining shared services in the hub. See [Create a virtual network peering - Resource Manager, different subscriptions, and Microsoft Entra tenants](https://learn.microsoft.com/en-us/azure/virtual-network/create-peering-different-subscriptions).\n#### Azure landing zones\nThe [Azure landing zone architecture](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is based on the hub-spoke topology. In that architecture, a centralized platform team manages the hub's shared resources and network, while spokes share a co-ownership model with the platform team and the workload team that uses the spoke network. All hubs reside in a \"Connectivity\" subscription for centralized management, while spoke virtual networks exist across many individual workload subscriptions, called application landing zone subscriptions.\n### Virtual network subnets\nThe following recommendations outline how to configure the subnets on the virtual network.\n#### GatewaySubnet\nThe virtual network gateway requires this subnet. You can also use a hub-spoke topology without a gateway if you don't need cross-premises network connectivity.\n[Create a subnet named *GatewaySubnet* with an address range of at least `26`](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-about-virtual-network-gateways#gwsub). The `/26` address range gives the subnet enough scalability configuration options to prevent reaching the gateway size limitations in the future and to accommodate for a higher number of ExpressRoute circuits. For more information about setting up the gateway, see [Hybrid network using a VPN gateway](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager).\n#### AzureFirewallSubnet\nCreate a subnet named *AzureFirewallSubnet* with an address range of at least `/26`. Regardless of scale, the `/26` address range is the recommended size and covers any future size limitations. This subnet doesn't support network security groups (NSGs).\nAzure Firewall requires this subnet. If you use a partner network virtual appliance (NVA), follow its network requirements.\n### Spoke network connectivity"
          },
          {
            "title": "Network topology and connectivity",
            "url": "",
            "excerpt": "# Network topology and connectivity\n## Design area overview\nNetwork topology and connectivity are fundamental for organizations that are planning their landing zone design. Networking is central to almost everything inside a landing zone. It enables connectivity to other Azure services, external users, and on-premises infrastructure. Network topology and connectivity are in the [environmental group](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-areas#environment-design-areas) of Azure landing zone design areas. This grouping is based on their importance in core design and implementation decisions.\n[![Diagram of networking areas of ALZ conceptual Management Group Hierarchy.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/network-design-overview-mg.png)](media/network-design-overview-mg.png#lightbox)\nIn the [conceptual Azure landing zone architecture](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg), there are two main management groups hosting workloads: Corp and Online. These management groups serve distinct purposes in organizing and governing Azure subscriptions. The networking relationship between the various Azure landing zones management groups depends on the organization's specific requirements and network architecture.\nThe next few sections discuss the networking relationship between **Corp**, **Online**, and the **Connectivity** management groups in relation to what the Azure landing zone reference architecture provides.\n### What is the purpose of Connectivity, Corp, and Online Management Groups?\n1. **Connectivity management group**: This management group contains dedicated subscriptions for connectivity, commonly a single subscription for most organizations. These subscriptions host the Azure networking resources required for the platform, like Azure Virtual WAN, Virtual Network Gateways, Azure Firewall, and Azure DNS private zones. It's also where hybrid connectivity is established between the cloud and on-premises environments, using services like ExpressRoute etc.\n2. **Corp management group**: The dedicated management group for corporate landing zones. This group is intended to contain subscriptions that host workloads that require traditional IP routing connectivity or hybrid connectivity with the corporate network via the hub in the connectivity subscription and therefore form part of the same routing domain. Workloads such as internal systems aren't exposed directly to the internet, but may be exposed via reverse proxies etc., such as Application Gateways."
          },
          {
            "title": "How to deploy hub-and-spoke topology with Azure Firewall",
            "url": "",
            "excerpt": "# How to deploy hub-and-spoke topology with Azure Firewall\n## Create a connectivity configuration\nIn this task, you create a connectivity configuration that includes your network group and a routing rule collection. You can choose to enable [direct connectivity](https://learn.microsoft.com/azure/virtual-network-manager/concept-connectivity-configuration#enable-direct-connectivity) in the hub and spoke topology, or leave all communication to go through the hub virtual network and Azure firewall.\n1. In the network manager instance, select **Configurations** under **Settings** then select **Create connectivity configuration**.\n2. In the **Create a connectivity configuration** window, enter the connectivity configuration **Name** and **Description** on the **Basics** tab then select **Next: Topology >**.\n3. On the **Topology** tab, enter or select the following settings:\n | **Setting** | **Value** |\n | --- | --- |\n | **Topology** | Select **Hub and spoke**. |\n | **Hub** | Choose **Select a hub**.On the **Select a hub** page, choose your hub virtual network then select **Select**. |\n | **Spoke network groups** | Choose **+ Add**>**Add network groups**.On the **Add network groups** page, choose your network group then choose **Select**. |\n4. From the list of **Spoke network groups**, you can choose to enable **Direct connectivity** or **Global mesh**. Direct connectivity allows spoke virtual networks to communicate directly with each other. Global mesh allows all virtual networks to communicate with each other. Leaving these unchecked results in all spoke virtual networks communicating through the hub virtual network and Azure firewall.\n Important\n If you enable direct connectivity, you must have a routing configuration with direct routing within the virtual network. If you enable global mesh, you must have a routing configuration with global mesh enabled.\n ![Screenshot of Create a connectivity configuration for hub and spoke with direct connectivity.](https://learn.microsoft.com/azure/includes/media/virtual-network-manager-deploy-hub-spoke-topology/create-direct-connectivity-hub-spoke-configuration.png)\n5. Choose **Next: Visualization >** to review the connectivity configuration then select **Review + create** > **Create**."
          }
        ]
      },
      {
        "checklist_id": "G01.01",
        "title": "Expand Defender coverage and enforce security baseline",
        "priority": 5,
        "blast_radius": "High",
        "caf_discipline": "Secure",
        "why_it_matters": "Enhances threat protection and ensures consistent security posture across all workloads",
        "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
        "controls": [
          "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
        ],
        "dependencies": [
          "E01.01",
          "F01.01"
        ],
        "permission_requirements": [
          "Security admin",
          "Subscription owner"
        ],
        "owner_role": "Security Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Security",
            "Platform Engineering"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Design area: Security",
            "url": "",
            "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
          },
          {
            "title": "Protect your resources with Defender CSPM",
            "url": "",
            "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
          },
          {
            "title": "Prepare your landing zone for migration",
            "url": "",
            "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
          }
        ]
      },
      {
        "checklist_id": "B01.01",
        "title": "Integrate centralized identity logging and Entra ID diagnostics",
        "priority": 6,
        "blast_radius": "High",
        "caf_discipline": "Secure",
        "why_it_matters": "Enables access visibility, auditability, and supports compliance requirements",
        "success_criteria": "Identity logs centralized; diagnostics coverage for Entra ID exceeds 50%",
        "controls": [
          "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1"
        ],
        "dependencies": [
          "E01.01",
          "G01.01"
        ],
        "permission_requirements": [
          "Entra ID admin",
          "Log Analytics admin"
        ],
        "owner_role": "Identity Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Identity",
            "Security"
          ],
          "change_scope": "Tenant"
        },
        "learn_references": [
          {
            "title": "Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones",
            "url": "",
            "excerpt": "# Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones\n## Identity and access management services in Azure landing zones\nThe administration of identity and access management is a platform responsibility. Identity and access management services are fundamental to organizational security. Your organization can use Microsoft Entra ID to control administrative access and protect platform resources in Azure, by creating appropriate role assignments and enabling advanced services such as Conditional Access and Privileged Identity Management (PIM). This approach prevents unauthorized users from making changes to the identity configuration or to the security principals contained within Microsoft Entra ID and Active Directory.\nProvision landing zones so that application owners can choose either Microsoft Entra ID or AD DS and Domain Services to suit their workload needs. You might need to configure other services, depending on your identity solution. For example, you might need to enable and secure network connectivity from the application to the Identity virtual network. If you use a subscription-vending process, include this configuration information in your subscription request."
          },
          {
            "title": "Landing zone identity and access management",
            "url": "",
            "excerpt": "# Landing zone identity and access management\n## Design recommendations\n6. Consider whether platform administrators require permissions on application landing zones. If so, use Microsoft Entra PIM to control access to those resources, and assign the least-privileged permissions required. For example, a platform administrator might require access to a specific application landing zone to troubleshoot an issue but shouldn't have routine access to the application data or code. In this case, the platform administrator can request access to the application. A privileged role administrator approves the request, and the platform administrator is granted the required permissions for the specified time period. This approach helps enforce separation of duties and protects application landing zones from accidental or malicious misconfiguration.\n7. When you delegate administrative responsibility to others, such as application teams, consider whether they require the full set of privileges or only a subset. Follow the principle of least privilege (PoLP). For example, you might assign the User Access Administrator role or RBAC Administrator role to a user who needs to manage access to Azure resources but doesn't need to manage the resources themselves. To limit the identities, identity types, and roles that users can delegate and assign Azure RBAC assignments to, use [delegated role assignments with conditions](https://learn.microsoft.com/en-us/azure/role-based-access-control/delegate-role-assignments-overview). Application teams can use conditions to manage their own security principals within the constraints that the platform team sets. More privileged role assignments require escalation to the platform team. Consider the following factors when you use conditions to delegate RBAC roles:\n7.1. Review current role assignments for built-in and custom privileged roles and evaluate if you should add appropriate conditions to those existing assignments. For example, you can add conditions to the Subscription Owner and Application Owner custom roles that the Azure landing zone reference architecture provides. These conditions can restrict the principal types that they can assign roles to or limit specific roles that they can assign.\n7.2. Follow the PoLP when you add conditions to role assignments. For example, limit delegates to only assign roles to groups or enable delegates to assign all roles except privileged administrator roles like Owner, User Access Administrator, and RBAC Administrator.\n7.3. Build your own conditions if the available condition templates don't fulfill your requirements or policies.\n  [![Screenshot that shows the condition templates for RBAC constrained delegation.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-landing-zone-rbac-conditions.png)](media/azure-landing-zone-rbac-conditions.png#lightbox)"
          },
          {
            "title": "Landing zone identity and access management",
            "url": "",
            "excerpt": "# Landing zone identity and access management\n## Design recommendations\n  For example, a user might routinely require limited administrative access to resources in an application landing zone. Occasionally, they might require the Owner role. You can create two security groups: Application Administrators and Application Owners. Assign the least-privilege roles to the Application Administrators group, and assign the owner role to the Application Owners role. Use PIM groups so the user can request the Owner role when required. At all other times, the user has only the permissions required to carry out their typical activities.\n5. Use [protected actions](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/protected-actions-overview) with Microsoft Entra PIM to add extra layers of protection. In Microsoft Entra ID, protected actions are permissions that are assigned [Conditional Access policies](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview). When a user attempts to perform a protected action, they must first satisfy the Conditional Access policies that are assigned to the required permissions. For example, to allow administrators to update cross-tenant access settings, you can require that they first satisfy the [phishing-resistant MFA policy](https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-admin-phish-resistant-mfa).\n## Identity and access management in the Azure landing zone reference architecture\nIdentity and access management are core features of Azure landing zone reference architecture implementation. The deployment includes a subscription dedicated to identity, where organizations can deploy AD DS domain controllers or other identity services, such as Microsoft Entra Connect servers, that are required for their environment. Not all organizations require services in the subscription. For example, some organizations might have applications that are already fully integrated with Microsoft Entra ID.\nThe identity subscription has a virtual network peered to the hub virtual network in the platform subscription. With this configuration, the platform team can manage the identity subscription, and application owners have access to identity services as required. You must secure the identity subscription and virtual network to protect identity services from unauthorized access.\nAzure landing zone reference architecture implementation also includes options to:\n1. Assign recommended policies to govern identity and domain controllers.\n2. Create a virtual network, and connect to the hub via virtual network peering.\n### Next steps"
          }
        ]
      }
    ],
    "roadmap": {
      "roadmap_30_60_90": {
        "30_days": [
          {
            "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
            "checklist_id": "A01.01",
            "caf_discipline": "Govern",
            "dependency_on": [],
            "success_criteria": "Platform and landing zone management groups created and visible subscriptions placed correctly",
            "owner_role": "Cloud Platform Architect"
          },
          {
            "action": "Achieve centralized diagnostics and security visibility across all visible resources",
            "checklist_id": "E01.01",
            "caf_discipline": "Manage",
            "dependency_on": [],
            "success_criteria": "Diagnostics coverage exceeds 30% and logs are centralized",
            "owner_role": "Cloud Operations Lead"
          },
          {
            "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
            "checklist_id": "F01.01",
            "caf_discipline": "Govern",
            "dependency_on": [
              "A01.01"
            ],
            "success_criteria": "Policy compliance exceeds 50% and public IP governance enforced",
            "owner_role": "Cloud Governance Lead"
          }
        ],
        "60_days": [
          {
            "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
            "checklist_id": "D07.01",
            "caf_discipline": "Ready",
            "dependency_on": [
              "A01.01",
              "E01.01"
            ],
            "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
            "owner_role": "Network Architect"
          },
          {
            "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
            "checklist_id": "G01.01",
            "caf_discipline": "Secure",
            "dependency_on": [
              "E01.01",
              "F01.01"
            ],
            "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
            "owner_role": "Security Architect"
          }
        ],
        "90_days": [
          {
            "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
            "checklist_id": "B01.01",
            "caf_discipline": "Secure",
            "dependency_on": [
              "E01.01",
              "G01.01"
            ],
            "success_criteria": "Identity logs centralized and diagnostics coverage for Entra ID exceeds 50%",
            "owner_role": "Identity Architect"
          }
        ]
      },
      "dependency_graph": [
        {
          "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
          "depends_on": [],
          "phase": "30_days"
        },
        {
          "action": "Achieve centralized diagnostics and security visibility across all visible resources",
          "depends_on": [],
          "phase": "30_days"
        },
        {
          "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
          "depends_on": [
            "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
          ],
          "phase": "30_days"
        },
        {
          "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
          "depends_on": [
            "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
            "Achieve centralized diagnostics and security visibility across all visible resources"
          ],
          "phase": "60_days"
        },
        {
          "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
          "depends_on": [
            "Achieve centralized diagnostics and security visibility across all visible resources",
            "Apply baseline governance policies for public IP, resource compliance, and platform standards"
          ],
          "phase": "60_days"
        },
        {
          "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
          "depends_on": [
            "Achieve centralized diagnostics and security visibility across all visible resources",
            "Expand Defender coverage to all supported resource types and enforce security baseline policies"
          ],
          "phase": "90_days"
        }
      ],
      "critical_path": [
        "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
      ],
      "parallel_execution_groups": [
        [
          "A01.01",
          "E01.01"
        ],
        [
          "F01.01"
        ],
        [
          "D07.01",
          "G01.01"
        ],
        [
          "B01.01"
        ]
      ],
      "maturity_trajectory": {
        "current_maturity_percent": 31.6,
        "projected_30_day_percent": 45,
        "projected_60_day_percent": 62,
        "projected_90_day_percent": 78,
        "assumptions": [
          "Management group structure and subscription placement completed in 30 days",
          "Diagnostics coverage and policy baseline achieved in 30 days",
          "Network topology and security baseline implemented in 60 days",
          "Identity log integration completed in 90 days",
          "No delays due to permission or tenant-root access"
        ]
      }
    }
  },
  "transformation_roadmap": {
    "roadmap_30_60_90": {
      "30_days": [
        {
          "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
          "checklist_id": "A01.01",
          "caf_discipline": "Govern",
          "dependency_on": [],
          "success_criteria": "Platform and landing zone management groups created and visible subscriptions placed correctly",
          "owner_role": "Cloud Platform Architect"
        },
        {
          "action": "Achieve centralized diagnostics and security visibility across all visible resources",
          "checklist_id": "E01.01",
          "caf_discipline": "Manage",
          "dependency_on": [],
          "success_criteria": "Diagnostics coverage exceeds 30% and logs are centralized",
          "owner_role": "Cloud Operations Lead"
        },
        {
          "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
          "checklist_id": "F01.01",
          "caf_discipline": "Govern",
          "dependency_on": [
            "A01.01"
          ],
          "success_criteria": "Policy compliance exceeds 50% and public IP governance enforced",
          "owner_role": "Cloud Governance Lead"
        }
      ],
      "60_days": [
        {
          "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
          "checklist_id": "D07.01",
          "caf_discipline": "Ready",
          "dependency_on": [
            "A01.01",
            "E01.01"
          ],
          "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
          "owner_role": "Network Architect"
        },
        {
          "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
          "checklist_id": "G01.01",
          "caf_discipline": "Secure",
          "dependency_on": [
            "E01.01",
            "F01.01"
          ],
          "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
          "owner_role": "Security Architect"
        }
      ],
      "90_days": [
        {
          "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
          "checklist_id": "B01.01",
          "caf_discipline": "Secure",
          "dependency_on": [
            "E01.01",
            "G01.01"
          ],
          "success_criteria": "Identity logs centralized and diagnostics coverage for Entra ID exceeds 50%",
          "owner_role": "Identity Architect"
        }
      ]
    },
    "dependency_graph": [
      {
        "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
        "depends_on": [],
        "phase": "30_days"
      },
      {
        "action": "Achieve centralized diagnostics and security visibility across all visible resources",
        "depends_on": [],
        "phase": "30_days"
      },
      {
        "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
        "depends_on": [
          "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
        ],
        "phase": "30_days"
      },
      {
        "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
        "depends_on": [
          "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
          "Achieve centralized diagnostics and security visibility across all visible resources"
        ],
        "phase": "60_days"
      },
      {
        "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
        "depends_on": [
          "Achieve centralized diagnostics and security visibility across all visible resources",
          "Apply baseline governance policies for public IP, resource compliance, and platform standards"
        ],
        "phase": "60_days"
      },
      {
        "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
        "depends_on": [
          "Achieve centralized diagnostics and security visibility across all visible resources",
          "Expand Defender coverage to all supported resource types and enforce security baseline policies"
        ],
        "phase": "90_days"
      }
    ],
    "critical_path": [
      "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
    ],
    "parallel_execution_groups": [
      [
        "A01.01",
        "E01.01"
      ],
      [
        "F01.01"
      ],
      [
        "D07.01",
        "G01.01"
      ],
      [
        "B01.01"
      ]
    ],
    "maturity_trajectory": {
      "current_maturity_percent": 10.5,
      "projected_30_day_percent": 25,
      "projected_60_day_percent": 45,
      "projected_90_day_percent": 65,
      "assumptions": [
        "Management group structure and subscription placement completed in 30 days",
        "Diagnostics coverage and policy baseline achieved in 30 days",
        "Network topology and security baseline implemented in 60 days",
        "Identity log integration completed in 90 days",
        "No delays due to permission or tenant-root access"
      ]
    }
  },
  "ai": {
    "meta": {
      "generated_at": "2026-01-15T07:05:17.281511+00:00",
      "assessment_run_id": "DEMO-PROBLEM-HEAVY-ALZ",
      "tenant_id": ""
    },
    "executive": {
      "summary": "Current platform maturity is 10.5%. The environment exhibits critical deficiencies across all assessed design areas. No Azure Firewall or hub-spoke topology is present, leaving the platform without centralized egress or DNS policy enforcement. DDoS Protection is absent on all VNets. Defender for Cloud coverage is minimal — CSPM is disabled, Defender for Servers is inactive, and only 6 of 18 CWP plans are enabled (33.3%).\n\nGovernance structures are critically incomplete — no Platform or Landing Zones management groups exist, policy initiative coverage is negligible (1 assignment), and all evaluated resources are noncompliant. Diagnostics coverage stands at 2.1%, preventing centralized operations monitoring. The platform cannot scale to enterprise-scale operations in its current state.",
      "top_business_risks": [
        {
          "title": "No Network Security Perimeter",
          "business_impact": "All landing zone workloads are exposed without centralized egress filtering, DDoS protection, or topology enforcement.",
          "technical_cause": "No Azure Firewall, hub-spoke topology, or DDoS Protection detected. Public IPs use Basic SKU.",
          "severity": "Critical",
          "affected_controls": [
            "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "0c47f486-656d-4699-8c30-edef5b8a93c4"
          ]
        },
        {
          "title": "Defender for Cloud Not Operational",
          "business_impact": "No cloud workload protection, no CSPM posture management, no server-level threat detection.",
          "technical_cause": "Defender CSPM disabled, Defender for Servers disabled, only 33.3% CWP plan coverage.",
          "severity": "Critical",
          "affected_controls": [
            "09945bda-4333-44f2-9911-634182ba5275",
            "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
          ]
        },
        {
          "title": "Governance Framework Absent",
          "business_impact": "Cannot delegate ownership or enforce policy across landing zones; all resources noncompliant.",
          "technical_cause": "No management group hierarchy for platform/LZ segregation. 12 of 12 resources noncompliant. Minimal policy initiatives.",
          "severity": "Critical",
          "affected_controls": [
            "61623a76-5a91-47e1-b348-ef254c27d42e",
            "92481607-d5d1-4e4e-9146-58d3558fd772",
            "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "5c986cb2-9131-456a-8247-6e49f541acdc",
            "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "49b82111-2df2-47ee-912e-7f983f630472"
          ]
        }
      ],
      "investment_priorities": [
        {
          "priority": 1,
          "initiative": "Implement hub-spoke network topology with centralized egress and Azure Firewall to enable connectivity policy inheritance.",
          "estimated_effort": "Moderate",
          "business_value": "Unblocks delegated landing zone connectivity and consistent network policy across subscriptions."
        },
        {
          "priority": 2,
          "initiative": "Centralize diagnostics, Defender for Cloud, and Entra ID logs to enable platform-wide operations monitoring.",
          "estimated_effort": "Moderate",
          "business_value": "Enables centralized operations baseline required before landing zone rollout to workload teams."
        },
        {
          "priority": 3,
          "initiative": "Establish management group hierarchy with policy assignments to enable subscription lifecycle and guardrails.",
          "estimated_effort": "Low",
          "business_value": "Enables policy inheritance, subscription vending, and delegated landing zone ownership."
        }
      ],
      "expected_outcomes_90_days": [
        "Hub-spoke topology with centralized egress deployed; connectivity policy inherited by landing zone subscriptions.",
        "Centralized diagnostics coverage increased to at least 60% of resources, including Entra ID logs to Log Analytics.",
        "Management group hierarchy established with platform policy assignments; subscription vending process documented."
      ]
    },
    "enterprise_scale_readiness": {
      "ready_for_enterprise_scale": false,
      "max_supported_subscriptions_current_state": 1,
      "readiness_score": 5,
      "blockers": [
        {
          "category": "Governance",
          "description": "No Platform or Landing Zones management groups detected. Management group hierarchy is missing, preventing scalable governance and policy assignment.",
          "severity": "Critical",
          "resolving_checklist_ids": [
            "F01.01"
          ]
        },
        {
          "category": "Networking",
          "description": "No hub-spoke topology or Azure Firewall detected. This platform cannot support delegated landing zone connectivity or centralized egress policy.",
          "severity": "Critical",
          "resolving_checklist_ids": [
            "D07.01"
          ]
        },
        {
          "category": "Security",
          "description": "Platform diagnostics baseline missing. Diagnostics coverage is only 2.1%, and Defender for Cloud coverage is incomplete â€” operations teams cannot monitor workloads across landing zones.",
          "severity": "Critical",
          "resolving_checklist_ids": [
            "G01.01"
          ]
        },
        {
          "category": "Identity",
          "description": "Platform identity baseline missing. Entra ID logs are not centralized; PIM and break-glass accounts are not evidenced â€” blocks delegated identity governance for landing zones.",
          "severity": "Critical",
          "resolving_checklist_ids": [
            "B01.01"
          ]
        },
        {
          "category": "Management",
          "description": "No evidence of automated or documented subscription vending process. Scaling to 50+ subscriptions is infeasible without standardized provisioning.",
          "severity": "Critical",
          "resolving_checklist_ids": [
            "E01.01"
          ]
        }
      ],
      "minimum_checklist_ids_required": [
        "F01.01",
        "D07.01",
        "G01.01",
        "B01.01",
        "E01.01"
      ],
      "scaling_recommendations": [
        "Establish a management group hierarchy with dedicated Platform, Connectivity, Identity, and Landing Zones management groups to enable scalable governance.",
        "Implement hub-spoke or Azure Virtual WAN topology with centralized egress and Azure Firewall to secure and manage network traffic across subscriptions.",
        "Assign policy initiatives at management group scope, targeting >70% compliance, and enable Defender for Cloud across all plans to improve Secure Score above 60.",
        "Centralize diagnostics and logging to Log Analytics, covering >80% of resources, including Entra ID logs for identity visibility and privileged access management.",
        "Develop and automate a subscription vending process, or at minimum, document standards for subscription provisioning to support enterprise-scale operations."
      ]
    },
    "transformation_roadmap": {
      "roadmap_30_60_90": {
        "30_days": [
          {
            "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
            "checklist_id": "A01.01",
            "caf_discipline": "Govern",
            "dependency_on": [],
            "success_criteria": "Platform and landing zone management groups created and visible subscriptions placed correctly",
            "owner_role": "Cloud Platform Architect"
          },
          {
            "action": "Achieve centralized diagnostics and security visibility across all visible resources",
            "checklist_id": "E01.01",
            "caf_discipline": "Manage",
            "dependency_on": [],
            "success_criteria": "Diagnostics coverage exceeds 30% and logs are centralized",
            "owner_role": "Cloud Operations Lead"
          },
          {
            "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
            "checklist_id": "F01.01",
            "caf_discipline": "Govern",
            "dependency_on": [
              "A01.01"
            ],
            "success_criteria": "Policy compliance exceeds 50% and public IP governance enforced",
            "owner_role": "Cloud Governance Lead"
          }
        ],
        "60_days": [
          {
            "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
            "checklist_id": "D07.01",
            "caf_discipline": "Ready",
            "dependency_on": [
              "A01.01",
              "E01.01"
            ],
            "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
            "owner_role": "Network Architect"
          },
          {
            "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
            "checklist_id": "G01.01",
            "caf_discipline": "Secure",
            "dependency_on": [
              "E01.01",
              "F01.01"
            ],
            "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
            "owner_role": "Security Architect"
          }
        ],
        "90_days": [
          {
            "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
            "checklist_id": "B01.01",
            "caf_discipline": "Secure",
            "dependency_on": [
              "E01.01",
              "G01.01"
            ],
            "success_criteria": "Identity logs centralized and diagnostics coverage for Entra ID exceeds 50%",
            "owner_role": "Identity Architect"
          }
        ]
      },
      "dependency_graph": [
        {
          "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
          "depends_on": [],
          "phase": "30_days"
        },
        {
          "action": "Achieve centralized diagnostics and security visibility across all visible resources",
          "depends_on": [],
          "phase": "30_days"
        },
        {
          "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
          "depends_on": [
            "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
          ],
          "phase": "30_days"
        },
        {
          "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
          "depends_on": [
            "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
            "Achieve centralized diagnostics and security visibility across all visible resources"
          ],
          "phase": "60_days"
        },
        {
          "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
          "depends_on": [
            "Achieve centralized diagnostics and security visibility across all visible resources",
            "Apply baseline governance policies for public IP, resource compliance, and platform standards"
          ],
          "phase": "60_days"
        },
        {
          "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
          "depends_on": [
            "Achieve centralized diagnostics and security visibility across all visible resources",
            "Expand Defender coverage to all supported resource types and enforce security baseline policies"
          ],
          "phase": "90_days"
        }
      ],
      "critical_path": [
        "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
      ],
      "parallel_execution_groups": [
        [
          "A01.01",
          "E01.01"
        ],
        [
          "F01.01"
        ],
        [
          "D07.01",
          "G01.01"
        ],
        [
          "B01.01"
        ]
      ],
      "maturity_trajectory": {
        "current_maturity_percent": 10.5,
        "projected_30_day_percent": 45,
        "projected_60_day_percent": 62,
        "projected_90_day_percent": 78,
        "assumptions": [
          "Management group structure and subscription placement completed in 30 days",
          "Diagnostics coverage and policy baseline achieved in 30 days",
          "Network topology and security baseline implemented in 60 days",
          "Identity log integration completed in 90 days",
          "No delays due to permission or tenant-root access"
        ]
      }
    },
    "initiatives": [
      {
        "checklist_id": "A01.01",
        "title": "Establish platform and landing zone management group hierarchy",
        "priority": 1,
        "blast_radius": "High",
        "caf_discipline": "Govern",
        "why_it_matters": "Enables policy inheritance, RBAC, and structured resource onboarding; foundational for all subsequent governance and security controls",
        "success_criteria": "Platform and landing zone management groups created; subscriptions correctly placed",
        "controls": [
          "61623a76-5a91-47e1-b348-ef254c27d42e",
          "92481607-d5d1-4e4e-9146-58d3558fd772"
        ],
        "dependencies": [],
        "permission_requirements": [
          "Tenant root or management group admin"
        ],
        "owner_role": "Cloud Platform Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering"
          ],
          "change_scope": "Tenant"
        },
        "learn_references": [
          {
            "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
            "url": "",
            "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Monitoring\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach is consistent with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#monitoring).\nThe workload team provisions the monitoring resources, which include:\n1. Application Insights as the application performance monitoring (APM) service for the workload team.\n2. The Log Analytics workspace as the unified sink for all logs and metrics that are collected from workload-owned Azure resources and the application code.\n[![Diagram that shows monitoring resources for the workload.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-monitoring.vsdx) of this architecture.*\nSimilar to the baseline, all resources are configured to send Azure Diagnostics logs to the Log Analytics workspace that the workload team provisions as part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Log Analytics workspace. In Azure landing zones, that workspace is in the management subscription.\nThe platform team might also have DINE policies that they can use to configure Diagnostics to send logs to their centralized management subscriptions. It's important to ensure that your implementation doesn't restrict the additional log flows.\n### Correlate data from multiple sinks\nThe workload's logs and metrics and its infrastructure components are stored in the workload's Log Analytics workspace. However, logs and metrics that centralized services, such as Azure Firewall, Microsoft Entra ID, and Azure Bastion, generate are stored in a central Log Analytics workspace. Correlating data from multiple sinks can be a complex task.\nCorrelated data is often used during incident response. If there's a problem with correlating data from multiple sinks, make sure the triage runbook for this architecture addresses it and includes organizational points of contact if the problem extends beyond the workload resources. Workload administrators might require assistance from platform administrators to correlate log entries from enterprise networking, security, or other platform services.\nImportant\n**For the platform team:** Where possible, grant Azure role-based access control (Azure RBAC) to query and read log sinks for relevant platform resources. Enable firewall logs for network and application rule evaluations and DNS proxy because the application teams can use this information during troubleshooting tasks."
          },
          {
            "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
            "url": "",
            "excerpt": "# Baseline Microsoft Foundry chat reference architecture in an Azure landing zone\n## Monitor resources\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach aligns with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/architecture/baseline-microsoft-foundry-chat#monitoring).\nYou provision the following monitoring resources:\n1. Application Insights serves as the application performance management (APM) service for your team. You configure this service in the chat UI, Agent Service, and models.\n2. The Azure Monitor Logs workspace serves as the unified sink for all logs and metrics from workload-owned Azure resources.\nSimilar to the baseline architecture, all resources must send Azure diagnostics logs to the Azure Monitor Logs workspace that your team provisions. This configuration is part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Azure Monitor Logs workspace. In Azure landing zones, that workspace typically resides in the management subscription.\nThe platform team might have more processes that affect resources in the application landing zone. For example, they might use DINE policies to configure diagnostics and send logs to centralized management subscriptions. They might also apply [Azure Monitor baseline alerts](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/) through policy. Ensure that your implementation doesn't block these extra logging and alerting flows."
          },
          {
            "title": "Monitor Azure platform landing zone components",
            "url": "",
            "excerpt": "# Monitor Azure platform landing zone components\n## Azure landing zone monitoring guidance\nBaseline metric, activity log, and log query alerts are available for landing zone platform components and other selected landing zone components. These alerts ensure consistent alerting and monitoring for your Azure landing zone. They're based on Microsoft-recommended practices for proactive monitoring, such as setting up alerts, thresholds, and notifications for timely problem detection and response. Use the following guidance to achieve real-time visibility into the performance, utilization, and security of your platform landing zone implementation. Proactively address issues, optimize resource allocation, and ensure a reliable and secure environment.\n[![Diagram that shows Azure Monitor baseline alert topology.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg)](media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n[Diagram that shows the initiatives are applied at the platform management groups, connectivity, identity and management while the landing zone initiative is applied to the landing zones management group. The service health initiative and notifications assets initiative is applied at the intermediate root management group so that it is applied to all subscriptions.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n*Download a [Visio file](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/media/AMBA-Diagrams.vsdx) of this architecture.*\nThe following subsets of Azure components have one or more alerts defined:\n1. Azure ExpressRoute\n2. Azure Firewall\n3. Azure Virtual Network\n4. Azure Virtual WAN\n5. Azure Monitor Log Analytics workspace\n6. Azure Private DNS zone\n7. Azure Key Vault\n8. Azure Virtual Machine\n9. Azure Storage account\nFor more information, see [Alert details](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-overview).\nTo ensure that your organization's resources are properly monitored and secured, you also need to properly configure alerts and implement appropriate processes to respond to alerts. Configure action groups with the appropriate notification channels and test the alerts to ensure that they work as expected. In accordance with the Cloud Adoption Framework principle of subscription democratization, configure at least one action group for each subscription so that relevant staff is notified of alerts. As a minimum form of notification, the action group should include an email notification channel. If you use Azure Monitor alert processing rules to route alerts to one or more action groups, note that service health alerts don't support alert processing rules. Configure service health alerts directly with the action group."
          }
        ]
      },
      {
        "checklist_id": "E01.01",
        "title": "Centralize diagnostics and security visibility",
        "priority": 2,
        "blast_radius": "High",
        "caf_discipline": "Manage",
        "why_it_matters": "Improves operational insight, accelerates threat detection, and supports compliance reporting",
        "success_criteria": "Diagnostics coverage exceeds 30%; logs centralized in Log Analytics",
        "controls": [
          "a56888b2-7e83-4404-bd31-b886528502d1",
          "67e7a8ed-4b30-4e38-a3f2-9812b2363cef"
        ],
        "dependencies": [],
        "permission_requirements": [
          "Subscription contributor",
          "Log Analytics admin"
        ],
        "owner_role": "Cloud Operations Lead",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering",
            "Security"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Design area: Security",
            "url": "",
            "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
          },
          {
            "title": "Protect your resources with Defender CSPM",
            "url": "",
            "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
          },
          {
            "title": "Prepare your landing zone for migration",
            "url": "",
            "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
          }
        ]
      },
      {
        "checklist_id": "F01.01",
        "title": "Apply baseline governance policies",
        "priority": 3,
        "blast_radius": "High",
        "caf_discipline": "Govern",
        "why_it_matters": "Enforces compliance, resource standards, and public IP governance to reduce risk",
        "success_criteria": "Policy compliance exceeds 50%; public IPs governed",
        "controls": [
          "3c5a808d-c695-4c14-a63c-c7ab7a510e41"
        ],
        "dependencies": [
          "A01.01"
        ],
        "permission_requirements": [
          "Management group policy admin"
        ],
        "owner_role": "Cloud Governance Lead",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Platform Engineering"
          ],
          "change_scope": "ManagementGroup"
        },
        "learn_references": [
          {
            "title": "Management groups",
            "url": "",
            "excerpt": "# Management groups\n## Management group recommendations\n7. Create management groups under your landing zone management group to represent the types of workloads that you host. These groups are based on the security, compliance, connectivity, and feature needs of the workloads. With this grouping structure, you can have a set of Azure policies applied at the management group level. Use this grouping structure for all workloads that require the same security, compliance, connectivity, and feature settings.\n7.1. Use management groups to organize subscriptions by workload type, such as `online`, `corporate`, or `sandbox`. This organization helps you apply policies and RBAC roles that are specific to the workload type. For more information, see [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz).\n8. Limit the number of Azure Policy assignments at the root management group scope. This limitation minimizes debugging inherited policies in lower-level management groups.\n9. Use policies to enforce compliance requirements either at the management group or subscription scope to achieve policy-driven governance.\n10. Ensure that only privileged users can operate management groups in the tenant. Enable Azure RBAC authorization in the management group [hierarchy settings](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting-require-authorization) to refine user privileges. By default, all users can create their own management groups under the root management group.\n11. Configure a default, dedicated management group for new subscriptions. This group ensures that no subscriptions go under the root management group. This group is especially important if users have Microsoft Developer Network (MSDN) or Visual Studio benefits and subscriptions. A good candidate for this type of management group is a `sandbox` management group. For more information, see [Set a default management group](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group).\n12. Don't create management groups for production, testing, and development environments. If necessary, separate these groups into different subscriptions in the same management group. For more information, see:\n12.1. [Manage application development environments in Azure landing zones](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-application-environments)\n12.2. [Testing approach for enterprise-scale management groups](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/testing-approach)"
          },
          {
            "title": "Design area: Azure governance",
            "url": "",
            "excerpt": "# Design area: Azure governance\n## Azure governance considerations\n3. Consider using [Microsoft Entra reports](https://learn.microsoft.com/en-us/entra/identity/monitoring-health/overview-monitoring-health) to govern activity.\n4. Consider sending Microsoft Entra ID logs to the central Azure Monitor Logs workspace for the platform.\n5. Explore Microsoft Entra ID Governance features, like [access reviews](https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview) and [entitlement management](https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview).\n### Non-Microsoft tooling\n1. Use [AzAdvertizer](https://www.azadvertizer.net) to get Azure governance updates. For example, you can find insights about policy definitions, initiatives, aliases, security, and regulatory compliance controls in Azure Policy or Azure RBAC role definitions. You can also get insight into resource provider operations, Microsoft Entra role definitions and role actions, and first-party API permissions.\n2. Use [Azure Governance Visualizer](https://github.com/azure/azure-governance-visualizer) to keep track of your technical governance estate. You can use the policy version checker feature for Azure landing zones to keep your environment up to date with the latest Azure landing zone policy release state.\n## Azure governance recommendations\n### Deployment acceleration recommendations\n1. Identify required Azure tags and use the append policy mode to enforce usage. For more information, see [Define your tagging strategy](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging).\n2. Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.\n3. Establish Azure Policy definitions at the top-level root management group because they might be assigned at inherited scopes.\n4. Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if necessary.\n5. Use Azure Policy to control resource provider registrations at the subscription or management group levels.\n6. Use built-in policies to minimize operational overhead.\n7. Assign the built-in Resource Policy Contributor role at a specific scope to enable application-level governance.\n8. Limit the number of Azure Policy assignments at the root management group scope to avoid managing exclusions at inherited scopes.\n### Cost management recommendations\n1. Use Cost Management to implement financial oversight on resources in your environment.\n2. Use tags, such as the cost center or project name, to append the resource metadata. This approach helps enable granular analysis of expenses.\n## Azure governance in the Azure landing zone reference architecture\nThe Azure landing zone reference architecture provides organizations with mature governance controls.\nFor example, you can implement:\n1. A management group hierarchy that groups resources by function or workload type. This approach encourages resource consistency.\n2. A rich set of Azure policies that enables governance controls at the management group level. This approach helps verify that all resources are in scope."
          },
          {
            "title": "Azure landing zone frequently asked questions (FAQ)",
            "url": "",
            "excerpt": "# Azure landing zone frequently asked questions (FAQ)\n## What does policy-driven governance mean, and how does it work?\n[Policy-driven governance](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles#policy-driven-governance) is one of the key design principles of enterprise-scale architecture.\nPolicy-driven governance means using Azure Policy to reduce the time you need for common and repeated operational tasks across your Azure tenant. Use many of the [Azure Policy effects](https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects), such as `Append`, `Deny`, `DeployIfNotExists`, and `Modify`, to prevent non-compliance by either restricting non-compliant resources (as defined by the policy definition) from being created or updated or by deploying resources or modifying settings of a resource creation or update request to make them compliant. Some effects, such as `Audit`, `Disabled`, and `AuditIfNotExists`, don't prevent or take action; they only audit and report on non-compliance.\nSome examples of policy-driven governance are:\n1. `Deny` effect: Prevents subnets from being created or updated to have no Network Security Groups associated with them.\n2. `DeployIfNotExists` effect: A new subscription (landing zone) is created and placed into a management group within your Azure landing zone deployment. Azure Policy ensures that Microsoft Defender for Cloud (formerly known as Azure Security Center) is enabled on the subscription. It also configures the diagnostic settings for Activity Log to send logs to the Log Analytics workspace in the Management subscription.\n  Instead of repeating code or manual activities when a new subscription is created, the `DeployIfNotExists` policy definition automatically deploys and configures them for you.\n## What if we can't or aren't yet ready to utilize DeployIfNotExists (DINE) policies?\nWe have a dedicated page that walks through the various phases and options you have to either \"disable\" DINE policies or use our three phase approach to adopt them over time within your environment.\nSee the guidance [Adopting policy driven guardrails](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/dine-guidance)"
          }
        ]
      },
      {
        "checklist_id": "D07.01",
        "title": "Implement hub-spoke network topology with centralized egress and DDoS protection",
        "priority": 4,
        "blast_radius": "High",
        "caf_discipline": "Ready",
        "why_it_matters": "Reduces attack surface, enables segmentation, and ensures secure connectivity for landing zones",
        "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
        "controls": [
          "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "088137f5-e6c4-4cfd-9e50-4547c2447ec6"
        ],
        "dependencies": [
          "A01.01",
          "E01.01"
        ],
        "permission_requirements": [
          "Network contributor",
          "Subscription owner"
        ],
        "owner_role": "Network Architect",
        "delivery_model": {
          "estimated_duration": "3 weeks",
          "team": [
            "Platform Engineering",
            "Network"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Hub-spoke network topology in Azure",
            "url": "",
            "excerpt": "# Hub-spoke network topology in Azure\n## Recommendations\nThe following recommendations apply to most scenarios. Follow these recommendations unless you have specific requirements that override them.\n### Resource groups, subscriptions, and regions\nThis example solution uses a single Azure resource group. You can also implement the hub and each spoke in different resource groups and subscriptions.\nWhen you peer virtual networks in different subscriptions, you can associate the subscriptions to the same or different Microsoft Entra tenants. This flexibility allows for decentralized management of each workload while maintaining shared services in the hub. See [Create a virtual network peering - Resource Manager, different subscriptions, and Microsoft Entra tenants](https://learn.microsoft.com/en-us/azure/virtual-network/create-peering-different-subscriptions).\n#### Azure landing zones\nThe [Azure landing zone architecture](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is based on the hub-spoke topology. In that architecture, a centralized platform team manages the hub's shared resources and network, while spokes share a co-ownership model with the platform team and the workload team that uses the spoke network. All hubs reside in a \"Connectivity\" subscription for centralized management, while spoke virtual networks exist across many individual workload subscriptions, called application landing zone subscriptions.\n### Virtual network subnets\nThe following recommendations outline how to configure the subnets on the virtual network.\n#### GatewaySubnet\nThe virtual network gateway requires this subnet. You can also use a hub-spoke topology without a gateway if you don't need cross-premises network connectivity.\n[Create a subnet named *GatewaySubnet* with an address range of at least `26`](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-about-virtual-network-gateways#gwsub). The `/26` address range gives the subnet enough scalability configuration options to prevent reaching the gateway size limitations in the future and to accommodate for a higher number of ExpressRoute circuits. For more information about setting up the gateway, see [Hybrid network using a VPN gateway](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager).\n#### AzureFirewallSubnet\nCreate a subnet named *AzureFirewallSubnet* with an address range of at least `/26`. Regardless of scale, the `/26` address range is the recommended size and covers any future size limitations. This subnet doesn't support network security groups (NSGs).\nAzure Firewall requires this subnet. If you use a partner network virtual appliance (NVA), follow its network requirements.\n### Spoke network connectivity"
          },
          {
            "title": "Network topology and connectivity",
            "url": "",
            "excerpt": "# Network topology and connectivity\n## Design area overview\nNetwork topology and connectivity are fundamental for organizations that are planning their landing zone design. Networking is central to almost everything inside a landing zone. It enables connectivity to other Azure services, external users, and on-premises infrastructure. Network topology and connectivity are in the [environmental group](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-areas#environment-design-areas) of Azure landing zone design areas. This grouping is based on their importance in core design and implementation decisions.\n[![Diagram of networking areas of ALZ conceptual Management Group Hierarchy.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/network-design-overview-mg.png)](media/network-design-overview-mg.png#lightbox)\nIn the [conceptual Azure landing zone architecture](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg), there are two main management groups hosting workloads: Corp and Online. These management groups serve distinct purposes in organizing and governing Azure subscriptions. The networking relationship between the various Azure landing zones management groups depends on the organization's specific requirements and network architecture.\nThe next few sections discuss the networking relationship between **Corp**, **Online**, and the **Connectivity** management groups in relation to what the Azure landing zone reference architecture provides.\n### What is the purpose of Connectivity, Corp, and Online Management Groups?\n1. **Connectivity management group**: This management group contains dedicated subscriptions for connectivity, commonly a single subscription for most organizations. These subscriptions host the Azure networking resources required for the platform, like Azure Virtual WAN, Virtual Network Gateways, Azure Firewall, and Azure DNS private zones. It's also where hybrid connectivity is established between the cloud and on-premises environments, using services like ExpressRoute etc.\n2. **Corp management group**: The dedicated management group for corporate landing zones. This group is intended to contain subscriptions that host workloads that require traditional IP routing connectivity or hybrid connectivity with the corporate network via the hub in the connectivity subscription and therefore form part of the same routing domain. Workloads such as internal systems aren't exposed directly to the internet, but may be exposed via reverse proxies etc., such as Application Gateways."
          },
          {
            "title": "How to deploy hub-and-spoke topology with Azure Firewall",
            "url": "",
            "excerpt": "# How to deploy hub-and-spoke topology with Azure Firewall\n## Create a connectivity configuration\nIn this task, you create a connectivity configuration that includes your network group and a routing rule collection. You can choose to enable [direct connectivity](https://learn.microsoft.com/azure/virtual-network-manager/concept-connectivity-configuration#enable-direct-connectivity) in the hub and spoke topology, or leave all communication to go through the hub virtual network and Azure firewall.\n1. In the network manager instance, select **Configurations** under **Settings** then select **Create connectivity configuration**.\n2. In the **Create a connectivity configuration** window, enter the connectivity configuration **Name** and **Description** on the **Basics** tab then select **Next: Topology >**.\n3. On the **Topology** tab, enter or select the following settings:\n | **Setting** | **Value** |\n | --- | --- |\n | **Topology** | Select **Hub and spoke**. |\n | **Hub** | Choose **Select a hub**.On the **Select a hub** page, choose your hub virtual network then select **Select**. |\n | **Spoke network groups** | Choose **+ Add**>**Add network groups**.On the **Add network groups** page, choose your network group then choose **Select**. |\n4. From the list of **Spoke network groups**, you can choose to enable **Direct connectivity** or **Global mesh**. Direct connectivity allows spoke virtual networks to communicate directly with each other. Global mesh allows all virtual networks to communicate with each other. Leaving these unchecked results in all spoke virtual networks communicating through the hub virtual network and Azure firewall.\n Important\n If you enable direct connectivity, you must have a routing configuration with direct routing within the virtual network. If you enable global mesh, you must have a routing configuration with global mesh enabled.\n ![Screenshot of Create a connectivity configuration for hub and spoke with direct connectivity.](https://learn.microsoft.com/azure/includes/media/virtual-network-manager-deploy-hub-spoke-topology/create-direct-connectivity-hub-spoke-configuration.png)\n5. Choose **Next: Visualization >** to review the connectivity configuration then select **Review + create** > **Create**."
          }
        ]
      },
      {
        "checklist_id": "G01.01",
        "title": "Expand Defender coverage and enforce security baseline",
        "priority": 5,
        "blast_radius": "High",
        "caf_discipline": "Secure",
        "why_it_matters": "Enhances threat protection and ensures consistent security posture across all workloads",
        "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
        "controls": [
          "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
        ],
        "dependencies": [
          "E01.01",
          "F01.01"
        ],
        "permission_requirements": [
          "Security admin",
          "Subscription owner"
        ],
        "owner_role": "Security Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Security",
            "Platform Engineering"
          ],
          "change_scope": "Subscription"
        },
        "learn_references": [
          {
            "title": "Design area: Security",
            "url": "",
            "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
          },
          {
            "title": "Protect your resources with Defender CSPM",
            "url": "",
            "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
          },
          {
            "title": "Prepare your landing zone for migration",
            "url": "",
            "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
          }
        ]
      },
      {
        "checklist_id": "B01.01",
        "title": "Integrate centralized identity logging and Entra ID diagnostics",
        "priority": 6,
        "blast_radius": "High",
        "caf_discipline": "Secure",
        "why_it_matters": "Enables access visibility, auditability, and supports compliance requirements",
        "success_criteria": "Identity logs centralized; diagnostics coverage for Entra ID exceeds 50%",
        "controls": [
          "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1"
        ],
        "dependencies": [
          "E01.01",
          "G01.01"
        ],
        "permission_requirements": [
          "Entra ID admin",
          "Log Analytics admin"
        ],
        "owner_role": "Identity Architect",
        "delivery_model": {
          "estimated_duration": "2 weeks",
          "team": [
            "Identity",
            "Security"
          ],
          "change_scope": "Tenant"
        },
        "learn_references": [
          {
            "title": "Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones",
            "url": "",
            "excerpt": "# Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones\n## Identity and access management services in Azure landing zones\nThe administration of identity and access management is a platform responsibility. Identity and access management services are fundamental to organizational security. Your organization can use Microsoft Entra ID to control administrative access and protect platform resources in Azure, by creating appropriate role assignments and enabling advanced services such as Conditional Access and Privileged Identity Management (PIM). This approach prevents unauthorized users from making changes to the identity configuration or to the security principals contained within Microsoft Entra ID and Active Directory.\nProvision landing zones so that application owners can choose either Microsoft Entra ID or AD DS and Domain Services to suit their workload needs. You might need to configure other services, depending on your identity solution. For example, you might need to enable and secure network connectivity from the application to the Identity virtual network. If you use a subscription-vending process, include this configuration information in your subscription request."
          },
          {
            "title": "Landing zone identity and access management",
            "url": "",
            "excerpt": "# Landing zone identity and access management\n## Design recommendations\n6. Consider whether platform administrators require permissions on application landing zones. If so, use Microsoft Entra PIM to control access to those resources, and assign the least-privileged permissions required. For example, a platform administrator might require access to a specific application landing zone to troubleshoot an issue but shouldn't have routine access to the application data or code. In this case, the platform administrator can request access to the application. A privileged role administrator approves the request, and the platform administrator is granted the required permissions for the specified time period. This approach helps enforce separation of duties and protects application landing zones from accidental or malicious misconfiguration.\n7. When you delegate administrative responsibility to others, such as application teams, consider whether they require the full set of privileges or only a subset. Follow the principle of least privilege (PoLP). For example, you might assign the User Access Administrator role or RBAC Administrator role to a user who needs to manage access to Azure resources but doesn't need to manage the resources themselves. To limit the identities, identity types, and roles that users can delegate and assign Azure RBAC assignments to, use [delegated role assignments with conditions](https://learn.microsoft.com/en-us/azure/role-based-access-control/delegate-role-assignments-overview). Application teams can use conditions to manage their own security principals within the constraints that the platform team sets. More privileged role assignments require escalation to the platform team. Consider the following factors when you use conditions to delegate RBAC roles:\n7.1. Review current role assignments for built-in and custom privileged roles and evaluate if you should add appropriate conditions to those existing assignments. For example, you can add conditions to the Subscription Owner and Application Owner custom roles that the Azure landing zone reference architecture provides. These conditions can restrict the principal types that they can assign roles to or limit specific roles that they can assign.\n7.2. Follow the PoLP when you add conditions to role assignments. For example, limit delegates to only assign roles to groups or enable delegates to assign all roles except privileged administrator roles like Owner, User Access Administrator, and RBAC Administrator.\n7.3. Build your own conditions if the available condition templates don't fulfill your requirements or policies.\n  [![Screenshot that shows the condition templates for RBAC constrained delegation.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-landing-zone-rbac-conditions.png)](media/azure-landing-zone-rbac-conditions.png#lightbox)"
          },
          {
            "title": "Landing zone identity and access management",
            "url": "",
            "excerpt": "# Landing zone identity and access management\n## Design recommendations\n  For example, a user might routinely require limited administrative access to resources in an application landing zone. Occasionally, they might require the Owner role. You can create two security groups: Application Administrators and Application Owners. Assign the least-privilege roles to the Application Administrators group, and assign the owner role to the Application Owners role. Use PIM groups so the user can request the Owner role when required. At all other times, the user has only the permissions required to carry out their typical activities.\n5. Use [protected actions](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/protected-actions-overview) with Microsoft Entra PIM to add extra layers of protection. In Microsoft Entra ID, protected actions are permissions that are assigned [Conditional Access policies](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview). When a user attempts to perform a protected action, they must first satisfy the Conditional Access policies that are assigned to the required permissions. For example, to allow administrators to update cross-tenant access settings, you can require that they first satisfy the [phishing-resistant MFA policy](https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-admin-phish-resistant-mfa).\n## Identity and access management in the Azure landing zone reference architecture\nIdentity and access management are core features of Azure landing zone reference architecture implementation. The deployment includes a subscription dedicated to identity, where organizations can deploy AD DS domain controllers or other identity services, such as Microsoft Entra Connect servers, that are required for their environment. Not all organizations require services in the subscription. For example, some organizations might have applications that are already fully integrated with Microsoft Entra ID.\nThe identity subscription has a virtual network peered to the hub virtual network in the platform subscription. With this configuration, the platform team can manage the identity subscription, and application owners have access to identity services as required. You must secure the identity subscription and virtual network to protect identity services from unauthorized access.\nAzure landing zone reference architecture implementation also includes options to:\n1. Assign recommended policies to govern identity and domain controllers.\n2. Create a virtual network, and connect to the hub via virtual network peering.\n### Next steps"
          }
        ]
      }
    ],
    "implementation_backlog": [
      {
        "checklist_id": "A01.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "mg-platform-landingzones",
              "description": "Establishes the management group hierarchy for platform and landing zones, ensuring correct parent-child relationships and subscription placement.",
              "parameters": [
                "platformManagementGroupName",
                "landingZoneManagementGroupNames",
                "parentManagementGroupId",
                "subscriptionIds"
              ],
              "target_scope": "managementGroup"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/61623a76-5a91-47e1-b348-ef254c27d42e",
              "display_name": "Audit management group structure for CAF compliance",
              "scope": "/providers/Microsoft.Management/managementGroups/platform",
              "parameters": {}
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/92481607-d5d1-4e4e-9146-58d3558fd772",
              "display_name": "Audit subscription placement in correct management groups",
              "scope": "/providers/Microsoft.Management/managementGroups/platform",
              "parameters": {}
            }
          ],
          "rbac_roles": [
            {
              "role": "Owner",
              "scope": "/providers/Microsoft.Management/managementGroups/platform",
              "justification": "Grants full control to Cloud Platform Architect for management group and subscription operations."
            },
            {
              "role": "Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/landingzone",
              "justification": "Allows Platform Engineering team to onboard resources and subscriptions under landing zone management groups."
            }
          ],
          "pipelines": [
            {
              "name": "mg-hierarchy-deployment",
              "trigger": "manual",
              "steps": [
                "Validate permissions for Tenant Root Group",
                "Deploy mg-platform-landingzones Bicep module to establish hierarchy",
                "Assign CAF compliance and subscription placement audit policies",
                "Grant Owner role to Cloud Platform Architect on platform MG",
                "Grant Contributor role to Platform Engineering team on landing zone MG",
                "Run validation queries to confirm hierarchy and subscription placement"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "Management Group Hierarchy Verification",
              "language": "ARG",
              "query": "ManagementGroups | where name in ('platform', 'landingzone') | project name, displayName, parent"
            },
            {
              "name": "Subscription Placement Verification",
              "language": "ARG",
              "query": "Subscriptions | join kind=inner (ManagementGroups) on $left.managementGroupId == $right.id | project subscriptionId, managementGroupName"
            }
          ]
        }
      },
      {
        "checklist_id": "E01.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "centralized-log-analytics-workspace",
              "description": "Provision a Log Analytics Workspace for centralized diagnostics and security log collection at the subscription scope.",
              "parameters": [
                "workspaceName",
                "location",
                "retentionInDays"
              ],
              "target_scope": "subscription"
            },
            {
              "module_name": "diagnostic-settings-to-log-analytics",
              "description": "Link diagnostic settings for all supported Azure resources to the centralized Log Analytics Workspace to ensure coverage exceeds 30%.",
              "parameters": [
                "workspaceResourceId",
                "resourceTypes",
                "diagnosticCategories"
              ],
              "target_scope": "subscription"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/a56888b2-7e83-4404-bd31-b886528502d1",
              "display_name": "Deploy Diagnostic Settings for Azure Resources to Log Analytics",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {
                "logAnalytics": {
                  "value": "[reference(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName'))).customerId]"
                }
              }
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
              "display_name": "Audit Diagnostic Settings for Azure Resources",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            }
          ],
          "rbac_roles": [
            {
              "role": "Contributor",
              "scope": "/subscriptions/{subscriptionId}",
              "justification": "Required for Platform Engineering and Security teams to provision resources and assign policies at subscription scope."
            },
            {
              "role": "Log Analytics Contributor",
              "scope": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}",
              "justification": "Required for Log Analytics administration and management of diagnostic settings."
            }
          ],
          "pipelines": [
            {
              "name": "diagnostics-centralization-deployment",
              "trigger": "manual",
              "steps": [
                "Checkout repository",
                "Validate Bicep modules",
                "Deploy Log Analytics Workspace (centralized-log-analytics-workspace)",
                "Deploy diagnostic settings to Log Analytics (diagnostic-settings-to-log-analytics)",
                "Assign Deploy Diagnostic Settings policy",
                "Assign Audit Diagnostic Settings policy",
                "Run validation queries"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "Diagnostics Coverage Percentage",
              "language": "ARG",
              "query": "Resources | where type =~ 'microsoft.insights/diagnosticsettings' | summarize count() by resourceId | join kind=inner (Resources | where type !~ 'microsoft.insights/diagnosticsettings') on $left.resourceId == $right.id | summarize coverage = count() * 100 / toscalar(Resources | where type !~ 'microsoft.insights/diagnosticsettings' | count())"
            },
            {
              "name": "Centralized Log Analytics Workspace Usage",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.insights/diagnosticsettings' and properties.workspaceId == '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' | summarize count()"
            }
          ]
        }
      },
      {
        "checklist_id": "F01.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "baseline-governance-policy-assignment",
              "description": "Assign baseline governance policies at the management group scope to enforce resource standards and public IP governance.",
              "parameters": [
                "managementGroupId",
                "policyDefinitionId",
                "policyAssignmentName",
                "parameters"
              ],
              "target_scope": "managementGroup"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/3c5a808d-c695-4c14-a63c-c7ab7a510e41",
              "display_name": "Restrict Public IPs and Enforce Resource Standards",
              "scope": "/providers/Microsoft.Management/managementGroups/{managementGroupId}",
              "parameters": {}
            }
          ],
          "rbac_roles": [
            {
              "role": "Policy Administrator",
              "scope": "/providers/Microsoft.Management/managementGroups/{managementGroupId}",
              "justification": "Required to assign and manage policies at the management group scope for baseline governance."
            }
          ],
          "pipelines": [
            {
              "name": "Baseline-Governance-Policy-Deployment",
              "trigger": "manual",
              "steps": [
                "Checkout repository",
                "Authenticate to Azure using service principal with Management Group Policy Administrator permissions",
                "Run Bicep module 'baseline-governance-policy-assignment' targeting management group",
                "Validate policy assignment status",
                "Publish compliance report"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "Policy Compliance Status",
              "language": "ARG",
              "query": "PolicyAssignmentResources | where policyAssignmentId == '/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Authorization/policyAssignments/RestrictPublicIPsAndEnforceResourceStandards' | project complianceState, policyAssignmentName, managementGroup"
            },
            {
              "name": "Public IP Governance Check",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.network/publicipaddresses' | where properties.ipConfiguration != '' | project name, resourceGroup, subscriptionId, properties.ipConfiguration"
            }
          ]
        }
      },
      {
        "checklist_id": "D07.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "hubVNet",
              "description": "Defines the central Hub VNet with address space, subnets for Azure Firewall, and DDoS Protection.",
              "parameters": [
                "vnetName",
                "addressPrefixes",
                "firewallSubnetPrefix",
                "ddosProtectionPlanId",
                "location"
              ],
              "target_scope": "subscription"
            },
            {
              "module_name": "spokeVNet",
              "description": "Defines Spoke VNets for segmentation, with peering to the Hub VNet.",
              "parameters": [
                "vnetName",
                "addressPrefixes",
                "hubVnetId",
                "location"
              ],
              "target_scope": "subscription"
            },
            {
              "module_name": "azureFirewall",
              "description": "Deploys Azure Firewall in the Hub VNet for centralized egress and traffic inspection.",
              "parameters": [
                "firewallName",
                "firewallSubnetId",
                "location",
                "publicIpName"
              ],
              "target_scope": "subscription"
            },
            {
              "module_name": "ddosProtectionPlan",
              "description": "Deploys Azure DDoS Protection Plan and links it to the Hub VNet.",
              "parameters": [
                "planName",
                "location"
              ],
              "target_scope": "subscription"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/e6c4cfd3-e504-4547-a244-7ec66138a720",
              "display_name": "Require DDoS Protection Plan on Virtual Networks",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/e8bbac75-7155-49ab-a153-e8908ae28c84",
              "display_name": "Only allow VNet peering to approved Hub VNets",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {
                "approvedHubVnetIds": {
                  "value": [
                    "/subscriptions/{subscriptionId}/resourceGroups/{hubRg}/providers/Microsoft.Network/virtualNetworks/{hubVnetName}"
                  ]
                }
              }
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/088137f5-e6c4-4cfd-9e50-4547c2447ec6",
              "display_name": "Require Azure Firewall in Hub VNet",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            }
          ],
          "rbac_roles": [
            {
              "role": "Network Contributor",
              "scope": "/subscriptions/{subscriptionId}",
              "justification": "Grants Platform Engineering and Network teams permissions to manage VNets, Firewall, and DDoS resources."
            },
            {
              "role": "Owner",
              "scope": "/subscriptions/{subscriptionId}",
              "justification": "Required for policy assignment and resource deployment at subscription scope."
            }
          ],
          "pipelines": [
            {
              "name": "Hub-Spoke Network Deployment",
              "trigger": "manual",
              "steps": [
                "Run Bicep module: ddosProtectionPlan",
                "Run Bicep module: hubVNet (with DDoS Protection Plan attached)",
                "Run Bicep module: azureFirewall (in Hub VNet)",
                "Run Bicep module: spokeVNet (with peering to Hub)",
                "Assign policies for DDoS, Firewall, and peering",
                "Validate deployment with Resource Graph queries"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "Hub VNet with DDoS Protection",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.network/virtualnetworks' and properties.ddosProtectionPlan.id != ''"
            },
            {
              "name": "Azure Firewall Deployed in Hub",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.network/azurefirewalls' and properties.virtualNetwork.id contains '{hubVnetName}'"
            },
            {
              "name": "Spoke VNet Peering to Hub",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.network/virtualnetworks' | extend peerings = properties.virtualNetworkPeerings | mv-expand peerings | where peerings.properties.remoteVirtualNetwork.id contains '{hubVnetName}'"
            }
          ]
        }
      },
      {
        "checklist_id": "G01.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "defenderPlansSubscription",
              "description": "Ensures Microsoft Defender plans are enabled for all eligible resource types at the subscription scope.",
              "parameters": [
                "defenderPlanTypes",
                "workspaceResourceId"
              ],
              "target_scope": "subscription"
            },
            {
              "module_name": "securityBaselinePolicies",
              "description": "Applies security baseline policies to enforce secure configurations across workloads in the subscription.",
              "parameters": [
                "policyAssignmentName",
                "policyParameters"
              ],
              "target_scope": "subscription"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/77425f48-ecba-43a0-aeac-a3ac733ccc6a",
              "display_name": "Enforce Security Baseline for Azure Resources",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/6b27e5e3-0c3e-4a9a-9e8c-7a1b3b2c2a6b",
              "display_name": "Enable Microsoft Defender for Storage",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            },
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/5a4bca64-3b3c-4c53-9d8b-6f1c2b8c1e3a",
              "display_name": "Enable Microsoft Defender for SQL",
              "scope": "/subscriptions/{subscriptionId}",
              "parameters": {}
            }
          ],
          "rbac_roles": [
            {
              "role": "Security Admin",
              "scope": "/subscriptions/{subscriptionId}",
              "justification": "Required to manage and enforce Defender and security baseline policies across all workloads."
            },
            {
              "role": "Owner",
              "scope": "/subscriptions/{subscriptionId}",
              "justification": "Needed to grant full access for deployment and configuration of Defender plans and policy assignments."
            }
          ],
          "pipelines": [
            {
              "name": "DefenderAndBaselineDeployment",
              "trigger": "manual",
              "steps": [
                "Checkout source code",
                "Run Bicep deployment for defenderPlansSubscription",
                "Run Bicep deployment for securityBaselinePolicies",
                "Assign security baseline policy",
                "Assign Defender for Storage and SQL policies",
                "Validate policy compliance"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "DefenderPlansEnabled",
              "language": "ARG",
              "query": "Resources | where type =~ 'microsoft.security/pricings' | where properties.pricingTier == 'Standard' | project name, type, properties.pricingTier"
            },
            {
              "name": "SecurityBaselinePolicyCompliance",
              "language": "ARG",
              "query": "policyresources | where policyAssignmentId contains '77425f48-ecba-43a0-aeac-a3ac733ccc6a' | project complianceState, resourceId"
            }
          ]
        }
      },
      {
        "checklist_id": "B01.01",
        "implementation": {
          "bicep_modules": [
            {
              "module_name": "centralized-identity-logging",
              "description": "Provision a Log Analytics workspace for centralized identity logs and configure diagnostic settings for Entra ID to send audit and sign-in logs.",
              "parameters": [
                "workspaceName",
                "location",
                "retentionInDays",
                "diagnosticLogsCategories"
              ],
              "target_scope": "resourceGroup"
            }
          ],
          "policy_assignments": [
            {
              "policy_definition": "/providers/Microsoft.Authorization/policyDefinitions/1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
              "display_name": "Audit Entra ID diagnostic logs to Log Analytics",
              "scope": "/",
              "parameters": {
                "effect": {
                  "value": "Audit"
                }
              }
            }
          ],
          "rbac_roles": [
            {
              "role": "Global Administrator",
              "scope": "/",
              "justification": "Required to configure Entra ID diagnostic settings at the tenant level."
            },
            {
              "role": "Log Analytics Contributor",
              "scope": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}",
              "justification": "Required to manage Log Analytics workspace for centralized logging."
            }
          ],
          "pipelines": [
            {
              "name": "identity-diagnostics-deployment",
              "trigger": "manual",
              "steps": [
                "Checkout repository",
                "Validate Bicep module parameters",
                "Deploy Log Analytics workspace using Bicep",
                "Configure Entra ID diagnostic settings to send logs to workspace",
                "Assign policy to audit diagnostic coverage",
                "Verify deployment success"
              ]
            }
          ],
          "validation_queries": [
            {
              "name": "EntraIDDiagnosticsCoverage",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.aadiam/diagnosticSettings' | summarize coverage = count() by resourceGroup"
            },
            {
              "name": "CentralizedIdentityLogWorkspace",
              "language": "ARG",
              "query": "Resources | where type == 'microsoft.operationalinsights/workspaces' | where properties.retentionInDays >= 30 | project name, location, retentionInDays"
            },
            {
              "name": "EntraIDLogsInWorkspace",
              "language": "KQL",
              "query": "AuditLogs | summarize Count = count() by TenantId"
            }
          ]
        }
      }
    ],
    "smart_questions": [
      {
        "question": "Rate your organization's maturity (1-5) in implementing and managing Azure network topology, including hub-spoke architecture, Azure Firewall, DDoS Protection, and public IP governance.",
        "type": "maturity_scale",
        "resolves_controls": [
          "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
          "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
          "78e11934-499a-45ed-8ef7-aae5578f0ecf",
          "5d82e6df-6f61-42f2-82e2-3132d293be3d",
          "348ef254-c27d-442e-abba-c7571559ab91",
          "4348bf81-7573-4512-8f46-9061cc198fea",
          "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
          "1049d403-a923-4c34-94d0-0018ac6a9e01",
          "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
          "1559ab91-53e8-4908-ae28-c84c33b6b780",
          "984a859c-773e-47d2-9162-3a765a917e1f",
          "9cf5418b-1520-4b7b-add7-88eb28f833e8",
          "c68e1d76-6673-413b-9f56-64b5e984a859",
          "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
          "250d81ce-8bbe-4f85-9051-6a18a8221e50",
          "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
          "c76cb5a2-abe2-11ed-afa1-0242ac120002",
          "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
          "48682fb1-1e86-4458-a686-518ebd47393d",
          "558fd772-49b8-4211-82df-27ee412e7f98",
          "33aad5e8-c68e-41d7-9667-313b4f5664b5",
          "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
          "614658d3-558f-4d77-849b-821112df27ee",
          "2363cefe-179b-4599-be0d-5973cd4cd21b",
          "b034c01e-110b-463a-b36e-e3346e57f225",
          "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
          "7025b442-f6e9-4af6-b11f-c9574916016f"
        ],
        "impact_if_yes": "Assessment posture improves for network security, connectivity, and governance. Most high-risk gaps in network topology and protection are resolved.",
        "impact_if_no": "Network security and topology gaps remain, exposing the platform to significant risks and compliance failures.",
        "follow_up_recommendation": "If maturity is low, prioritize design and implementation of hub-spoke topology, Azure Firewall, DDoS Protection, and public IP controls. If maturity is high, validate evidence and ensure ongoing governance."
      },
      {
        "question": "Rate your organization's maturity (1-5) in implementing centralized security visibility, diagnostics coverage (including Entra ID), and Defender CWP coverage across all Azure resources.",
        "type": "maturity_scale",
        "resolves_controls": [
          "a56888b2-7e83-4404-bd31-b886528502d1",
          "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
          "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
          "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
        ],
        "impact_if_yes": "Security visibility, diagnostics, and threat protection gaps are closed, improving compliance and incident response posture.",
        "impact_if_no": "Lack of centralized visibility and incomplete Defender coverage leaves the platform vulnerable and impedes auditability.",
        "follow_up_recommendation": "If maturity is low, develop and implement a plan for full diagnostics enablement and Defender coverage. If maturity is high, validate log centralization and coverage completeness."
      },
      {
        "question": "Select the current state of your Azure management group hierarchy: [None, Platform MG exists, Landing Zones MG exists, Both exist, Custom structure]",
        "type": "selection",
        "resolves_controls": [
          "61623a76-5a91-47e1-b348-ef254c27d42e",
          "92481607-d5d1-4e4e-9146-58d3558fd772",
          "8bbac757-1559-4ab9-853e-8908ae28c84c",
          "d8a2adb1-17d6-4326-af62-5ca44e5695f2"
        ],
        "impact_if_yes": "If 'Both exist' or 'Custom structure' aligns with CAF, governance gaps are closed and platform organization is improved.",
        "impact_if_no": "If 'None' or only one exists, governance gaps remain and platform lacks proper organizational structure for policy enforcement.",
        "follow_up_recommendation": "If gaps exist, align management group hierarchy with CAF guidance (Platform, Landing Zones, etc.). If structure is mature, validate policy assignments and inheritance."
      }
    ],
    "target_architecture": {
      "meta": {
        "schema_version": "1.0",
        "generated_at": "2024-06-10T00:00:00Z",
        "control_pack": "CAF Foundation Assessment",
        "tenant_context": {
          "tenant_id": null,
          "subscription_ids_visible": [
            "00000000-0000-0000-0000-000000000000"
          ],
          "subscription_count_visible": 1,
          "management_group_access": true,
          "identity_type": "user"
        },
        "data_confidence": "Low"
      },
      "assumptions": [
        {
          "id": "ASSUMP-001",
          "description": "No management group hierarchy was detected; assuming none exists and full CAF-aligned hierarchy is required.",
          "needs_customer_confirmation": true
        },
        {
          "id": "ASSUMP-002",
          "description": "Only one subscription is visible; assuming this is the only active subscription or others are not in scope.",
          "needs_customer_confirmation": true
        },
        {
          "id": "ASSUMP-003",
          "description": "Resource organization, identity, and billing controls are all manual; assuming no significant platform automation or RBAC model is in place.",
          "needs_customer_confirmation": true
        },
        {
          "id": "ASSUMP-004",
          "description": "No evidence of existing network topology; assuming no hub-spoke or Virtual WAN is implemented.",
          "needs_customer_confirmation": true
        },
        {
          "id": "ASSUMP-005",
          "description": "Diagnostics coverage is extremely low (2.1%); assuming most resources lack diagnostic settings and centralized logging.",
          "needs_customer_confirmation": false
        },
        {
          "id": "ASSUMP-006",
          "description": "Defender for Cloud coverage is partial (77.8% of plans enabled); assuming incremental improvement is feasible.",
          "needs_customer_confirmation": false
        }
      ],
      "target_state": {
        "management_group_hierarchy": {
          "root": {
            "name": "Tenant Root Group",
            "children": [
              {
                "name": "Platform",
                "children": [
                  {
                    "name": "Connectivity",
                    "children": []
                  },
                  {
                    "name": "Identity",
                    "children": []
                  },
                  {
                    "name": "Management",
                    "children": []
                  }
                ]
              },
              {
                "name": "Landing Zones",
                "children": [
                  {
                    "name": "Corp",
                    "children": []
                  },
                  {
                    "name": "Online",
                    "children": []
                  }
                ]
              }
            ]
          }
        },
        "subscription_model": {
          "subscriptions": [
            {
              "id": "00000000-0000-0000-0000-000000000000",
              "placement": "Landing Zones/Corp"
            }
          ],
          "pattern": "Single-subscription (Corp landing zone)",
          "notes": "Only one subscription detected; recommend placement under Corp for production workloads. Platform services may share this subscription until scale requires separation."
        },
        "network_topology": {
          "pattern": "Hub-Spoke",
          "justification": "No hub-spoke or Virtual WAN detected; CAF recommends hub-spoke for foundational security and control.",
          "hub": {
            "required": true,
            "contains": [
              "Hub VNet",
              "Azure Firewall",
              "DDoS Protection Standard"
            ]
          },
          "spokes": [
            {
              "purpose": "Workload VNet(s) for Corp landing zone"
            }
          ],
          "public_ip_governance": {
            "enforced_by_policy": true,
            "notes": "At least one public IP detected; recommend policy-based control and review."
          }
        },
        "logging_and_monitoring": {
          "diagnostic_settings_coverage_target": 40,
          "current_coverage": 2.1,
          "centralized_log_workspace": true,
          "entra_id_logging": {
            "enabled": false,
            "target_state": true
          },
          "notes": "Incremental improvement to 40% coverage is realistic given current state. Centralized workspace and Entra ID log integration are required."
        },
        "security_baseline": {
          "defender_for_cloud": {
            "coverage_percent": 77.8,
            "target_percent": 90,
            "notes": "Incremental improvement from 77.8% to 90% Defender plan coverage is targeted."
          },
          "ddos_protection": {
            "enabled": false,
            "target_state": true
          },
          "azure_firewall": {
            "present": false,
            "target_state": true
          },
          "policy_assignments": {
            "platform_mandatory": [
              "Deny public IP except by exception",
              "Require diagnostic settings on key resource types"
            ],
            "notes": "Policy coverage to be improved but not assumed 100% in short term."
          },
          "centralized_security_visibility": {
            "enabled": false,
            "target_state": true,
            "notes": "Diagnostics and Defender integration with Sentinel or equivalent SIEM."
          }
        },
        "operating_model": {
          "platform_team": {
            "exists": false,
            "target_state": true,
            "notes": "Assuming platform team is not yet formalized; recommend establishment for ongoing operations."
          },
          "rbac_model": {
            "pattern": "CAF-aligned (Platform/landing zone separation)",
            "notes": "RBAC to be implemented in line with management group hierarchy."
          },
          "automation": {
            "level": "Manual",
            "target_state": "Incremental automation using AVM modules and/or IaC"
          }
        }
      },
      "implementation_plan": {
        "phases": [
          {
            "name": "Phase 1: Foundation & Governance",
            "execution_units": [
              {
                "capability": "Management group hierarchy",
                "objective": "Enable policy inheritance and RBAC model",
                "scope": "Tenant",
                "owner": "Platform Team",
                "depends_on": [],
                "success_criteria": [
                  "CAF-aligned management group hierarchy exists",
                  "Subscriptions placed under correct management groups"
                ],
                "learn_references": [
                  {
                    "title": "Management groups",
                    "url": "",
                    "excerpt": "# Management groups\n## Management group recommendations\n13. We recommended that you use the standard Azure landing zone management group structure for multiregion deployments. Don't create management groups solely to model different Azure regions. Don't alter or expand your management group structure based on region or multiregion usage.\n  If you have location-based regulatory requirements, such as data residency, data security, or data sovereignty, then you should create a management group structure based on location. You can implement this structure at various levels. For more information, see [Modify an Azure landing zone architecture](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/landing-zone-multinational).\n## Management groups in the Azure landing zone architecture\nThe following shows the Azure landing zones architecture management group hierarchy.\n[![Diagram that shows the Azure landing zone management group hierarchy.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/sub-organization.png)](media/sub-organization.png#lightbox)\n| Management group | Description| \n|  --- | ---  |\n| **Intermediate root management group** | This management group is directly under the tenant root group. The organization provides this management group with a prefix so that they don't have to use the root group. The organization can move existing Azure subscriptions into the hierarchy. This approach also sets up future scenarios. This management group is a parent to all the other management groups created by the Azure landing zone reference architecture. |\n| **Platform** | This management group contains all the platform child management groups, like management, connectivity, and identity. |\n| **Security** | This management group contains a dedicated subscription for security/SIEM team tooling. This subscription hosts Microsoft Sentinel, syslog collectors, and other security/SIEM related tooling. |\n| **Management** | This management group contains a dedicated subscription for management, monitoring, and security. This subscription hosts an Azure Monitor Logs workspace, including associated solutions. |"
                  },
                  {
                    "title": "Manage application development environments in Azure landing zones",
                    "url": "",
                    "excerpt": "# Manage application development environments in Azure landing zones\n## Environments, subscriptions, and management groups\n2. `Microsoft.Authorization/policyDefinitions/*`\n3. `Microsoft.Authorization/policyExemptions/*`\n4. `Microsoft.Authorization/policySetDefinitions/*`\nYou can control these actions by using Privileged Identity Management (PIM).\n### Management group hierarchy\nAvoid complicated management group hierarchies. They can require frequent amendment, scale inefficiently, and lack value. To avoid these potential problems, Azure landing zone management groups are workload archetype-aligned. For more information, see [Management group and subscription organization](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org).\n*Archetype-aligned* means that management groups are only created for specific workload archetypes. For example, in the conceptual architecture, the *landing zones* management group has *corp* and *online* child management groups. These child management groups align with distinct archetype patterns for the workloads that they hold. The child management groups focus on hybrid connectivity (VPN/Azure ExpressRoute) requirements, such as internal only versus public-facing applications and services.\nExcluding sandbox environments, various application environments should use the same archetype for deployment. Even if environments are divided across several subscriptions, they're held within the same single management group (*corp* or *online*), based on the management group archetype and the requirements.\nYou can use [sandbox subscriptions](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/sandbox-environments) for unstructured development, such as personal labs or for a workload that doesn't have an archetype. An application or service workload team uses a sandbox management group to test various Azure services to determine what works best for their requirements. After they decide on services, they can provision a landing zone (in the correct workload archetype-aligned management group in the *landing zones* management group hierarchy) for the team.\nThe sandbox environments can be used for specific applications, or a workload team can use them for experimentation.\nFor more information, see:\n1. [Management groups](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups).\n2. [Resource organization design area](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org).\n3. [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz).\n#### Environment-based management group challenges\nManagement groups for environments within archetypes can add management overhead and provide minimal value.\n[![Diagram that shows an example of an optimal management group hierarchy.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/sub-organization.png)](media/sub-organization.png#lightbox)"
                  }
                ]
              },
              {
                "capability": "Platform team establishment",
                "objective": "Define platform team roles and responsibilities for landing zone operations",
                "scope": "Tenant",
                "owner": "Cloud Leadership",
                "depends_on": [],
                "success_criteria": [
                  "Platform team roles documented",
                  "Ownership assigned for platform operations"
                ],
                "learn_references": [
                  {
                    "title": "Deploy Azure landing zones",
                    "url": "",
                    "excerpt": "# Deploy Azure landing zones\n## Application landing zone architectures\nApplication landing zones are designated areas within one or more subscriptions, specifically set up as approved destinations for resources that application teams manage for a specific workload. A workload can take advantage of services in the platform landing zone or remain isolated from those centralized resources. Use application landing zones for centrally managed applications, decentralized workloads that application teams own, and centrally managed hosting platforms like Azure Kubernetes Service (AKS) that can host applications for multiple business units. Unless unusual circumstances constrain application landing zone subscriptions, they typically include resources from only a single workload or logical application boundary, like its life cycle or criticality classification.\nWorkload teams communicate their workload's requirements through a formal process that the platform team establishes. The platform team generally deploys an empty subscription that's enrolled with all required governance. Then a workload architect designs a solution that works within the constraints of that application landing zone and takes advantage of shared platform features, like firewalls and cross-premises routing, when practical.\nAn architect can adapt a reference architecture that isn't designed specifically for an application landing zone. But Microsoft Learn also has application and data platform guidance for workload teams that specifically addresses application landing zone contexts. Make the platform teams aware of this guidance so that they can anticipate the workload types and characteristics in the organization.\n| Application landing zone architecture | Description| \n|  --- | ---  |\n| [App Service Environment](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/app-platform/app-services/landing-zone-accelerator) | Proven recommendations and considerations across both multitenant and App Service Environment use cases with a reference implementation. |\n| [Azure API Management](https://learn.microsoft.com/azure/architecture/example-scenario/integration/app-gateway-internal-api-management-function) | Proven recommendations and considerations for how to deploy an internal API Management instance as part of a reference implementation. The scenario uses Azure Application Gateway to help provide secure ingress control and uses Azure Functions as the back end. |\n| [Azure Arc for hybrid and multicloud scenarios](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/hybrid/enterprise-scale-landing-zone) | Guidance for servers, Kubernetes, and Azure SQL Managed Instance enabled by Azure Arc. |\n| [Azure Container Apps](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/app-platform/container-apps/landing-zone-accelerator) | Guidance that outlines the strategic design path and defines the target technical state for deploying Container Apps. A dedicated workload team owns and operates this platform. |"
                  },
                  {
                    "title": "Azure Integration Services application landing zone accelerator in an Azure landing zone",
                    "url": "",
                    "excerpt": "# Azure Integration Services application landing zone accelerator in an Azure landing zone\nThis article provides strategic guidance for deploying Azure Integration Services (AIS) within an Azure landing zone. Azure Integration Services includes Logic Apps, API Management, Service Bus, and Event Grid. These services enable scalable integration across applications, data, and business processes. The AIS application landing zone accelerator automates the deployment of these services, which promotes consistency and scalability while aligning with Azure landing zone standards.\n[![Diagram that shows Azure Integration Services landing zone accelerator architecture.](https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/integration-services/media/integration-services-enterprise-deployment_highres.png)](media/integration-services-enterprise-deployment_highres.png#lightbox)\n## Establish an Azure landing zone\n**Start with an Azure landing zone.** Begin with a foundational [Azure landing zone](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/) that includes shared services such as identity, networking, and monitoring. Centralized platform teams must own and operate these services to enforce governance, security, and compliance policies across all workloads. This separation of responsibilities allows workload teams to focus on delivering business value through application development without duplicating platform capabilities.\n**Understand integration points.** Integration workloads often depend on shared resources like virtual networks, identity providers, and observability tools. Establish clear communication channels between platform and workload teams to align on resource planning. For example, if a workload requires high throughput, the platform team must allocate sufficient IP address space and bandwidth early in the planning cycle. This coordination reduces rework and accelerates deployment timelines.\n## How to use the AIS application landing zone accelerator\n**Review the architecture diagram.** The architecture diagram illustrates how AIS components integrate within an Azure landing zone. Review this visualization with stakeholders to evaluate tradeoffs in scalability, security, and maintainability. Use the diagram to guide decisions about service boundaries, data flow, and governance controls.\n**Deploy the reference implementation.** The GitHub hosted [AIS application landing zone accelerator](https://github.com/Azure/Integration-Services-Landing-Zone-Accelerator/blob/main/docs/scenario1/Reference%20Implementation.md) provides a working environment that includes preconfigured services, governance policies, and automation scripts. Use this implementation to validate architecture decisions, onboard development teams, and begin integration development immediately. This approach reduces setup time and ensures alignment with enterprise standards."
                  }
                ]
              },
              {
                "capability": "Policy baseline",
                "objective": "Establish initial policy assignments for public IP governance and diagnostic settings",
                "scope": "Platform and Landing Zones management groups",
                "owner": "Platform Team",
                "depends_on": [
                  "Management group hierarchy"
                ],
                "success_criteria": [
                  "Policies assigned to enforce public IP restrictions",
                  "Policies assigned to require diagnostic settings on key resources"
                ],
                "learn_references": [
                  {
                    "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                    "url": "",
                    "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Azure Policy\nThe platform team likely applies policies that affect the workload deployment. They often apply DINE policies to handle automated deployments into an application landing zone subscription. DINE policies can modify workload resources or add resources to your deployment, which can result in a discrepancy between the resources that are declaratively deployed through the workload template and the resources that the processing requests actually use. A typical solution is to fix those changes with imperative approaches, which aren't ideal.\nTo avoid that discrepancy, preemptively incorporate and test the platform-initiated changes into your IaC templates. If the platform team uses Azure policies that conflict with the requirements of the application, you can negotiate a resolution with the platform team.\nImportant\nAzure landing zones use various DINE policies, for example a policy that manages private endpoints at scale. This policy monitors private endpoint deployments and updates Azure DNS in the hub network, which is part of a platform-managed subscription. The workload team doesn't have permission to modify the policy in the hub, and the platform team doesn't monitor the workload teams' deployments to update DNS automatically. DINE policies are used to provide this connection.\nOther policies might affect this architecture, including policies that:\n1. Require a Windows VM to join an Active Directory domain. This policy ensures that the `JoinADDomainExtension` VM extension is installed and configured. For more information, see [Enforce Windows VMs to join an Active Directory domain](https://github.com/Azure/Enterprise-Scale/blob/main/docs/reference/azpol.md#enforce-windows-vms-to-join-ad-domain).\n2. Disallow IP forwarding on network interfaces."
                  },
                  {
                    "title": "Monitor Azure platform landing zone components",
                    "url": "",
                    "excerpt": "# Monitor Azure platform landing zone components\n## Azure landing zone monitoring guidance\nIn accordance with [Azure landing zone principles for policy-driven governance](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/dine-guidance#why-use-dine-and-modify-policies), a framework solution is available that provides an easy way to scale alerting by using Azure Policy. These policies use the *DeployIfNotExists* effect to deploy relevant alert rules, alert processing rules, and action groups when you create a resource in your Azure landing zone environment, in both platform services and landing zones.\nAzure Policy provides a default baseline configuration, but you can configure the policies to suit your needs. If you require alerting on different metrics than what the repository provides, the solution provides a framework for you to develop your own policies for deploying alert rules. For more information, see the [Azure Monitor baseline alerts (AMBA) contributor guide](https://aka.ms/amba/contributing) and [Introduction to an Azure Monitor deployment](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/). The solution is integrated into the Azure landing zone installation experience, so new implementations of Azure landing zone offer you the opportunity to set up baseline alerting at installation time.\nDeploy alerts via policies to provide flexibility and scalability, and to ensure that alerts are deployed inside and outside the Azure landing zone scope. Alerts are only deployed when the corresponding resources are created, which avoids unnecessary cost and ensures updated alerts configurations at deployment time. This function coincides with the Azure landing zone principle of policy-driven governance."
                  }
                ],
                "code_samples": [
                  {
                    "title": "description: Defines a Bicep template that assigns the built-in Azure Windows Baseline guest configuration to an existin",
                    "language": "bicep",
                    "code": "resource myWindowsVM 'Microsoft.Compute/virtualMachines@2021-03-01' existing = {\r\n  name: '<vm_name>'\r\n}\r\n\r\nresource AzureWindowsBaseline 'Microsoft.GuestConfiguration/guestConfigurationAssignments@2020-06-25' = {\r\n  name: 'AzureWindowsBaseline'\r\n  scope: myWindowsVM\r\n  location: resourceGroup().location\r\n  properties: {\r\n    guestConfiguration: {\r\n      name: 'AzureWindowsBaseline'\r\n      version: '1.*'\r\n      assignmentType: 'ApplyAndMonitor'\r\n      configurationParameter: [\r\n        {\r\n          name: 'Minimum Password Length;ExpectedValue'\r\n          value: '16'\r\n        }\r\n        {\r\n          name: 'Minimum Password Length;RemediateValue'\r\n          value: '16'\r\n        }\r\n        {\r\n          name: 'Maximum Password Age;ExpectedValue'\r\n          value: '75'\r\n        }\r\n        {\r\n          name: 'Maximum Password Age;RemediateValue'\r\n          value: '75'\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}",
                    "url": ""
                  },
                  {
                    "title": "description: Uses Azure CLI to deploy the Bicep template to an Azure resource group.\npackage: azure-cli\nlanguage: azurec",
                    "language": "azurecli",
                    "code": "az deployment group create --resource-group <RESOURCE_GROUP> --template-file <FILE>.bicep",
                    "url": ""
                  }
                ]
              }
            ]
          },
          {
            "name": "Phase 2: Network & Security Platform",
            "execution_units": [
              {
                "capability": "Hub-spoke network topology",
                "objective": "Establish hub VNet with Azure Firewall and DDoS Protection; connect workload spokes",
                "scope": "Platform/Connectivity and Corp landing zone",
                "owner": "Platform Team",
                "depends_on": [
                  "Management group hierarchy",
                  "Policy baseline"
                ],
                "success_criteria": [
                  "Hub VNet deployed in Platform/Connectivity",
                  "Azure Firewall deployed in hub",
                  "DDoS Protection enabled on hub",
                  "Spoke VNet(s) connected to hub"
                ],
                "learn_references": [
                  {
                    "title": "Hub-spoke network topology in Azure",
                    "url": "",
                    "excerpt": "# Hub-spoke network topology in Azure\n## Recommendations\nThe following recommendations apply to most scenarios. Follow these recommendations unless you have specific requirements that override them.\n### Resource groups, subscriptions, and regions\nThis example solution uses a single Azure resource group. You can also implement the hub and each spoke in different resource groups and subscriptions.\nWhen you peer virtual networks in different subscriptions, you can associate the subscriptions to the same or different Microsoft Entra tenants. This flexibility allows for decentralized management of each workload while maintaining shared services in the hub. See [Create a virtual network peering - Resource Manager, different subscriptions, and Microsoft Entra tenants](https://learn.microsoft.com/en-us/azure/virtual-network/create-peering-different-subscriptions).\n#### Azure landing zones\nThe [Azure landing zone architecture](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is based on the hub-spoke topology. In that architecture, a centralized platform team manages the hub's shared resources and network, while spokes share a co-ownership model with the platform team and the workload team that uses the spoke network. All hubs reside in a \"Connectivity\" subscription for centralized management, while spoke virtual networks exist across many individual workload subscriptions, called application landing zone subscriptions.\n### Virtual network subnets\nThe following recommendations outline how to configure the subnets on the virtual network.\n#### GatewaySubnet\nThe virtual network gateway requires this subnet. You can also use a hub-spoke topology without a gateway if you don't need cross-premises network connectivity.\n[Create a subnet named *GatewaySubnet* with an address range of at least `26`](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-about-virtual-network-gateways#gwsub). The `/26` address range gives the subnet enough scalability configuration options to prevent reaching the gateway size limitations in the future and to accommodate for a higher number of ExpressRoute circuits. For more information about setting up the gateway, see [Hybrid network using a VPN gateway](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager).\n#### AzureFirewallSubnet\nCreate a subnet named *AzureFirewallSubnet* with an address range of at least `/26`. Regardless of scale, the `/26` address range is the recommended size and covers any future size limitations. This subnet doesn't support network security groups (NSGs).\nAzure Firewall requires this subnet. If you use a partner network virtual appliance (NVA), follow its network requirements.\n### Spoke network connectivity"
                  },
                  {
                    "title": "Virtual WAN network topology in an Azure landing zone",
                    "url": "",
                    "excerpt": "# Virtual WAN network topology in an Azure landing zone\n## Create hub-and-spoke network architecture\nAzure Virtual WAN simplifies end-to-end network connectivity in Azure, and to Azure from on-premises, by creating a [hub-and-spoke network architecture](https://learn.microsoft.com/en-us/azure/virtual-wan/virtual-wan-global-transit-network-architecture). The architecture easily scales to support multiple Azure regions and on-premises locations (any-to-any connectivity) as shown in the following figure:\n![Diagram that illustrates a global transit network with Virtual WAN.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/media/global-transit.png)\n Diagram of a global transit network using Azure Virtual WAN. It shows two regions, Region 1 and Region 2, each containing multiple VNets connected to a Virtual WAN hub. The hubs are linked by a hub-to-hub connection for inter-region communication. Below each hub, icons represent branch offices and connectivity endpoints, including ExpressRoute and user devices. The layout emphasizes centralized hub connectivity for VNets within regions and global transit between regions.\n*Figure 2: Global transit network with Virtual WAN.*\nAzure Virtual WAN any-to-any transitive connectivity supports the following paths within the same region and across regions:\n1. Virtual network to virtual network\n2. Virtual network to branch\n3. Branch to virtual network\n4. Branch to branch\n**Constraints:** Virtual WAN hubs only support Microsoft-managed resources such as:\n1. Virtual network gateways (point-to-site VPN, site-to-site VPN, and Azure ExpressRoute)\n2. Azure Firewall via Firewall Manager\n3. Route tables\n4. Some [network virtual appliances (NVA)](https://learn.microsoft.com/en-us/azure/virtual-wan/about-nva-hub) for vendor-specific SD-WAN capabilities"
                  }
                ],
                "code_samples": [
                  {
                    "title": "description: Deploys the Bicep template to an Azure resource group using Azure CLI, specifying the resource group and Bi",
                    "language": "azurecli",
                    "code": "az deployment group create --resource-group <RESOURCE_GROUP> --template-file <FILE>.bicep",
                    "url": ""
                  },
                  {
                    "title": "description: Defines a Bicep template to deploy a secure virtual hub using Azure Firewall Manager, including virtual WAN",
                    "language": "bicep",
                    "code": "@description('Admin username for the servers')\r\nparam adminUsername string\r\n\r\n@description('Password for the admin account on the servers')\r\n@secure()\r\nparam adminPassword string\r\n\r\n@description('Location for all resources.')\r\nparam location string = resourceGroup().location\r\n\r\n@description('Size of the virtual machine.')\r\nparam vmSize string = 'Standard_D2_v3'\r\n\r\nresource virtualWan 'Microsoft.Network/virtualWans@2021-08-01' = {\r\n  name: 'VWan-01'\r\n  location: location\r\n  properties: {\r\n    disableVpnEncryption: false\r\n    allowBranchToBranchTraffic: true\r\n    type: 'Standard'\r\n  }\r\n}\r\n\r\nresource virtualHub 'Microsoft.Network/virtualHubs@2021-08-01' = {\r\n  name: 'Hub-01'\r\n  location: location\r\n  properties: {\r\n    addressPrefix: '10.1.0.0/16'\r\n    virtualWan: {\r\n      id: virtualWan.id\r\n    }\r\n  }\r\n}\r\n\r\nresource hubVNetconnection 'Microsoft.Network/virtualHubs/hubVirtualNetworkConnections@2021-08-01' = {\r\n  parent: virtualHub\r\n  name: 'hub-spoke'\r\n  dependsOn: [\r\n    firewall\r\n  ]\r\n  properties: {\r\n    remoteVirtualNetwork: {\r\n      id: virtualNetwork.id\r\n    }\r\n    allowHubToRemoteVnetTransit: true\r\n    allowRemoteVnetToUseHubVnetGateways: false\r\n    enableInternetSecurity: true\r\n    routingConfiguration: {\r\n      associatedRouteTable: {\r\n        id: hubRouteTable.id\r\n      }\r\n      propagatedRouteTables: {\r\n        labels: [\r\n          'VNet'\r\n        ]\r\n        ids: [\r\n          {\r\n            id: hubRouteTable.id\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nresource policy 'Microsoft.Network/firewallPolicies@2021-08-01' = {\r\n  name: 'Policy-01'\r\n  location: location\r\n  properties: {\r\n    threatIntelMode: 'Alert'\r\n  }\r\n}\r\n\r\nresource ruleCollectionGroup 'Microsoft.Network/firewallPolicies/ruleCollectionGroups@2021-08-01' = {\r\n  parent: policy\r\n  name: 'DefaultApplicationRuleCollectionGroup'\r\n  properties: {\r\n    priority: 300\r\n    ruleCollections: [\r\n      {\r\n        ruleCollectionType: 'FirewallPolicyFilterRuleCollection'\r\n        name: 'RC-01'\r\n        priority: 100\r\n        action: {\r\n          type: 'Allow'\r\n        }\r\n        rules: [\r\n          {\r\n            ruleType: 'ApplicationRule'\r\n            name: 'Allow-msft'\r\n            sourceAddresses: [\r\n              '*'\r\n            ]\r\n            protocols: [\r\n              {\r\n                port: 80\r\n                protocolType: 'Http'\r\n              }\r\n              {\r\n                port: 443\r\n                protocolType: 'Https'\r\n              }\r\n            ]\r\n            targetFqdns: [\r\n              '*.microsoft.com'\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\nresource firewall 'Microsoft.Network/azureFirewalls@2021-08-01' = {\r\n  name: 'AzfwTest'\r\n  location: location\r\n  properties: {\r\n    sku: {\r\n      name: 'AZFW_Hub'\r\n      tier: 'Standard'\r\n    }\r\n    hubIPAddresses: {\r\n      publicIPs: {\r\n        count: 1\r\n      }\r\n    }\r\n    virtualHub: {\r\n      id: virtualHub.id\r\n    }\r\n    firewallPolicy: {\r\n      id: policy.id\r\n    }\r\n  }\r\n}\r\n\r\nresource virtualNetwork 'Microsoft.Network/virtualNetworks@2021-08-01' = {\r\n  name: 'Spoke-01'\r\n  location: location\r\n  properties: {\r\n    addressSpace: {\r\n      addressPrefixes: [\r\n        '10.0.0.0/16'\r\n      ]\r\n    }\r\n    enableDdosProtection: false\r\n    enableVmProtection: false\r\n  }\r\n}\r\n\r\nresource subnet_Workload_SN 'Microsoft.Network/virtualNetworks/subnets@2021-08-01' = {\r\n  parent: virtualNetwork\r\n  name: 'Workload-SN'\r\n  properties: {\r\n    addressPrefix: '10.0.1.0/24'\r\n    privateEndpointNetworkPolicies: 'Enabled'\r\n    privateLinkServiceNetworkPolicies: 'Enabled'\r\n  }\r\n}\r\n\r\nresource subnet_Jump_SN 'Microsoft.Network/virtualNetworks/subnets@2021-08-01' = {\r\n  parent: virtualNetwork\r\n  name: 'Jump-SN'\r\n  dependsOn: [\r\n    subnet_Workload_SN\r\n  ]\r\n  properties: {\r\n    addressPrefix: '10.0.2.0/24'\r\n    routeTable: {\r\n      id: routeTable.id\r\n    }\r\n    privateEndpointNetworkPolicies: 'Enabled'\r\n    privateLinkServiceNetworkPolicies: 'Enabled'\r\n  }\r\n}\r\n\r\nresource Jump_Srv 'Microsoft.Compute/virtualMachines@2022-03-01' = {\r\n  name: 'Jump-Srv'\r\n  location: location\r\n  properties: {\r\n    hardwareProfile: {\r\n      vmSize: vmSize\r\n    }\r\n    storageProfile: {\r\n      imageReference: {\r\n        publisher: 'MicrosoftWindowsServer'\r\n        offer: 'WindowsServer'\r\n        sku: '2019-Datacenter'\r\n        version: 'latest'\r\n      }\r\n      osDisk: {\r\n        osType: 'Windows'\r\n        createOption: 'FromImage'\r\n        caching: 'ReadWrite'\r\n        managedDisk: {\r\n          storageAccountType: 'StandardSSD_LRS'\r\n        }\r\n        diskSizeGB: 127\r\n      }\r\n    }\r\n    osProfile: {\r\n      computerName: 'Jump-Srv'\r\n      adminUsername: adminUsername\r\n      adminPassword: adminPassword\r\n      windowsConfiguration: {\r\n        provisionVMAgent: true\r\n        enableAutomaticUpdates: true\r\n      }\r\n      allowExtensionOperations: true\r\n    }\r\n    networkProfile: {\r\n      networkInterfaces: [\r\n        {\r\n          id: netInterface_jump_srv.id\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\nresource Workload_Srv 'Microsoft.Compute/virtualMachines@2022-03-01' = {\r\n  name: 'Workload-Srv'\r\n  location: location\r\n  properties: {\r\n    hardwareProfile: {\r\n      vmSize: vmSize\r\n    }\r\n    storageProfile: {\r\n      imageReference: {\r\n        publisher: 'MicrosoftWindowsServer'\r\n        offer: 'WindowsServer'\r\n        sku: '2019-Datacenter'\r\n        version: 'latest'\r\n      }\r\n      osDisk: {\r\n        osType: 'Windows'\r\n        createOption: 'FromImage'\r\n        caching: 'ReadWrite'\r\n        managedDisk: {\r\n          storageAccountType: 'StandardSSD_LRS'\r\n        }\r\n        diskSizeGB: 127\r\n      }\r\n    }\r\n    osProfile: {\r\n      computerName: 'Workload-Srv'\r\n      adminUsername: adminUsername\r\n      adminPassword: adminPassword\r\n      windowsConfiguration: {\r\n        provisionVMAgent: true\r\n        enableAutomaticUpdates: true\r\n      }\r\n      allowExtensionOperations: true\r\n    }\r\n    networkProfile: {\r\n      networkInterfaces: [\r\n        {\r\n          id: netInterface_workload_srv.id\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\nresource netInterface_workload_srv 'Microsoft.Network/networkInterfaces@2021-08-01' = {\r\n  name: 'netInterface-workload-srv'\r\n  location: location\r\n  properties: {\r\n    ipConfigurations: [\r\n      {\r\n        name: 'ipconfig1'\r\n        properties: {\r\n          privateIPAllocationMethod: 'Dynamic'\r\n          subnet: {\r\n            id: subnet_Workload_SN.id\r\n          }\r\n          primary: true\r\n          privateIPAddressVersion: 'IPv4'\r\n        }\r\n      }\r\n    ]\r\n    enableAcceleratedNetworking: false\r\n    enableIPForwarding: false\r\n    networkSecurityGroup: {\r\n      id: nsg_workload_srv.id\r\n    }\r\n  }\r\n}\r\n\r\nresource netInterface_jump_srv 'Microsoft.Network/networkInterfaces@2021-08-01' = {\r\n  name: 'netInterface-jump-srv'\r\n  location: location\r\n  properties: {\r\n    ipConfigurations: [\r\n      {\r\n        name: 'ipconfig1'\r\n        properties: {\r\n          privateIPAllocationMethod: 'Dynamic'\r\n          publicIPAddress: {\r\n            id: publicIP_jump_srv.id\r\n          }\r\n          subnet: {\r\n            id: subnet_Jump_SN.id\r\n          }\r\n          primary: true\r\n          privateIPAddressVersion: 'IPv4'\r\n        }\r\n      }\r\n    ]\r\n    enableAcceleratedNetworking: false\r\n    enableIPForwarding: false\r\n    networkSecurityGroup: {\r\n      id: nsg_jump_srv.id\r\n    }\r\n  }\r\n}\r\n\r\nresource nsg_jump_srv 'Microsoft.Network/networkSecurityGroups@2021-08-01' = {\r\n  name: 'nsg-jump-srv'\r\n  location: location\r\n  properties: {\r\n    securityRules: [\r\n      {\r\n        name: 'RDP'\r\n        properties: {\r\n          protocol: 'Tcp'\r\n          sourcePortRange: '*'\r\n          destinationPortRange: '3389'\r\n          sourceAddressPrefix: '*'\r\n          destinationAddressPrefix: '*'\r\n          access: 'Allow'\r\n          priority: 300\r\n          direction: 'Inbound'\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\nresource nsg_workload_srv 'Microsoft.Network/networkSecurityGroups@2021-08-01' = {\r\n  name: 'nsg-workload-srv'\r\n  location: location\r\n  properties: {}\r\n}\r\n\r\nresource publicIP_jump_srv 'Microsoft.Network/publicIPAddresses@2021-08-01' = {\r\n  name: 'publicIP-jump-srv'\r\n  location: location\r\n  sku: {\r\n    name: 'Standard'\r\n  }\r\n  properties: {\r\n    publicIPAddressVersion: 'IPv4'\r\n    publicIPAllocationMethod: 'Static'\r\n    idleTimeoutInMinutes: 4\r\n  }\r\n}\r\n\r\nresource routeTable 'Microsoft.Network/routeTables@2021-08-01' = {\r\n  name: 'RT-01'\r\n  location: location\r\n  properties: {\r\n    disableBgpRoutePropagation: false\r\n    routes: [\r\n      {\r\n        name: 'jump-to-inet'\r\n        properties: {\r\n          addressPrefix: '0.0.0.0/0'\r\n          nextHopType: 'Internet'\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\nresource hubRouteTable 'Microsoft.Network/virtualHubs/hubRouteTables@2021-08-01' = {\r\n  parent: virtualHub\r\n  name: 'RT_VNet'\r\n  properties: {\r\n    routes: [\r\n      {\r\n        name: 'Workload-SNToFirewall'\r\n        destinationType: 'CIDR'\r\n        destinations: [\r\n          '10.0.1.0/24'\r\n        ]\r\n        nextHopType: 'ResourceId'\r\n        nextHop: firewall.id\r\n      }\r\n      {\r\n        name: 'InternetToFirewall'\r\n        destinationType: 'CIDR'\r\n        destinations: [\r\n          '0.0.0.0/0'\r\n        ]\r\n        nextHopType: 'ResourceId'\r\n        nextHop: firewall.id\r\n      }\r\n    ]\r\n    labels: [\r\n      'VNet'\r\n    ]\r\n  }\r\n}",
                    "url": ""
                  }
                ]
              },
              {
                "capability": "Defender for Cloud coverage",
                "objective": "Increase Defender plan enablement to 90% of eligible resources",
                "scope": "All subscriptions",
                "owner": "Platform Team",
                "depends_on": [
                  "Management group hierarchy"
                ],
                "success_criteria": [
                  "Defender plans enabled on at least 90% of eligible resources"
                ],
                "learn_references": [
                  {
                    "title": "Deploy Azure Landing Zone for Nonprofits",
                    "url": "",
                    "excerpt": "# Deploy Azure Landing Zone for Nonprofits\nThe Azure Landing Zone for Nonprofits is a preconfigured, scalable foundation for managing cloud infrastructure in nonprofit organizations. It provides a blueprint for setting up core Azure services, such as networking, management, identity, and security. It ensures that cloud resources are efficiently managed and securely governed from the start. Its simple design offers nonprofit organizations a way to rapidly deploy cloud environments that align with best practices for scalability, security, and compliance.\nThe Azure Landing Zone for Nonprofits offers a comprehensive setup that includes management group structures, policy enforcement, logging, monitoring, and network connectivity. It integrates security features such as Microsoft Defender for Cloud, backup and disaster recovery services, and Azure Key Vault for secrets management. Deploying the landing zone gives you a secure, scalable foundation for your Azure resources, letting you focus on delivering mission-critical services while benefiting from strong governance and operational efficiency.\nFollow the steps in this article to deploy the Azure Landing Zone for Nonprofits using Azure Resource Manager templates (ARM templates). In this deployment, you configure core infrastructure elements such as management groups, log analytics, networking, Azure security, and more.\nThis image is a network diagram showing a hub and spoke deployment for identity management and connectivity subscription.\n![High-level diagram showing a hub and spoke deployment for identity management and connectivity subscription.](https://learn.microsoft.com/industry/nonprofit/media/azure-landing-zone-deployment.png)\nThese instructions help you successfully deploy an Azure landing zone tailored for nonprofit organizations, providing a scalable and secure platform for managing resources and workloads. The elevated permissions allow you to configure essential elements like management groups, network topology, and security settings.\nHave questions or need more help? See [Find a partner](https://www.microsoft.com/nonprofits/partners#azure)."
                  },
                  {
                    "title": "Design area: Security",
                    "url": "",
                    "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
                  }
                ],
                "code_samples": [
                  {
                    "title": "description: Defines an Azure Resource Manager Bicep template to create a Microsoft Defender for Cloud automation that t",
                    "language": "bicep",
                    "code": "@minLength(3)\r\n@maxLength(24)\r\nparam automationName string\r\n\r\n@description('Location for the automation')\r\nparam location string = resourceGroup().location\r\n\r\n@minLength(3)\r\nparam logicAppName string\r\n\r\n@minLength(3)\r\nparam logicAppResourceGroupName string\r\n\r\n@description('The Azure resource GUID id of the subscription')\r\nparam subscriptionId string = subscription().subscriptionId\r\n\r\n@description('The alert settings object used for deploying the automation')\r\nparam alertSettings object\r\n\r\nvar automationDescription = 'automation description for subscription {0}'\r\nvar scopeDescription = 'automation scope for subscription {0}'\r\n\r\nresource automation 'Microsoft.Security/automations@2019-01-01-preview' = {\r\n  name: automationName\r\n  location: location\r\n  properties: {\r\n    description: format(automationDescription, subscriptionId)\r\n    isEnabled: true\r\n    actions: [\r\n      {\r\n        actionType: 'LogicApp'\r\n        logicAppResourceId: resourceId('Microsoft.Logic/workflows', logicAppName)\r\n        uri: listCallbackURL(resourceId(subscriptionId, logicAppResourceGroupName, 'Microsoft.Logic/workflows/triggers', logicAppName, 'manual'), '2019-05-01').value\r\n      }\r\n    ]\r\n    scopes: [\r\n      {\r\n        description: format(scopeDescription, subscriptionId)\r\n        scopePath: subscription().id\r\n      }\r\n    ]\r\n    sources: [\r\n      {\r\n        eventSource: 'Alerts'\r\n        ruleSets: [for j in range(0, length(alertSettings.alertSeverityMapping)): {\r\n          rules: [\r\n            {\r\n              propertyJPath: alertSettings.alertSeverityMapping[j].jpath\r\n              propertyType: 'String'\r\n              expectedValue: alertSettings.alertSeverityMapping[j].expectedValue\r\n              operator: alertSettings.alertSeverityMapping[j].operator\r\n            }\r\n            {\r\n              propertyJPath: 'Severity'\r\n              propertyType: 'String'\r\n              expectedValue: alertSettings.alertSeverityMapping[j].severity\r\n              operator: 'Equals'\r\n            }\r\n          ]\r\n        }]\r\n      }\r\n    ]\r\n  }\r\n}",
                    "url": ""
                  },
                  {
                    "title": "description: Defines an Azure Resource Manager (ARM) template in JSON format to create a Microsoft Defender for Cloud au",
                    "language": "json",
                    "code": "{\r\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n  \"contentVersion\": \"1.0.0.0\",\r\n  \"metadata\": {\r\n    \"_generator\": {\r\n      \"name\": \"bicep\",\r\n      \"version\": \"0.5.6.12127\",\r\n      \"templateHash\": \"5191074894407113732\"\r\n    }\r\n  },\r\n  \"parameters\": {\r\n    \"automationName\": {\r\n      \"type\": \"string\",\r\n      \"maxLength\": 24,\r\n      \"minLength\": 3\r\n    },\r\n    \"location\": {\r\n      \"type\": \"string\",\r\n      \"defaultValue\": \"[resourceGroup().location]\",\r\n      \"metadata\": {\r\n        \"description\": \"Location for the automation\"\r\n      }\r\n    },\r\n    \"logicAppName\": {\r\n      \"type\": \"string\",\r\n      \"minLength\": 3\r\n    },\r\n    \"logicAppResourceGroupName\": {\r\n      \"type\": \"string\",\r\n      \"minLength\": 3\r\n    },\r\n    \"subscriptionId\": {\r\n      \"type\": \"string\",\r\n      \"defaultValue\": \"[subscription().subscriptionId]\",\r\n      \"metadata\": {\r\n        \"description\": \"The Azure resource GUID id of the subscription\"\r\n      }\r\n    },\r\n    \"alertSettings\": {\r\n      \"type\": \"object\",\r\n      \"metadata\": {\r\n        \"description\": \"The alert settings object used for deploying the automation\"\r\n      }\r\n    }\r\n  },\r\n  \"variables\": {\r\n    \"automationDescription\": \"automation description for subscription {0}\",\r\n    \"scopeDescription\": \"automation scope for subscription {0}\"\r\n  },\r\n  \"resources\": [\r\n    {\r\n      \"type\": \"Microsoft.Security/automations\",\r\n      \"apiVersion\": \"2019-01-01-preview\",\r\n      \"name\": \"[parameters('automationName')]\",\r\n      \"location\": \"[parameters('location')]\",\r\n      \"properties\": {\r\n        \"description\": \"[format(variables('automationDescription'), parameters('subscriptionId'))]\",\r\n        \"isEnabled\": true,\r\n        \"actions\": [\r\n          {\r\n            \"actionType\": \"LogicApp\",\r\n            \"logicAppResourceId\": \"[resourceId('Microsoft.Logic/workflows', parameters('logicAppName'))]\",\r\n            \"uri\": \"[listCallbackURL(resourceId(parameters('subscriptionId'), parameters('logicAppResourceGroupName'), 'Microsoft.Logic/workflows/triggers', parameters('logicAppName'), 'manual'), '2019-05-01').value]\"\r\n          }\r\n        ],\r\n        \"scopes\": [\r\n          {\r\n            \"description\": \"[format(variables('scopeDescription'), parameters('subscriptionId'))]\",\r\n            \"scopePath\": \"[subscription().id]\"\r\n          }\r\n        ],\r\n        \"sources\": [\r\n          {\r\n            \"copy\": [\r\n              {\r\n                \"name\": \"ruleSets\",\r\n                \"count\": \"[length(range(0, length(parameters('alertSettings').alertSeverityMapping)))]\",\r\n                \"input\": {\r\n                  \"rules\": [\r\n                    {\r\n                      \"propertyJPath\": \"[parameters('alertSettings').alertSeverityMapping[range(0, length(parameters('alertSettings').alertSeverityMapping))[copyIndex('ruleSets')]].jpath]\",\r\n                      \"propertyType\": \"String\",\r\n                      \"expectedValue\": \"[parameters('alertSettings').alertSeverityMapping[range(0, length(parameters('alertSettings').alertSeverityMapping))[copyIndex('ruleSets')]].expectedValue]\",\r\n                      \"operator\": \"[parameters('alertSettings').alertSeverityMapping[range(0, length(parameters('alertSettings').alertSeverityMapping))[copyIndex('ruleSets')]].operator]\"\r\n                    },\r\n                    {\r\n                      \"propertyJPath\": \"Severity\",\r\n                      \"propertyType\": \"String\",\r\n                      \"expectedValue\": \"[parameters('alertSettings').alertSeverityMapping[range(0, length(parameters('alertSettings').alertSeverityMapping))[copyIndex('ruleSets')]].severity]\",\r\n                      \"operator\": \"Equals\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ],\r\n            \"eventSource\": \"Alerts\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}",
                    "url": ""
                  }
                ]
              }
            ]
          },
          {
            "name": "Phase 3: Logging & Monitoring",
            "execution_units": [
              {
                "capability": "Centralized logging workspace",
                "objective": "Establish Log Analytics workspace for platform and workload diagnostics",
                "scope": "Platform/Management and Corp landing zone",
                "owner": "Platform Team",
                "depends_on": [
                  "Management group hierarchy"
                ],
                "success_criteria": [
                  "Log Analytics workspace exists",
                  "Workspace connected to platform and workload resources"
                ],
                "learn_references": [
                  {
                    "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
                    "url": "",
                    "excerpt": "# Baseline Microsoft Foundry chat reference architecture in an Azure landing zone\n## Monitor resources\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach aligns with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/architecture/baseline-microsoft-foundry-chat#monitoring).\nYou provision the following monitoring resources:\n1. Application Insights serves as the application performance management (APM) service for your team. You configure this service in the chat UI, Agent Service, and models.\n2. The Azure Monitor Logs workspace serves as the unified sink for all logs and metrics from workload-owned Azure resources.\nSimilar to the baseline architecture, all resources must send Azure diagnostics logs to the Azure Monitor Logs workspace that your team provisions. This configuration is part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Azure Monitor Logs workspace. In Azure landing zones, that workspace typically resides in the management subscription.\nThe platform team might have more processes that affect resources in the application landing zone. For example, they might use DINE policies to configure diagnostics and send logs to centralized management subscriptions. They might also apply [Azure Monitor baseline alerts](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/) through policy. Ensure that your implementation doesn't block these extra logging and alerting flows."
                  },
                  {
                    "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                    "url": "",
                    "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Monitoring\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach is consistent with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#monitoring).\nThe workload team provisions the monitoring resources, which include:\n1. Application Insights as the application performance monitoring (APM) service for the workload team.\n2. The Log Analytics workspace as the unified sink for all logs and metrics that are collected from workload-owned Azure resources and the application code.\n[![Diagram that shows monitoring resources for the workload.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-monitoring.vsdx) of this architecture.*\nSimilar to the baseline, all resources are configured to send Azure Diagnostics logs to the Log Analytics workspace that the workload team provisions as part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Log Analytics workspace. In Azure landing zones, that workspace is in the management subscription.\nThe platform team might also have DINE policies that they can use to configure Diagnostics to send logs to their centralized management subscriptions. It's important to ensure that your implementation doesn't restrict the additional log flows.\n### Correlate data from multiple sinks\nThe workload's logs and metrics and its infrastructure components are stored in the workload's Log Analytics workspace. However, logs and metrics that centralized services, such as Azure Firewall, Microsoft Entra ID, and Azure Bastion, generate are stored in a central Log Analytics workspace. Correlating data from multiple sinks can be a complex task.\nCorrelated data is often used during incident response. If there's a problem with correlating data from multiple sinks, make sure the triage runbook for this architecture addresses it and includes organizational points of contact if the problem extends beyond the workload resources. Workload administrators might require assistance from platform administrators to correlate log entries from enterprise networking, security, or other platform services.\nImportant\n**For the platform team:** Where possible, grant Azure role-based access control (Azure RBAC) to query and read log sinks for relevant platform resources. Enable firewall logs for network and application rule evaluations and DNS proxy because the application teams can use this information during troubleshooting tasks."
                  }
                ]
              },
              {
                "capability": "Diagnostic settings coverage",
                "objective": "Increase diagnostic settings coverage to 40% of resources",
                "scope": "All subscriptions",
                "owner": "Platform Team",
                "depends_on": [
                  "Centralized logging workspace"
                ],
                "success_criteria": [
                  "At least 40% of resources have diagnostic settings configured"
                ],
                "learn_references": [
                  {
                    "title": "terraform-azurerm-avm-ptn-aiml-landing-zone",
                    "url": "",
                    "excerpt": "# terraform-azurerm-avm-ptn-aiml-landing-zone\n## Optional Inputs\n```hcl\nobject({\n    deploy                     = optional(bool, true)\n    name                       = optional(string)\n    enable_diagnostic_settings = optional(bool, true)\n    diagnostic_settings = optional(map(object({\n      name                                     = optional(string, null)\n      log_categories                           = optional(set(string), [])\n      log_groups                               = optional(set(string), [\"allLogs\"])\n      metric_categories                        = optional(set(string), [\"AllMetrics\"])\n      log_analytics_destination_type           = optional(string, \"Dedicated\")\n      workspace_resource_id                    = optional(string, null)\n      storage_account_resource_id              = optional(string, null)\n      event_hub_authorization_rule_resource_id = optional(string, null)\n      event_hub_name                           = optional(string, null)\n      marketplace_partner_resource_id          = optional(string, null)\n    })), {})\n    secondary_regions = optional(list(object({\n      location          = string\n      zone_redundant    = optional(bool, true)\n      failover_priority = optional(number, 0)\n    })), [])\n    public_network_access_enabled    = optional(bool, false)\n    analytical_storage_enabled       = optional(bool, true)\n    automatic_failover_enabled       = optional(bool, true)\n    local_authentication_disabled    = optional(bool, true)\n    partition_merge_enabled          = optional(bool, false)\n    multiple_write_locations_enabled = optional(bool, false)\n    analytical_storage_config = optional(object({\n      schema_type = string\n    }), null)\n    consistency_policy = optional(object({\n      max_interval_in_seconds = optional(number, 300)\n      max_staleness_prefix    = optional(number, 100001)\n      consistency_level       = optional(string, \"Session\")\n    }), {})\n    backup = optional(object({\n      retention_in_hours  = optional(number)\n      interval_in_minutes = optional(number)\n      storage_redundancy  = optional(string)\n      type                = optional(string)\n      tier                = optional(string)\n    }), {})\n    capabilities = optional(set(object({\n      name = string\n    })), [])\n    capacity = optional(object({\n      total_throughput_limit = optional(number, -1)\n    }), {})\n    cors_rule = optional(object({\n      allowed_headers    = set(string)\n      allowed_methods    = set(string)\n      allowed_origins    = set(string)\n      exposed_headers    = set(string)\n      max_age_in_seconds = optional(number, null)\n    }), null)\n  })\n```"
                  },
                  {
                    "title": "terraform-azurerm-avm-ptn-aiml-landing-zone",
                    "url": "",
                    "excerpt": "# terraform-azurerm-avm-ptn-aiml-landing-zone\n## Optional Inputs\n6.2.4.5. `log_analytics_destination_type` - (Optional) The destination type for the diagnostic setting. Possible values are `Dedicated` and `AzureDiagnostics`. Defaults to `Dedicated`.\n6.2.4.6. `workspace_resource_id` - (Optional) The resource ID of the log analytics workspace to send logs and metrics to.\n6.2.4.7. `storage_account_resource_id` - (Optional) The resource ID of the storage account to send logs and metrics to.\n6.2.4.8. `event_hub_authorization_rule_resource_id` - (Optional) The resource ID of the event hub authorization rule to send logs and metrics to.\n6.2.4.9. `event_hub_name` - (Optional) The name of the event hub. If none is specified, the default event hub will be selected.\n6.2.4.10. `marketplace_partner_resource_id` - (Optional) The full ARM resource ID of the Marketplace resource to which you would like to send Diagnostic Logs.\n6.2.5. `name` - (Optional) Name of the account if creating new.\n6.2.6. `secondary_regions` - (Optional) List of secondary regions for geo-replication. Default is [].\n6.2.6.1. `location` - Azure region name for the secondary location.\n6.2.6.2. `zone_redundant` - (Optional) Whether zone redundancy is enabled. Default is true.\n6.2.6.3. `failover_priority` - (Optional) Failover priority. Default is 0.\n6.2.7. `public_network_access_enabled` - (Optional) Whether public network access is enabled. Default is false.\n6.2.8. `analytical_storage_enabled` - (Optional) Whether analytical storage is enabled. Default is true.\n6.2.9. `automatic_failover_enabled` - (Optional) Whether automatic failover is enabled. Default is true.\n6.2.10. `local_authentication_disabled` - (Optional) Whether local authentication is disabled. Default is true.\n6.2.11. `partition_merge_enabled` - (Optional) Whether partition merge is enabled. Default is false."
                  }
                ],
                "code_samples": [
                  {
                    "title": "description: Deploys the Bicep template for creating a diagnostic setting using the Azure CLI deployment group create co",
                    "language": "azurecli",
                    "code": "az deployment group create \\\r\n        --resource-group \"<resource-group-name>\" \\\r\n        --template-file diagnosticSetting.bicep \\\r\n        --parameters \\\r\n          azureCosmosDbAccountName=\"<azure-cosmos-db-account-name>\" \\\r\n          logAnalyticsWorkspaceName=\"<log-analytics-workspace-name>\"",
                    "url": ""
                  },
                  {
                    "title": "description: Defines and deploys an Azure Log Analytics workspace and diagnostic settings for an App Service using Bicep",
                    "language": "bicep",
                    "code": "Include logging, metrics, and alerting in your IaC templates with a [Bicep diagnosticSettings resource reference](https://learn.microsoft.com/azure/templates/microsoft.insights/diagnosticsettings). Example (Bicep):",
                    "url": ""
                  }
                ]
              },
              {
                "capability": "Entra ID logging integration",
                "objective": "Enable Entra ID logs to be sent to centralized workspace",
                "scope": "Tenant",
                "owner": "Platform Team",
                "depends_on": [
                  "Centralized logging workspace"
                ],
                "success_criteria": [
                  "Entra ID logs are present in Log Analytics workspace"
                ],
                "learn_references": [
                  {
                    "title": "Incorporate Zero Trust practices in your landing zone",
                    "url": "",
                    "excerpt": "# Incorporate Zero Trust practices in your landing zone\n## Visibility, automation, and orchestration\nFor information about deployment objectives for visibility, automation, and orchestration, see [Visibility, automation, and orchestration with Zero Trust](https://learn.microsoft.com/en-us/security/zero-trust/deploy/visibility-automation-orchestration). To implement these objectives, you can:\n1. Establish visibility.\n2. Enable automation.\n3. Enable additional controls by practicing continual improvement.\n#### Visibility, automation, and orchestration considerations\n1. The reference implementations provide policies for Azure logging, but additional integration is needed for other services.\n2. You should configure automation tools, like Azure DevOps and GitHub, to send signals.\n#### Visibility, automation, and orchestration recommendations\n1. Deploy Microsoft Sentinel as part of your Azure landing zone.\n2. Create a plan to integrate signals from Microsoft Entra ID and tools into Microsoft 365 to your Microsoft Sentinel workspace.\n3. Create a plan for conducting threat-hunting exercises and continual security improvements."
                  },
                  {
                    "title": "Landing zone identity and access management",
                    "url": "",
                    "excerpt": "# Landing zone identity and access management\n## Design recommendations\n5.2. When you grant access to resources, use Microsoft Entra-only groups for Azure control-plane resources. Both Entra-only users and groups, and those synchronized from on-premises using Microsoft Entra Connect, can be added to an Entra-only group. Add on-premises groups to the Microsoft Entra-only group if a group management system is already in place. Using Entra-only groups helps protect the cloud control plane from unauthorized modification of on-premises directory services. Note that *Microsoft Entra-only* is also known as *cloud only*.\n6. Create [emergency-access](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access) accounts, or break-glass accounts, to avoid accidentally being locked out of your Microsoft Entra ID organization. Emergency-access accounts are highly privileged and are only assigned to specific individuals. Store the credentials for the accounts securely, monitor their use, and test them regularly to ensure that you can use them if there's a disaster.\n  For more information, see [Secure access practices for administrators in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning).\n### Microsoft Entra ID recommendations\n1. [Integrate Microsoft Entra ID with Azure Monitor](https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs) so you can analyze your sign-in activity and the audit trail of changes within your tenant. Configure a diagnostic setting to send sign-in logs and audit logs to the platform central Azure Monitor Logs workspace in the management subscription.\n2. Use the entitlement management feature of Microsoft Entra ID Governance to [create access packages](https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview) that control group membership via automatic approval processes and regular access reviews for privileged group members.\n3. Use [Microsoft Entra built-in roles](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference) to manage the following identity settings from a tenant level:\n  | Role | Description | Note |\n  | --- | --- | --- |\n  | Global Administrator | Manages all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities. | Don't assign more than five people to this role. |"
                  }
                ]
              }
            ]
          }
        ]
      },
      "links": {
        "learn_references": [
          {
            "title": "CAF Enterprise-Scale Landing Zones",
            "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/"
          },
          {
            "title": "CAF Management Group and Subscription Organization",
            "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups"
          },
          {
            "title": "Hub-spoke network topology in Azure",
            "url": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-spoke"
          },
          {
            "title": "Azure Policy built-in definitions",
            "url": "https://learn.microsoft.com/en-us/azure/governance/policy/samples/built-in-policies"
          },
          {
            "title": "Configure diagnostic settings in Azure",
            "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings"
          },
          {
            "title": "Microsoft Defender for Cloud coverage",
            "url": "https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction"
          }
        ]
      }
    },
    "grounding": {
      "enriched_initiatives": [
        {
          "title": "Establish platform and landing zone management group hierarchy",
          "references": [
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "relevance": "This reference demonstrates how management group hierarchy is foundational to organizing resources and enforcing policies for Azure VMs, directly supporting the customer's need for structured platform and landing zone management."
            },
            {
              "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
              "url": "",
              "relevance": "The Foundry chat architecture illustrates practical management group segmentation, showing how to align landing zone hierarchy with workload isolation, which addresses the customer's platform structuring gap."
            },
            {
              "title": "Monitor Azure platform landing zone components",
              "url": "",
              "relevance": "Monitoring guidance for landing zone components is relevant because it ensures visibility and operational control across the management group hierarchy, supporting the customer's platform governance requirements."
            }
          ]
        },
        {
          "title": "Centralize diagnostics and security visibility",
          "references": [
            {
              "title": "Design area: Security",
              "url": "",
              "relevance": "This document outlines centralized security monitoring strategies, directly supporting the customer's gap in unified diagnostics and security visibility across their Azure estate."
            },
            {
              "title": "Protect your resources with Defender CSPM",
              "url": "",
              "relevance": "Defender CSPM guidance is relevant as it enables centralized security posture management, addressing the customer's need for consolidated security visibility and threat detection."
            },
            {
              "title": "Prepare your landing zone for migration",
              "url": "",
              "relevance": "Preparation guidance emphasizes configuring diagnostic settings and security controls before migration, which aligns with the customer's requirement for centralized visibility during platform transitions."
            }
          ]
        },
        {
          "title": "Apply baseline governance policies",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "relevance": "This article explains how management groups facilitate policy enforcement, directly supporting the customer's need to apply baseline governance policies at scale."
            },
            {
              "title": "Design area: Azure governance",
              "url": "",
              "relevance": "Azure governance design guidance is relevant as it provides actionable steps for policy implementation and compliance, addressing the customer's governance policy gap."
            },
            {
              "title": "Azure landing zone frequently asked questions (FAQ)",
              "url": "",
              "relevance": "The FAQ clarifies common governance challenges and solutions, helping the customer understand how to apply baseline policies in their landing zones."
            }
          ]
        },
        {
          "title": "Implement hub-spoke network topology with centralized egress and DDoS protection",
          "references": [
            {
              "title": "Hub-spoke network topology in Azure",
              "url": "",
              "relevance": "This reference provides detailed architecture and implementation guidance for hub-spoke topologies, directly addressing the customer's need for centralized egress and DDoS protection."
            },
            {
              "title": "Network topology and connectivity",
              "url": "",
              "relevance": "Network topology guidance is relevant as it covers connectivity patterns and security controls, supporting the customer's requirement for secure and scalable hub-spoke design."
            },
            {
              "title": "How to deploy hub-and-spoke topology with Azure Firewall",
              "url": "",
              "relevance": "This deployment guide is pertinent because it shows how to integrate Azure Firewall into hub-spoke networks, addressing the customer's gap in centralized egress and security."
            }
          ]
        },
        {
          "title": "Expand Defender coverage and enforce security baseline",
          "references": [
            {
              "title": "Design area: Security",
              "url": "",
              "relevance": "Security design guidance is directly relevant as it details how to expand Defender coverage and enforce baseline controls, supporting the customer's security posture improvement initiative."
            },
            {
              "title": "Protect your resources with Defender CSPM",
              "url": "",
              "relevance": "Defender CSPM documentation is relevant because it explains how to broaden coverage and automate security baselines, addressing the customer's need for consistent protection."
            },
            {
              "title": "Prepare your landing zone for migration",
              "url": "",
              "relevance": "This reference is pertinent as it highlights pre-migration security baseline enforcement, ensuring the customer's landing zones are protected during expansion."
            }
          ]
        },
        {
          "title": "Integrate centralized identity logging and Entra ID diagnostics",
          "references": [
            {
              "title": "Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones",
              "url": "",
              "relevance": "This document is relevant because it explains how to integrate Entra ID diagnostics and logging into landing zones, directly addressing the customer's gap in centralized identity visibility."
            },
            {
              "title": "Landing zone identity and access management",
              "url": "",
              "relevance": "Identity and access management guidance is pertinent as it covers best practices for logging and diagnostics, supporting the customer's initiative to centralize Entra ID monitoring."
            }
          ]
        }
      ],
      "enriched_gaps": [
        {
          "control_id": "a56888b2-7e83-4404-bd31-b886528502d1",
          "references": [
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "relevance": "This reference demonstrates how to configure centralized diagnostics for VMs, directly addressing the customer's gap in security visibility across workloads."
            },
            {
              "title": "Ready your Azure environment for workloads",
              "url": "",
              "relevance": "The guidance highlights steps to centralize monitoring and diagnostics, supporting the customer's need for unified security visibility."
            }
          ]
        },
        {
          "control_id": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
          "references": [
            {
              "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
              "url": "",
              "relevance": "This article explains how to implement DDoS protection in a Virtual WAN scenario, directly addressing the customer's gap in network-level security."
            },
            {
              "title": "Azure Landing Zones Platform Landing Zone Connectivity with Hub and Spoke Virtual Network",
              "url": "",
              "relevance": "Connectivity guidance for hub-spoke networks includes DDoS protection strategies, supporting the customer's requirement for resilient network design."
            }
          ]
        },
        {
          "control_id": "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "references": [
            {
              "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
              "url": "",
              "relevance": "This reference is relevant as it details Azure Firewall integration in Virtual WAN, addressing the customer's gap in firewall presence for platform connectivity."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "relevance": "ISV guidance includes firewall and security integration best practices, supporting the customer's need for robust firewall coverage in landing zones."
            }
          ]
        },
        {
          "control_id": "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "references": [
            {
              "title": "Hub-spoke network topology in Azure",
              "url": "",
              "relevance": "This article provides actionable steps for implementing hub-spoke topology, directly addressing the customer's gap in network architecture."
            },
            {
              "title": "Virtual WAN network topology in an Azure landing zone",
              "url": "",
              "relevance": "Virtual WAN topology guidance is relevant as it offers alternative approaches to hub-spoke, supporting the customer's need for scalable network design."
            }
          ]
        },
        {
          "control_id": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
          "references": [
            {
              "title": "Deploy Azure Landing Zone for Nonprofits",
              "url": "",
              "relevance": "This reference demonstrates Defender CWP integration in landing zones, directly addressing the customer's gap in comprehensive Defender coverage."
            },
            {
              "title": "Design area: Security",
              "url": "",
              "relevance": "Security design guidance includes Defender CWP configuration, supporting the customer's requirement for expanded coverage."
            }
          ]
        },
        {
          "control_id": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
          "references": [
            {
              "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
              "url": "",
              "relevance": "This architecture shows how to set up diagnostic settings for workloads, directly addressing the customer's gap in diagnostics coverage."
            },
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "relevance": "The VM baseline architecture includes guidance on diagnostic settings, supporting the customer's need for comprehensive logging."
            }
          ]
        },
        {
          "control_id": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
          "references": [
            {
              "title": "Identity and access management considerations for the App Service landing zone accelerator",
              "url": "",
              "relevance": "This document details how to configure identity diagnostics, directly addressing the customer's gap in Entra ID logging."
            },
            {
              "title": "Landing zone identity and access management",
              "url": "",
              "relevance": "Identity management guidance includes centralized logging strategies, supporting the customer's need for Entra ID diagnostics."
            }
          ]
        },
        {
          "control_id": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
          "references": [
            {
              "title": "Implement controls and principles in SLZ",
              "url": "",
              "relevance": "This reference explains how to govern public IP usage, directly addressing the customer's gap in public IP governance."
            },
            {
              "title": "Design area: Azure governance",
              "url": "",
              "relevance": "Azure governance guidance includes policy controls for public IPs, supporting the customer's need for stricter governance."
            }
          ]
        },
        {
          "control_id": "61623a76-5a91-47e1-b348-ef254c27d42e",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "relevance": "This article is relevant as it describes how to structure platform management groups, directly addressing the customer's gap in management group hierarchy."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "relevance": "ISV guidance includes management group best practices, supporting the customer's need for platform-level organization."
            }
          ]
        },
        {
          "control_id": "92481607-d5d1-4e4e-9146-58d3558fd772",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "relevance": "This article explains how to organize landing zones using management groups, directly addressing the customer's gap in landing zone hierarchy."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "relevance": "ISV guidance provides practical advice for structuring landing zones, supporting the customer's need for management group alignment."
            }
          ]
        }
      ],
      "enriched_execution_units": [
        {
          "capability": "Management group hierarchy",
          "phase": "",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "relevance": "This document guides the execution unit by detailing how to establish and manage a hierarchical structure for platform and landing zone management groups, addressing the customer's organizational requirements."
            },
            {
              "title": "Manage application development environments in Azure landing zones",
              "url": "",
              "relevance": "This reference is relevant as it provides practical steps for aligning management group hierarchy with application environments, supporting the customer's platform structuring goals."
            }
          ]
        },
        {
          "capability": "Platform team establishment",
          "phase": "",
          "references": [
            {
              "title": "Deploy Azure landing zones",
              "url": "",
              "relevance": "This document explains how to establish a platform team to manage landing zones, directly supporting the customer's execution unit for platform team formation."
            },
            {
              "title": "Azure Integration Services application landing zone accelerator in an Azure landing zone",
              "url": "",
              "relevance": "The accelerator guidance is relevant as it shows how platform teams can use landing zone patterns to support integration workloads, aligning with the customer's platform team establishment."
            }
          ]
        },
        {
          "capability": "Policy baseline",
          "phase": "",
          "references": [
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "relevance": "This reference guides the execution unit by detailing baseline policy application for VMs, supporting the customer's need for consistent governance."
            },
            {
              "title": "Monitor Azure platform landing zone components",
              "url": "",
              "relevance": "Monitoring guidance is relevant as it ensures baseline policies are enforced and visible, supporting the customer's policy baseline implementation."
            }
          ]
        },
        {
          "capability": "Hub-spoke network topology",
          "phase": "",
          "references": [
            {
              "title": "Hub-spoke network topology in Azure",
              "url": "",
              "relevance": "This document provides step-by-step guidance for implementing hub-spoke topology, directly supporting the customer's execution unit for network architecture."
            },
            {
              "title": "Virtual WAN network topology in an Azure landing zone",
              "url": "",
              "relevance": "Virtual WAN topology guidance offers alternative approaches to hub-spoke, supporting the customer's scalable network execution unit."
            }
          ]
        },
        {
          "capability": "Defender for Cloud coverage",
          "phase": "",
          "references": [
            {
              "title": "Deploy Azure Landing Zone for Nonprofits",
              "url": "",
              "relevance": "This reference demonstrates how to enable Defender for Cloud coverage in landing zones, guiding the customer's execution unit for security posture management."
            },
            {
              "title": "Design area: Security",
              "url": "",
              "relevance": "Security design guidance provides actionable steps for expanding Defender coverage, supporting the customer's execution unit for baseline security."
            }
          ]
        },
        {
          "capability": "Centralized logging workspace",
          "phase": "",
          "references": [
            {
              "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
              "url": "",
              "relevance": "This architecture illustrates centralized logging workspace setup, guiding the customer's execution unit for unified diagnostics."
            },
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "relevance": "VM baseline guidance includes centralized logging configuration, supporting the customer's execution unit for diagnostics coverage."
            }
          ]
        },
        {
          "capability": "Entra ID logging integration",
          "phase": "",
          "references": [
            {
              "title": "Incorporate Zero Trust practices in your landing zone",
              "url": "",
              "relevance": "Zero Trust guidance includes identity logging integration, supporting the customer's execution unit for Entra ID diagnostics."
            },
            {
              "title": "Landing zone identity and access management",
              "url": "",
              "relevance": "This reference provides practical steps for integrating Entra ID logging, guiding the customer's execution unit for identity visibility."
            }
          ]
        }
      ]
    },
    "progress_analysis": {
      "velocity": "stalled",
      "maturity_trend": "declining",
      "recommended_next_initiative": ""
    },
    "_raw": {
      "roadmap": {
        "executive_summary": "The current platform maturity is low (31.6%), with critical gaps in governance, networking, and security. The absence of platform and landing zone management groups, lack of hub-spoke network topology, insufficient diagnostics coverage, and partial Defender coverage significantly increase operational risk. The transformation roadmap prioritizes establishing foundational governance, centralizing diagnostics, and implementing secure network architecture, with measurable improvements projected within 90 days.",
        "transformation_progress": {
          "maturity_change": "Initial baseline established; no prior delta. Immediate focus is on foundational governance and security controls.",
          "key_improvements": [
            "Platform management group structure established",
            "Centralized diagnostics and security visibility implemented",
            "Hub-spoke network topology with egress control and DDoS protection",
            "Expanded Defender coverage and identity log integration"
          ],
          "regressions": [],
          "reprioritized_initiatives": [
            "Governance structure and policy baseline prioritized due to absence of platform and landing zone management groups",
            "Centralized diagnostics advanced due to extremely low coverage (2.1%)"
          ]
        },
        "roadmap_30_60_90": {
          "30_days": [
            {
              "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
              "checklist_id": "A01.01",
              "caf_discipline": "Govern",
              "dependency_on": [],
              "success_criteria": "Platform and landing zone management groups created and visible subscriptions placed correctly",
              "owner_role": "Cloud Platform Architect"
            },
            {
              "action": "Achieve centralized diagnostics and security visibility across all visible resources",
              "checklist_id": "E01.01",
              "caf_discipline": "Manage",
              "dependency_on": [],
              "success_criteria": "Diagnostics coverage exceeds 30% and logs are centralized",
              "owner_role": "Cloud Operations Lead"
            },
            {
              "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
              "checklist_id": "F01.01",
              "caf_discipline": "Govern",
              "dependency_on": [
                "A01.01"
              ],
              "success_criteria": "Policy compliance exceeds 50% and public IP governance enforced",
              "owner_role": "Cloud Governance Lead"
            }
          ],
          "60_days": [
            {
              "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
              "checklist_id": "D07.01",
              "caf_discipline": "Ready",
              "dependency_on": [
                "A01.01",
                "E01.01"
              ],
              "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
              "owner_role": "Network Architect"
            },
            {
              "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
              "checklist_id": "G01.01",
              "caf_discipline": "Secure",
              "dependency_on": [
                "E01.01",
                "F01.01"
              ],
              "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
              "owner_role": "Security Architect"
            }
          ],
          "90_days": [
            {
              "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
              "checklist_id": "B01.01",
              "caf_discipline": "Secure",
              "dependency_on": [
                "E01.01",
                "G01.01"
              ],
              "success_criteria": "Identity logs centralized and diagnostics coverage for Entra ID exceeds 50%",
              "owner_role": "Identity Architect"
            }
          ]
        },
        "parallel_execution_groups": [
          [
            "A01.01",
            "E01.01"
          ],
          [
            "F01.01"
          ],
          [
            "D07.01",
            "G01.01"
          ],
          [
            "B01.01"
          ]
        ],
        "top_risks": [
          {
            "title": "Absence of platform and landing zone management groups",
            "business_impact": "Inability to enforce governance, policy inheritance, and structured resource organization increases risk of uncontrolled cloud sprawl",
            "technical_cause": "No management group hierarchy detected under tenant root",
            "checklist_id": "A01.01"
          },
          {
            "title": "Low diagnostics and security visibility",
            "business_impact": "Limited operational insight and delayed threat detection increase risk of undetected incidents",
            "technical_cause": "Diagnostics coverage at 2.1%; logs not centralized",
            "checklist_id": "E01.01"
          },
          {
            "title": "Lack of hub-spoke topology and egress control",
            "business_impact": "Flat network increases exposure to lateral movement and external threats",
            "technical_cause": "No hub VNet or Azure Firewall detected; DDoS protection missing",
            "checklist_id": "D07.01"
          }
        ],
        "initiative_execution_plan": [
          {
            "checklist_id": "A01.01",
            "title": "Establish platform and landing zone management group hierarchy",
            "priority": 1,
            "blast_radius": "High",
            "caf_discipline": "Govern",
            "why_it_matters": "Enables policy inheritance, RBAC, and structured resource onboarding; foundational for all subsequent governance and security controls",
            "success_criteria": "Platform and landing zone management groups created; subscriptions correctly placed",
            "controls": [
              "61623a76-5a91-47e1-b348-ef254c27d42e",
              "92481607-d5d1-4e4e-9146-58d3558fd772"
            ],
            "dependencies": [],
            "permission_requirements": [
              "Tenant root or management group admin"
            ],
            "owner_role": "Cloud Platform Architect",
            "delivery_model": {
              "estimated_duration": "2 weeks",
              "team": [
                "Platform Engineering"
              ],
              "change_scope": "Tenant"
            },
            "learn_references": [
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": "",
                "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Monitoring\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach is consistent with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#monitoring).\nThe workload team provisions the monitoring resources, which include:\n1. Application Insights as the application performance monitoring (APM) service for the workload team.\n2. The Log Analytics workspace as the unified sink for all logs and metrics that are collected from workload-owned Azure resources and the application code.\n[![Diagram that shows monitoring resources for the workload.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-monitoring.vsdx) of this architecture.*\nSimilar to the baseline, all resources are configured to send Azure Diagnostics logs to the Log Analytics workspace that the workload team provisions as part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Log Analytics workspace. In Azure landing zones, that workspace is in the management subscription.\nThe platform team might also have DINE policies that they can use to configure Diagnostics to send logs to their centralized management subscriptions. It's important to ensure that your implementation doesn't restrict the additional log flows.\n### Correlate data from multiple sinks\nThe workload's logs and metrics and its infrastructure components are stored in the workload's Log Analytics workspace. However, logs and metrics that centralized services, such as Azure Firewall, Microsoft Entra ID, and Azure Bastion, generate are stored in a central Log Analytics workspace. Correlating data from multiple sinks can be a complex task.\nCorrelated data is often used during incident response. If there's a problem with correlating data from multiple sinks, make sure the triage runbook for this architecture addresses it and includes organizational points of contact if the problem extends beyond the workload resources. Workload administrators might require assistance from platform administrators to correlate log entries from enterprise networking, security, or other platform services.\nImportant\n**For the platform team:** Where possible, grant Azure role-based access control (Azure RBAC) to query and read log sinks for relevant platform resources. Enable firewall logs for network and application rule evaluations and DNS proxy because the application teams can use this information during troubleshooting tasks."
              },
              {
                "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
                "url": "",
                "excerpt": "# Baseline Microsoft Foundry chat reference architecture in an Azure landing zone\n## Monitor resources\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach aligns with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/architecture/baseline-microsoft-foundry-chat#monitoring).\nYou provision the following monitoring resources:\n1. Application Insights serves as the application performance management (APM) service for your team. You configure this service in the chat UI, Agent Service, and models.\n2. The Azure Monitor Logs workspace serves as the unified sink for all logs and metrics from workload-owned Azure resources.\nSimilar to the baseline architecture, all resources must send Azure diagnostics logs to the Azure Monitor Logs workspace that your team provisions. This configuration is part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Azure Monitor Logs workspace. In Azure landing zones, that workspace typically resides in the management subscription.\nThe platform team might have more processes that affect resources in the application landing zone. For example, they might use DINE policies to configure diagnostics and send logs to centralized management subscriptions. They might also apply [Azure Monitor baseline alerts](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/) through policy. Ensure that your implementation doesn't block these extra logging and alerting flows."
              },
              {
                "title": "Monitor Azure platform landing zone components",
                "url": "",
                "excerpt": "# Monitor Azure platform landing zone components\n## Azure landing zone monitoring guidance\nBaseline metric, activity log, and log query alerts are available for landing zone platform components and other selected landing zone components. These alerts ensure consistent alerting and monitoring for your Azure landing zone. They're based on Microsoft-recommended practices for proactive monitoring, such as setting up alerts, thresholds, and notifications for timely problem detection and response. Use the following guidance to achieve real-time visibility into the performance, utilization, and security of your platform landing zone implementation. Proactively address issues, optimize resource allocation, and ensure a reliable and secure environment.\n[![Diagram that shows Azure Monitor baseline alert topology.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg)](media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n[Diagram that shows the initiatives are applied at the platform management groups, connectivity, identity and management while the landing zone initiative is applied to the landing zones management group. The service health initiative and notifications assets initiative is applied at the intermediate root management group so that it is applied to all subscriptions.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-monitor-baseline-alerts-policy-initiative-flow.svg#lightbox)\n*Download a [Visio file](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/media/AMBA-Diagrams.vsdx) of this architecture.*\nThe following subsets of Azure components have one or more alerts defined:\n1. Azure ExpressRoute\n2. Azure Firewall\n3. Azure Virtual Network\n4. Azure Virtual WAN\n5. Azure Monitor Log Analytics workspace\n6. Azure Private DNS zone\n7. Azure Key Vault\n8. Azure Virtual Machine\n9. Azure Storage account\nFor more information, see [Alert details](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-overview).\nTo ensure that your organization's resources are properly monitored and secured, you also need to properly configure alerts and implement appropriate processes to respond to alerts. Configure action groups with the appropriate notification channels and test the alerts to ensure that they work as expected. In accordance with the Cloud Adoption Framework principle of subscription democratization, configure at least one action group for each subscription so that relevant staff is notified of alerts. As a minimum form of notification, the action group should include an email notification channel. If you use Azure Monitor alert processing rules to route alerts to one or more action groups, note that service health alerts don't support alert processing rules. Configure service health alerts directly with the action group."
              }
            ]
          },
          {
            "checklist_id": "E01.01",
            "title": "Centralize diagnostics and security visibility",
            "priority": 2,
            "blast_radius": "High",
            "caf_discipline": "Manage",
            "why_it_matters": "Improves operational insight, accelerates threat detection, and supports compliance reporting",
            "success_criteria": "Diagnostics coverage exceeds 30%; logs centralized in Log Analytics",
            "controls": [
              "a56888b2-7e83-4404-bd31-b886528502d1",
              "67e7a8ed-4b30-4e38-a3f2-9812b2363cef"
            ],
            "dependencies": [],
            "permission_requirements": [
              "Subscription contributor",
              "Log Analytics admin"
            ],
            "owner_role": "Cloud Operations Lead",
            "delivery_model": {
              "estimated_duration": "2 weeks",
              "team": [
                "Platform Engineering",
                "Security"
              ],
              "change_scope": "Subscription"
            },
            "learn_references": [
              {
                "title": "Design area: Security",
                "url": "",
                "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
              },
              {
                "title": "Protect your resources with Defender CSPM",
                "url": "",
                "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
              },
              {
                "title": "Prepare your landing zone for migration",
                "url": "",
                "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
              }
            ]
          },
          {
            "checklist_id": "F01.01",
            "title": "Apply baseline governance policies",
            "priority": 3,
            "blast_radius": "High",
            "caf_discipline": "Govern",
            "why_it_matters": "Enforces compliance, resource standards, and public IP governance to reduce risk",
            "success_criteria": "Policy compliance exceeds 50%; public IPs governed",
            "controls": [
              "3c5a808d-c695-4c14-a63c-c7ab7a510e41"
            ],
            "dependencies": [
              "A01.01"
            ],
            "permission_requirements": [
              "Management group policy admin"
            ],
            "owner_role": "Cloud Governance Lead",
            "delivery_model": {
              "estimated_duration": "2 weeks",
              "team": [
                "Platform Engineering"
              ],
              "change_scope": "ManagementGroup"
            },
            "learn_references": [
              {
                "title": "Management groups",
                "url": "",
                "excerpt": "# Management groups\n## Management group recommendations\n7. Create management groups under your landing zone management group to represent the types of workloads that you host. These groups are based on the security, compliance, connectivity, and feature needs of the workloads. With this grouping structure, you can have a set of Azure policies applied at the management group level. Use this grouping structure for all workloads that require the same security, compliance, connectivity, and feature settings.\n7.1. Use management groups to organize subscriptions by workload type, such as `online`, `corporate`, or `sandbox`. This organization helps you apply policies and RBAC roles that are specific to the workload type. For more information, see [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz).\n8. Limit the number of Azure Policy assignments at the root management group scope. This limitation minimizes debugging inherited policies in lower-level management groups.\n9. Use policies to enforce compliance requirements either at the management group or subscription scope to achieve policy-driven governance.\n10. Ensure that only privileged users can operate management groups in the tenant. Enable Azure RBAC authorization in the management group [hierarchy settings](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting-require-authorization) to refine user privileges. By default, all users can create their own management groups under the root management group.\n11. Configure a default, dedicated management group for new subscriptions. This group ensures that no subscriptions go under the root management group. This group is especially important if users have Microsoft Developer Network (MSDN) or Visual Studio benefits and subscriptions. A good candidate for this type of management group is a `sandbox` management group. For more information, see [Set a default management group](https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group).\n12. Don't create management groups for production, testing, and development environments. If necessary, separate these groups into different subscriptions in the same management group. For more information, see:\n12.1. [Manage application development environments in Azure landing zones](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-application-environments)\n12.2. [Testing approach for enterprise-scale management groups](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/testing-approach)"
              },
              {
                "title": "Design area: Azure governance",
                "url": "",
                "excerpt": "# Design area: Azure governance\n## Azure governance considerations\n3. Consider using [Microsoft Entra reports](https://learn.microsoft.com/en-us/entra/identity/monitoring-health/overview-monitoring-health) to govern activity.\n4. Consider sending Microsoft Entra ID logs to the central Azure Monitor Logs workspace for the platform.\n5. Explore Microsoft Entra ID Governance features, like [access reviews](https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview) and [entitlement management](https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview).\n### Non-Microsoft tooling\n1. Use [AzAdvertizer](https://www.azadvertizer.net) to get Azure governance updates. For example, you can find insights about policy definitions, initiatives, aliases, security, and regulatory compliance controls in Azure Policy or Azure RBAC role definitions. You can also get insight into resource provider operations, Microsoft Entra role definitions and role actions, and first-party API permissions.\n2. Use [Azure Governance Visualizer](https://github.com/azure/azure-governance-visualizer) to keep track of your technical governance estate. You can use the policy version checker feature for Azure landing zones to keep your environment up to date with the latest Azure landing zone policy release state.\n## Azure governance recommendations\n### Deployment acceleration recommendations\n1. Identify required Azure tags and use the append policy mode to enforce usage. For more information, see [Define your tagging strategy](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging).\n2. Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.\n3. Establish Azure Policy definitions at the top-level root management group because they might be assigned at inherited scopes.\n4. Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if necessary.\n5. Use Azure Policy to control resource provider registrations at the subscription or management group levels.\n6. Use built-in policies to minimize operational overhead.\n7. Assign the built-in Resource Policy Contributor role at a specific scope to enable application-level governance.\n8. Limit the number of Azure Policy assignments at the root management group scope to avoid managing exclusions at inherited scopes.\n### Cost management recommendations\n1. Use Cost Management to implement financial oversight on resources in your environment.\n2. Use tags, such as the cost center or project name, to append the resource metadata. This approach helps enable granular analysis of expenses.\n## Azure governance in the Azure landing zone reference architecture\nThe Azure landing zone reference architecture provides organizations with mature governance controls.\nFor example, you can implement:\n1. A management group hierarchy that groups resources by function or workload type. This approach encourages resource consistency.\n2. A rich set of Azure policies that enables governance controls at the management group level. This approach helps verify that all resources are in scope."
              },
              {
                "title": "Azure landing zone frequently asked questions (FAQ)",
                "url": "",
                "excerpt": "# Azure landing zone frequently asked questions (FAQ)\n## What does policy-driven governance mean, and how does it work?\n[Policy-driven governance](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles#policy-driven-governance) is one of the key design principles of enterprise-scale architecture.\nPolicy-driven governance means using Azure Policy to reduce the time you need for common and repeated operational tasks across your Azure tenant. Use many of the [Azure Policy effects](https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects), such as `Append`, `Deny`, `DeployIfNotExists`, and `Modify`, to prevent non-compliance by either restricting non-compliant resources (as defined by the policy definition) from being created or updated or by deploying resources or modifying settings of a resource creation or update request to make them compliant. Some effects, such as `Audit`, `Disabled`, and `AuditIfNotExists`, don't prevent or take action; they only audit and report on non-compliance.\nSome examples of policy-driven governance are:\n1. `Deny` effect: Prevents subnets from being created or updated to have no Network Security Groups associated with them.\n2. `DeployIfNotExists` effect: A new subscription (landing zone) is created and placed into a management group within your Azure landing zone deployment. Azure Policy ensures that Microsoft Defender for Cloud (formerly known as Azure Security Center) is enabled on the subscription. It also configures the diagnostic settings for Activity Log to send logs to the Log Analytics workspace in the Management subscription.\n  Instead of repeating code or manual activities when a new subscription is created, the `DeployIfNotExists` policy definition automatically deploys and configures them for you.\n## What if we can't or aren't yet ready to utilize DeployIfNotExists (DINE) policies?\nWe have a dedicated page that walks through the various phases and options you have to either \"disable\" DINE policies or use our three phase approach to adopt them over time within your environment.\nSee the guidance [Adopting policy driven guardrails](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/dine-guidance)"
              }
            ]
          },
          {
            "checklist_id": "D07.01",
            "title": "Implement hub-spoke network topology with centralized egress and DDoS protection",
            "priority": 4,
            "blast_radius": "High",
            "caf_discipline": "Ready",
            "why_it_matters": "Reduces attack surface, enables segmentation, and ensures secure connectivity for landing zones",
            "success_criteria": "Hub VNet, Azure Firewall, and DDoS Protection deployed; network segmentation achieved",
            "controls": [
              "e6c4cfd3-e504-4547-a244-7ec66138a720",
              "e8bbac75-7155-49ab-a153-e8908ae28c84",
              "088137f5-e6c4-4cfd-9e50-4547c2447ec6"
            ],
            "dependencies": [
              "A01.01",
              "E01.01"
            ],
            "permission_requirements": [
              "Network contributor",
              "Subscription owner"
            ],
            "owner_role": "Network Architect",
            "delivery_model": {
              "estimated_duration": "3 weeks",
              "team": [
                "Platform Engineering",
                "Network"
              ],
              "change_scope": "Subscription"
            },
            "learn_references": [
              {
                "title": "Hub-spoke network topology in Azure",
                "url": "",
                "excerpt": "# Hub-spoke network topology in Azure\n## Recommendations\nThe following recommendations apply to most scenarios. Follow these recommendations unless you have specific requirements that override them.\n### Resource groups, subscriptions, and regions\nThis example solution uses a single Azure resource group. You can also implement the hub and each spoke in different resource groups and subscriptions.\nWhen you peer virtual networks in different subscriptions, you can associate the subscriptions to the same or different Microsoft Entra tenants. This flexibility allows for decentralized management of each workload while maintaining shared services in the hub. See [Create a virtual network peering - Resource Manager, different subscriptions, and Microsoft Entra tenants](https://learn.microsoft.com/en-us/azure/virtual-network/create-peering-different-subscriptions).\n#### Azure landing zones\nThe [Azure landing zone architecture](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is based on the hub-spoke topology. In that architecture, a centralized platform team manages the hub's shared resources and network, while spokes share a co-ownership model with the platform team and the workload team that uses the spoke network. All hubs reside in a \"Connectivity\" subscription for centralized management, while spoke virtual networks exist across many individual workload subscriptions, called application landing zone subscriptions.\n### Virtual network subnets\nThe following recommendations outline how to configure the subnets on the virtual network.\n#### GatewaySubnet\nThe virtual network gateway requires this subnet. You can also use a hub-spoke topology without a gateway if you don't need cross-premises network connectivity.\n[Create a subnet named *GatewaySubnet* with an address range of at least `26`](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-about-virtual-network-gateways#gwsub). The `/26` address range gives the subnet enough scalability configuration options to prevent reaching the gateway size limitations in the future and to accommodate for a higher number of ExpressRoute circuits. For more information about setting up the gateway, see [Hybrid network using a VPN gateway](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager).\n#### AzureFirewallSubnet\nCreate a subnet named *AzureFirewallSubnet* with an address range of at least `/26`. Regardless of scale, the `/26` address range is the recommended size and covers any future size limitations. This subnet doesn't support network security groups (NSGs).\nAzure Firewall requires this subnet. If you use a partner network virtual appliance (NVA), follow its network requirements.\n### Spoke network connectivity"
              },
              {
                "title": "Network topology and connectivity",
                "url": "",
                "excerpt": "# Network topology and connectivity\n## Design area overview\nNetwork topology and connectivity are fundamental for organizations that are planning their landing zone design. Networking is central to almost everything inside a landing zone. It enables connectivity to other Azure services, external users, and on-premises infrastructure. Network topology and connectivity are in the [environmental group](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-areas#environment-design-areas) of Azure landing zone design areas. This grouping is based on their importance in core design and implementation decisions.\n[![Diagram of networking areas of ALZ conceptual Management Group Hierarchy.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/network-design-overview-mg.png)](media/network-design-overview-mg.png#lightbox)\nIn the [conceptual Azure landing zone architecture](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg), there are two main management groups hosting workloads: Corp and Online. These management groups serve distinct purposes in organizing and governing Azure subscriptions. The networking relationship between the various Azure landing zones management groups depends on the organization's specific requirements and network architecture.\nThe next few sections discuss the networking relationship between **Corp**, **Online**, and the **Connectivity** management groups in relation to what the Azure landing zone reference architecture provides.\n### What is the purpose of Connectivity, Corp, and Online Management Groups?\n1. **Connectivity management group**: This management group contains dedicated subscriptions for connectivity, commonly a single subscription for most organizations. These subscriptions host the Azure networking resources required for the platform, like Azure Virtual WAN, Virtual Network Gateways, Azure Firewall, and Azure DNS private zones. It's also where hybrid connectivity is established between the cloud and on-premises environments, using services like ExpressRoute etc.\n2. **Corp management group**: The dedicated management group for corporate landing zones. This group is intended to contain subscriptions that host workloads that require traditional IP routing connectivity or hybrid connectivity with the corporate network via the hub in the connectivity subscription and therefore form part of the same routing domain. Workloads such as internal systems aren't exposed directly to the internet, but may be exposed via reverse proxies etc., such as Application Gateways."
              },
              {
                "title": "How to deploy hub-and-spoke topology with Azure Firewall",
                "url": "",
                "excerpt": "# How to deploy hub-and-spoke topology with Azure Firewall\n## Create a connectivity configuration\nIn this task, you create a connectivity configuration that includes your network group and a routing rule collection. You can choose to enable [direct connectivity](https://learn.microsoft.com/azure/virtual-network-manager/concept-connectivity-configuration#enable-direct-connectivity) in the hub and spoke topology, or leave all communication to go through the hub virtual network and Azure firewall.\n1. In the network manager instance, select **Configurations** under **Settings** then select **Create connectivity configuration**.\n2. In the **Create a connectivity configuration** window, enter the connectivity configuration **Name** and **Description** on the **Basics** tab then select **Next: Topology >**.\n3. On the **Topology** tab, enter or select the following settings:\n | **Setting** | **Value** |\n | --- | --- |\n | **Topology** | Select **Hub and spoke**. |\n | **Hub** | Choose **Select a hub**.On the **Select a hub** page, choose your hub virtual network then select **Select**. |\n | **Spoke network groups** | Choose **+ Add**>**Add network groups**.On the **Add network groups** page, choose your network group then choose **Select**. |\n4. From the list of **Spoke network groups**, you can choose to enable **Direct connectivity** or **Global mesh**. Direct connectivity allows spoke virtual networks to communicate directly with each other. Global mesh allows all virtual networks to communicate with each other. Leaving these unchecked results in all spoke virtual networks communicating through the hub virtual network and Azure firewall.\n Important\n If you enable direct connectivity, you must have a routing configuration with direct routing within the virtual network. If you enable global mesh, you must have a routing configuration with global mesh enabled.\n ![Screenshot of Create a connectivity configuration for hub and spoke with direct connectivity.](https://learn.microsoft.com/azure/includes/media/virtual-network-manager-deploy-hub-spoke-topology/create-direct-connectivity-hub-spoke-configuration.png)\n5. Choose **Next: Visualization >** to review the connectivity configuration then select **Review + create** > **Create**."
              }
            ]
          },
          {
            "checklist_id": "G01.01",
            "title": "Expand Defender coverage and enforce security baseline",
            "priority": 5,
            "blast_radius": "High",
            "caf_discipline": "Secure",
            "why_it_matters": "Enhances threat protection and ensures consistent security posture across all workloads",
            "success_criteria": "Defender plans enabled for all eligible resources; security baseline policies enforced",
            "controls": [
              "77425f48-ecba-43a0-aeac-a3ac733ccc6a"
            ],
            "dependencies": [
              "E01.01",
              "F01.01"
            ],
            "permission_requirements": [
              "Security admin",
              "Subscription owner"
            ],
            "owner_role": "Security Architect",
            "delivery_model": {
              "estimated_duration": "2 weeks",
              "team": [
                "Security",
                "Platform Engineering"
              ],
              "change_scope": "Subscription"
            },
            "learn_references": [
              {
                "title": "Design area: Security",
                "url": "",
                "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
              },
              {
                "title": "Protect your resources with Defender CSPM",
                "url": "",
                "excerpt": "# Protect your resources with Defender CSPM\n## Enable the Defender CSPM plan\nWhen you enable Microsoft Defender for Cloud, you automatically get the protections offered by the Foundational CSPM capabilities. To access the other features provided by Defender CSPM, you need to enable the Defender CSPM plan on your subscription.\n**To enable the Defender CSPM plan on your subscription**:\n1. Sign in to the [Azure portal](https://portal.azure.com).\n2. Search for and select **Microsoft Defender for Cloud**.\n3. In the Defender for Cloud menu, select **Environment settings**.\n4. Select the relevant Azure subscription, AWS account, or GCP project.\n5. On the Defender plans page, toggle the Defender CSPM plan to **On**.\n6. Select **Save**."
              },
              {
                "title": "Prepare your landing zone for migration",
                "url": "",
                "excerpt": "# Prepare your landing zone for migration\n## Enable subscription vending\nThis section applies to organizations that want to automate their subscription provisioning process. If you manually manage your landing zone and subscription creation, you should establish your own process for creating subscriptions.\nWhen you begin migrating, you must create subscriptions for your workloads. Enable [subscription vending](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending) to automate and accelerate this process. When subscription vending is established, you should be able to create subscriptions quickly.\n## Prepare for Microsoft Defender for Cloud\nWhen you deploy your landing zone, you also set policies to enable [Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction) for your Azure subscriptions. Defender for Cloud provides security posture recommendations in its [secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls), which evaluates deployed resources against the Microsoft security baseline.\nYou don't need to implement additional technical configurations, but you should review the recommendations and design a plan to [improve your security posture](https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations) as you migrate resources. When you begin migrating resources into Azure, you should be ready to [implement security improvements](https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations) as part of your migration optimization.\n## Related resources\nConsider these additional resources to prepare for migration:\n1. [Prepare an initial corporate policy that's defined and well understood](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/guides/standard/initial-corporate-policy)\n2. [Create an adequate plan for Azure billing](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-entra-tenant)\n3. [Ensure that you have proper organizational alignment](https://learn.microsoft.com/azure/cloud-adoption-framework/plan/prepare-organization-for-cloud) and [a plan to manage it](https://learn.microsoft.com/azure/cloud-adoption-framework/manage/)\n4. [Define a naming convention](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming) and [tagging strategy](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging)"
              }
            ]
          },
          {
            "checklist_id": "B01.01",
            "title": "Integrate centralized identity logging and Entra ID diagnostics",
            "priority": 6,
            "blast_radius": "High",
            "caf_discipline": "Secure",
            "why_it_matters": "Enables access visibility, auditability, and supports compliance requirements",
            "success_criteria": "Identity logs centralized; diagnostics coverage for Entra ID exceeds 50%",
            "controls": [
              "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1"
            ],
            "dependencies": [
              "E01.01",
              "G01.01"
            ],
            "permission_requirements": [
              "Entra ID admin",
              "Log Analytics admin"
            ],
            "owner_role": "Identity Architect",
            "delivery_model": {
              "estimated_duration": "2 weeks",
              "team": [
                "Identity",
                "Security"
              ],
              "change_scope": "Tenant"
            },
            "learn_references": [
              {
                "title": "Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones",
                "url": "",
                "excerpt": "# Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones\n## Identity and access management services in Azure landing zones\nThe administration of identity and access management is a platform responsibility. Identity and access management services are fundamental to organizational security. Your organization can use Microsoft Entra ID to control administrative access and protect platform resources in Azure, by creating appropriate role assignments and enabling advanced services such as Conditional Access and Privileged Identity Management (PIM). This approach prevents unauthorized users from making changes to the identity configuration or to the security principals contained within Microsoft Entra ID and Active Directory.\nProvision landing zones so that application owners can choose either Microsoft Entra ID or AD DS and Domain Services to suit their workload needs. You might need to configure other services, depending on your identity solution. For example, you might need to enable and secure network connectivity from the application to the Identity virtual network. If you use a subscription-vending process, include this configuration information in your subscription request."
              },
              {
                "title": "Landing zone identity and access management",
                "url": "",
                "excerpt": "# Landing zone identity and access management\n## Design recommendations\n6. Consider whether platform administrators require permissions on application landing zones. If so, use Microsoft Entra PIM to control access to those resources, and assign the least-privileged permissions required. For example, a platform administrator might require access to a specific application landing zone to troubleshoot an issue but shouldn't have routine access to the application data or code. In this case, the platform administrator can request access to the application. A privileged role administrator approves the request, and the platform administrator is granted the required permissions for the specified time period. This approach helps enforce separation of duties and protects application landing zones from accidental or malicious misconfiguration.\n7. When you delegate administrative responsibility to others, such as application teams, consider whether they require the full set of privileges or only a subset. Follow the principle of least privilege (PoLP). For example, you might assign the User Access Administrator role or RBAC Administrator role to a user who needs to manage access to Azure resources but doesn't need to manage the resources themselves. To limit the identities, identity types, and roles that users can delegate and assign Azure RBAC assignments to, use [delegated role assignments with conditions](https://learn.microsoft.com/en-us/azure/role-based-access-control/delegate-role-assignments-overview). Application teams can use conditions to manage their own security principals within the constraints that the platform team sets. More privileged role assignments require escalation to the platform team. Consider the following factors when you use conditions to delegate RBAC roles:\n7.1. Review current role assignments for built-in and custom privileged roles and evaluate if you should add appropriate conditions to those existing assignments. For example, you can add conditions to the Subscription Owner and Application Owner custom roles that the Azure landing zone reference architecture provides. These conditions can restrict the principal types that they can assign roles to or limit specific roles that they can assign.\n7.2. Follow the PoLP when you add conditions to role assignments. For example, limit delegates to only assign roles to groups or enable delegates to assign all roles except privileged administrator roles like Owner, User Access Administrator, and RBAC Administrator.\n7.3. Build your own conditions if the available condition templates don't fulfill your requirements or policies.\n  [![Screenshot that shows the condition templates for RBAC constrained delegation.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/azure-landing-zone-rbac-conditions.png)](media/azure-landing-zone-rbac-conditions.png#lightbox)"
              },
              {
                "title": "Landing zone identity and access management",
                "url": "",
                "excerpt": "# Landing zone identity and access management\n## Design recommendations\n  For example, a user might routinely require limited administrative access to resources in an application landing zone. Occasionally, they might require the Owner role. You can create two security groups: Application Administrators and Application Owners. Assign the least-privilege roles to the Application Administrators group, and assign the owner role to the Application Owners role. Use PIM groups so the user can request the Owner role when required. At all other times, the user has only the permissions required to carry out their typical activities.\n5. Use [protected actions](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/protected-actions-overview) with Microsoft Entra PIM to add extra layers of protection. In Microsoft Entra ID, protected actions are permissions that are assigned [Conditional Access policies](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview). When a user attempts to perform a protected action, they must first satisfy the Conditional Access policies that are assigned to the required permissions. For example, to allow administrators to update cross-tenant access settings, you can require that they first satisfy the [phishing-resistant MFA policy](https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-admin-phish-resistant-mfa).\n## Identity and access management in the Azure landing zone reference architecture\nIdentity and access management are core features of Azure landing zone reference architecture implementation. The deployment includes a subscription dedicated to identity, where organizations can deploy AD DS domain controllers or other identity services, such as Microsoft Entra Connect servers, that are required for their environment. Not all organizations require services in the subscription. For example, some organizations might have applications that are already fully integrated with Microsoft Entra ID.\nThe identity subscription has a virtual network peered to the hub virtual network in the platform subscription. With this configuration, the platform team can manage the identity subscription, and application owners have access to identity services as required. You must secure the identity subscription and virtual network to protect identity services from unauthorized access.\nAzure landing zone reference architecture implementation also includes options to:\n1. Assign recommended policies to govern identity and domain controllers.\n2. Create a virtual network, and connect to the hub via virtual network peering.\n### Next steps"
              }
            ]
          }
        ],
        "backlog": {
          "epics": [
            {
              "epic_id": "EPIC-001",
              "title": "Platform and Landing Zone Governance",
              "checklist_id": "A01.01",
              "capabilities": [
                {
                  "capability": "Management group structure",
                  "features": [
                    "Platform management group creation",
                    "Landing zone management group creation",
                    "Subscription placement"
                  ]
                }
              ]
            },
            {
              "epic_id": "EPIC-002",
              "title": "Centralized Diagnostics and Security Visibility",
              "checklist_id": "E01.01",
              "capabilities": [
                {
                  "capability": "Diagnostics onboarding",
                  "features": [
                    "Log Analytics workspace setup",
                    "Resource diagnostic settings configuration",
                    "Security log aggregation"
                  ]
                }
              ]
            },
            {
              "epic_id": "EPIC-003",
              "title": "Baseline Governance Policy Enforcement",
              "checklist_id": "F01.01",
              "capabilities": [
                {
                  "capability": "Policy baseline",
                  "features": [
                    "Public IP governance policy",
                    "Resource compliance policy",
                    "Policy assignment and monitoring"
                  ]
                }
              ]
            },
            {
              "epic_id": "EPIC-004",
              "title": "Hub-Spoke Network Topology and Egress Control",
              "checklist_id": "D07.01",
              "capabilities": [
                {
                  "capability": "Network architecture",
                  "features": [
                    "Hub VNet deployment",
                    "Azure Firewall integration",
                    "DDoS Protection enablement",
                    "Spoke VNet onboarding"
                  ]
                }
              ]
            },
            {
              "epic_id": "EPIC-005",
              "title": "Defender Coverage and Security Baseline",
              "checklist_id": "G01.01",
              "capabilities": [
                {
                  "capability": "Security baseline",
                  "features": [
                    "Defender plan enablement",
                    "Security policy assignment",
                    "Security alert monitoring"
                  ]
                }
              ]
            },
            {
              "epic_id": "EPIC-006",
              "title": "Centralized Identity Logging and Diagnostics",
              "checklist_id": "B01.01",
              "capabilities": [
                {
                  "capability": "Identity diagnostics",
                  "features": [
                    "Entra ID log integration",
                    "Identity diagnostic settings",
                    "Access audit reporting"
                  ]
                }
              ]
            }
          ]
        },
        "maturity_trajectory": {
          "current_maturity_percent": 31.6,
          "projected_30_day_percent": 45,
          "projected_60_day_percent": 62,
          "projected_90_day_percent": 78,
          "assumptions": [
            "Management group structure and subscription placement completed in 30 days",
            "Diagnostics coverage and policy baseline achieved in 30 days",
            "Network topology and security baseline implemented in 60 days",
            "Identity log integration completed in 90 days",
            "No delays due to permission or tenant-root access"
          ]
        },
        "dependency_graph": [
          {
            "action": "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
            "depends_on": [],
            "phase": "30_days"
          },
          {
            "action": "Achieve centralized diagnostics and security visibility across all visible resources",
            "depends_on": [],
            "phase": "30_days"
          },
          {
            "action": "Apply baseline governance policies for public IP, resource compliance, and platform standards",
            "depends_on": [
              "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
            ],
            "phase": "30_days"
          },
          {
            "action": "Implement hub-spoke network topology with centralized egress, DDoS protection, and east-west traffic inspection",
            "depends_on": [
              "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization",
              "Achieve centralized diagnostics and security visibility across all visible resources"
            ],
            "phase": "60_days"
          },
          {
            "action": "Expand Defender coverage to all supported resource types and enforce security baseline policies",
            "depends_on": [
              "Achieve centralized diagnostics and security visibility across all visible resources",
              "Apply baseline governance policies for public IP, resource compliance, and platform standards"
            ],
            "phase": "60_days"
          },
          {
            "action": "Integrate centralized identity logging and Entra ID diagnostics for enhanced access visibility",
            "depends_on": [
              "Achieve centralized diagnostics and security visibility across all visible resources",
              "Expand Defender coverage to all supported resource types and enforce security baseline policies"
            ],
            "phase": "90_days"
          }
        ],
        "critical_path": [
          "Establish platform and landing zone management group hierarchy to enable policy inheritance and subscription organization"
        ]
      },
      "grounded_refs": [
        {
          "control_id": "a56888b2-7e83-4404-bd31-b886528502d1",
          "section": "Security",
          "question": "Centralized Security Visibility",
          "status": "Fail",
          "severity": "High",
          "evidence_count": 1,
          "risk_score": 7.88,
          "notes": "Centralized security visibility gaps: Diagnostics coverage 2.1% is low.",
          "references": [
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Networking\nWhen you deploy your workload in an application landing zone, you still have to implement network controls. Organizations might impose restrictions to safeguard against data exfiltration and ensure visibility for the central security operations center (SOC) and the IT network team.\nWith this approach, the platform team can optimize overall organizational spend by using centralized services, rather than deploying redundant security controls for each workload throughout the organization. In this architecture, Azure Firewall is an example of a central service. It's not cost-effective or practical for each workload team to manage their own firewall instance. We recommend a centralized approach to firewall management.\n#### Ingress traffic\nThe ingress traffic flow remains the same as the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#ingress-traffic).\nThe workload owner is responsible for any resources that are related to public internet ingress into your workload. For example, in this architecture, Application Gateway and its public IP are placed in the spoke network and not the hub network. Some organizations might place resources with ingress traffic in a connectivity subscription by using a centralized demilitarized (DMZ) implementation. Integration with that specific topology is out of scope for this article.\n#### Egress traffic\nIn the baseline architecture, workload virtual machine scale sets access the public internet through Azure Load Balancer, but that traffic isn't restricted.\nThat design is different in this architecture. All traffic that leaves the spoke virtual network is routed through the peered hub network via an egress firewall. A route is attached to all the possible subnets in the spoke network that directs all traffic for IPs not found in the local virtual network (*0.0.0.0/0*) to the hub's Azure Firewall.\n[![Diagram that shows the network layout in a hub-spoke topology.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-network-egress.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-network-egress.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-network-egress.vsdx) of this architecture.*\nWorkload communication to the private endpoint for Key Vault access remains the same as the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#egress-traffic). That path is omitted from the preceding diagram for brevity."
            },
            {
              "title": "Ready your Azure environment for workloads",
              "url": "",
              "excerpt": "# Ready your Azure environment for workloads\nBefore you can deploy workloads in Azure, it's important to prepare the underlying environment that supports them. This foundational setup is known as an [Azure landing zone](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is the recommended starting point to build your Azure environment. An Azure landing zone is a structured approach that helps you build a scalable, secure, and governed cloud environment from the start.\n[![Diagram showing the conceptual components of your cloud environment as it aligns with Azure landing zones.](https://learn.microsoft.com/azure/cloud-adoption-framework/_images/ready/azure-landing-zone-conceptual-diagram.png)](../_images/ready/azure-landing-zone-conceptual-diagram.png#lightbox)\nAn Azure landing zone helps you address key considerations such as identity and access management, customer agreements, and the configuration of core platform services. It provides a consistent framework for organizing both shared infrastructure and application-specific resources. At the heart of this model are two types of landing zones:\n## Platform landing zone\nThe platform landing zone serves as the backbone of your Azure environment. It establishes governance and central services that apply across your organization. Its functionality includes a management group hierarchy with Azure Policy enforcement across subscriptions. There are also dedicated subscriptions for connectivity, identity, management, and security shared services.\nDepending on your organization's size and cloud maturity, you might choose to implement all, some, or none of these centralized services. For smaller or cloud-native teams, a lightweight approach might be sufficient.\n## Application landing zone\nAn application landing zone is for workload resources. A workload should have an application landing zone for each environment (development, testing, or production). Each application landing zone consists of one or more subscriptions to accommodate scaling and service limits. They are nested under appropriate management groups, such as \"Online\" or \"Corp,\" to inherit Azure Policy definitions from the parent management group(s). This structure ensures that workloads are deployed in a controlled and consistent manner, while still allowing flexibility for individual workload needs.\n## Configurations that apply across all subscriptions\nWhether a subscription belongs to the platform or an application landing zone, certain configurations should be enabled universally. These configurations include: Azure Role-Based Access Control (RBAC), Cost Management, Network Watcher, and Microsoft Defender for Cloud. These services help maintain visibility, security, and operational control across your entire Azure environment."
            }
          ]
        },
        {
          "control_id": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
          "section": "Networking",
          "question": "DDoS Protection",
          "status": "Fail",
          "severity": "High",
          "evidence_count": 2,
          "risk_score": 7.7,
          "notes": "2 VNet(s) without DDoS Protection.",
          "references": [
            {
              "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
              "url": "",
              "excerpt": "# Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN\n## DDoS Protection Plan\n1. `ddos_protection_plan` - (Optional) An object defining the DDoS protection plan settings. When configured, this DDoS protection plan can be associated with hub virtual networks. The object has the following fields:\n1.1. `name` - (Optional) The name of the DDoS protection plan resource.\n1.2. `location` - (Optional) The Azure location where the DDoS protection plan should be created. This should typically match the location of the hub networks that will use it.\n1.3. `resource_group_name` - (Optional) The name of the resource group where the DDoS protection plan should be created.\n1.4. `tags` - (Optional) A map of tags to apply to the DDoS protection plan resource.\nType:\n```hcl\nobject({\n    enabled_resources = optional(object({\n      ddos_protection_plan = optional(bool, true)\n    }), {})\n    virtual_wan = optional(object({\n      name                              = optional(string)\n      location                          = optional(string)\n      resource_group_name               = optional(string)\n      type                              = optional(string, \"Standard\")\n      allow_branch_to_branch_traffic    = optional(bool, null)\n      disable_vpn_encryption            = optional(bool, false)\n      office365_local_breakout_category = optional(string, \"None\")\n      tags                              = optional(map(string), null)\n    }), {})\n    ddos_protection_plan = optional(object({\n      name                = optional(string)\n      location            = optional(string)\n      resource_group_name = optional(string)\n      tags                = optional(map(string), null)\n    }), {})\n  })\n```\nDefault: `{}`"
            },
            {
              "title": "Azure Landing Zones Platform Landing Zone Connectivity with Hub and Spoke Virtual Network",
              "url": "",
              "excerpt": "# Azure Landing Zones Platform Landing Zone Connectivity with Hub and Spoke Virtual Network\n## DDoS Protection Plan\n1.7. `private_dns_resolver` - (Optional) Should the private DNS resolver be created? Default `true`.\n2. `default_hub_address_space` - (Optional) The default address space to use if not specified in hub\\_virtual\\_network. This defaults to `10.0.0.0/16` and increments to the next /16 for each region if not supplied.\n3. `default_parent_id` - (Optional) The default parent resource group ID to use if not specified in hub\\_virtual\\_network or individual sections.\n4. `location` - (Required) The Azure location where the hub network resources should be created.\n5. `hub_virtual_network` - (Optional) The hub virtual network settings.\n6. `firewall` - (Optional) The firewall settings.\n7. `firewall_policy` - (Optional) The firewall policy settings.\n8. `bastion` - (Optional) The bastion host settings.\n9. `virtual_network_gateways` - (Optional) The virtual network gateway settings.\n10. `private_dns_zones` - (Optional) The private DNS zone settings.\n11. `private_dns_resolver` - (Optional) The private DNS resolver settings."
            }
          ]
        },
        {
          "control_id": "e6c4cfd3-e504-4547-a244-7ec66138a720",
          "section": "Networking",
          "question": "Azure Firewall Presence",
          "status": "Fail",
          "severity": "High",
          "evidence_count": 0,
          "risk_score": 7.0,
          "notes": "No Azure Firewall resources detected in visible subscriptions.",
          "references": [
            {
              "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
              "url": "",
              "excerpt": "# Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN\n## Azure Firewall\n1. `firewall` - (Optional) An object defining the Azure Firewall settings for the Virtual Hub. The object has the following fields:\n1.1. `name` - (Optional) The name of the Azure Firewall resource.\n1.2. `sku_name` - (Optional) The SKU name for the Azure Firewall. Possible values are `AZFW_Hub`, `AZFW_VNet`. Default `AZFW_Hub`.\n1.3. `sku_tier` - (Optional) The SKU tier for the Azure Firewall. Possible values are `Basic`, `Standard`, `Premium`. Default `Standard`.\n1.4. `zones` - (Optional) A list of availability zones for the Azure Firewall.\n1.5. `firewall_policy_id` - (Optional) The resource ID of the Azure Firewall Policy to associate with the firewall.\n1.6. `vhub_public_ip_count` - (Optional) The number of public IP addresses to assign to the Virtual Hub firewall.\n1.7. `tags` - (Optional) A map of tags to apply to the Azure Firewall."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "excerpt": "# Independent software vendor (ISV) considerations for Azure landing zones\n## Azure landing zone design principles and implementations\n[Azure's landing zone design principles](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles) recommend aligning with Azure-native platform capabilities such as Log Analytics, Azure Monitor, and Azure Firewall. The landing zone guidance also provides specific [Azure landing zone implementation options](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/implementation-options).\nAs an ISV, you might decide to implement your own landing zone environments. You might need to use your own automation to deploy Azure resources across subscriptions. Or you might want to continue using tools you already employ for logging, monitoring, and other platform-layer services.\nIf you do implement your own landing zone environments, we recommend that you use Azure landing zone guidance and sample implementations for reference, and align your approach with proven Azure landing zone designs."
            }
          ]
        },
        {
          "control_id": "e8bbac75-7155-49ab-a153-e8908ae28c84",
          "section": "Networking",
          "question": "Hub-Spoke Topology",
          "status": "Fail",
          "severity": "High",
          "evidence_count": 0,
          "risk_score": 7.0,
          "notes": "No hub VNet or Azure Firewall detected. Hub-spoke topology may not be implemented.",
          "references": [
            {
              "title": "Hub-spoke network topology in Azure",
              "url": "",
              "excerpt": "# Hub-spoke network topology in Azure\n## Recommendations\nThe following recommendations apply to most scenarios. Follow these recommendations unless you have specific requirements that override them.\n### Resource groups, subscriptions, and regions\nThis example solution uses a single Azure resource group. You can also implement the hub and each spoke in different resource groups and subscriptions.\nWhen you peer virtual networks in different subscriptions, you can associate the subscriptions to the same or different Microsoft Entra tenants. This flexibility allows for decentralized management of each workload while maintaining shared services in the hub. See [Create a virtual network peering - Resource Manager, different subscriptions, and Microsoft Entra tenants](https://learn.microsoft.com/en-us/azure/virtual-network/create-peering-different-subscriptions).\n#### Azure landing zones\nThe [Azure landing zone architecture](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/) is based on the hub-spoke topology. In that architecture, a centralized platform team manages the hub's shared resources and network, while spokes share a co-ownership model with the platform team and the workload team that uses the spoke network. All hubs reside in a \"Connectivity\" subscription for centralized management, while spoke virtual networks exist across many individual workload subscriptions, called application landing zone subscriptions.\n### Virtual network subnets\nThe following recommendations outline how to configure the subnets on the virtual network.\n#### GatewaySubnet\nThe virtual network gateway requires this subnet. You can also use a hub-spoke topology without a gateway if you don't need cross-premises network connectivity.\n[Create a subnet named *GatewaySubnet* with an address range of at least `26`](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-about-virtual-network-gateways#gwsub). The `/26` address range gives the subnet enough scalability configuration options to prevent reaching the gateway size limitations in the future and to accommodate for a higher number of ExpressRoute circuits. For more information about setting up the gateway, see [Hybrid network using a VPN gateway](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager).\n#### AzureFirewallSubnet\nCreate a subnet named *AzureFirewallSubnet* with an address range of at least `/26`. Regardless of scale, the `/26` address range is the recommended size and covers any future size limitations. This subnet doesn't support network security groups (NSGs).\nAzure Firewall requires this subnet. If you use a partner network virtual appliance (NVA), follow its network requirements.\n### Spoke network connectivity"
            },
            {
              "title": "Virtual WAN network topology in an Azure landing zone",
              "url": "",
              "excerpt": "# Virtual WAN network topology in an Azure landing zone\n## Create hub-and-spoke network architecture\nAzure Virtual WAN simplifies end-to-end network connectivity in Azure, and to Azure from on-premises, by creating a [hub-and-spoke network architecture](https://learn.microsoft.com/en-us/azure/virtual-wan/virtual-wan-global-transit-network-architecture). The architecture easily scales to support multiple Azure regions and on-premises locations (any-to-any connectivity) as shown in the following figure:\n![Diagram that illustrates a global transit network with Virtual WAN.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/media/global-transit.png)\n Diagram of a global transit network using Azure Virtual WAN. It shows two regions, Region 1 and Region 2, each containing multiple VNets connected to a Virtual WAN hub. The hubs are linked by a hub-to-hub connection for inter-region communication. Below each hub, icons represent branch offices and connectivity endpoints, including ExpressRoute and user devices. The layout emphasizes centralized hub connectivity for VNets within regions and global transit between regions.\n*Figure 2: Global transit network with Virtual WAN.*\nAzure Virtual WAN any-to-any transitive connectivity supports the following paths within the same region and across regions:\n1. Virtual network to virtual network\n2. Virtual network to branch\n3. Branch to virtual network\n4. Branch to branch\n**Constraints:** Virtual WAN hubs only support Microsoft-managed resources such as:\n1. Virtual network gateways (point-to-site VPN, site-to-site VPN, and Azure ExpressRoute)\n2. Azure Firewall via Firewall Manager\n3. Route tables\n4. Some [network virtual appliances (NVA)](https://learn.microsoft.com/en-us/azure/virtual-wan/about-nva-hub) for vendor-specific SD-WAN capabilities"
            }
          ]
        },
        {
          "control_id": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
          "section": "Security",
          "question": "Defender CWP Coverage",
          "status": "Partial",
          "severity": "High",
          "evidence_count": 1,
          "risk_score": 4.73,
          "notes": "14/18 Defender plans enabled (77.8%). Some plans still disabled.",
          "references": [
            {
              "title": "Deploy Azure Landing Zone for Nonprofits",
              "url": "",
              "excerpt": "# Deploy Azure Landing Zone for Nonprofits\nThe Azure Landing Zone for Nonprofits is a preconfigured, scalable foundation for managing cloud infrastructure in nonprofit organizations. It provides a blueprint for setting up core Azure services, such as networking, management, identity, and security. It ensures that cloud resources are efficiently managed and securely governed from the start. Its simple design offers nonprofit organizations a way to rapidly deploy cloud environments that align with best practices for scalability, security, and compliance.\nThe Azure Landing Zone for Nonprofits offers a comprehensive setup that includes management group structures, policy enforcement, logging, monitoring, and network connectivity. It integrates security features such as Microsoft Defender for Cloud, backup and disaster recovery services, and Azure Key Vault for secrets management. Deploying the landing zone gives you a secure, scalable foundation for your Azure resources, letting you focus on delivering mission-critical services while benefiting from strong governance and operational efficiency.\nFollow the steps in this article to deploy the Azure Landing Zone for Nonprofits using Azure Resource Manager templates (ARM templates). In this deployment, you configure core infrastructure elements such as management groups, log analytics, networking, Azure security, and more.\nThis image is a network diagram showing a hub and spoke deployment for identity management and connectivity subscription.\n![High-level diagram showing a hub and spoke deployment for identity management and connectivity subscription.](https://learn.microsoft.com/industry/nonprofit/media/azure-landing-zone-deployment.png)\nThese instructions help you successfully deploy an Azure landing zone tailored for nonprofit organizations, providing a scalable and secure platform for managing resources and workloads. The elevated permissions allow you to configure essential elements like management groups, network topology, and security settings.\nHave questions or need more help? See [Find a partner](https://www.microsoft.com/nonprofits/partners#azure)."
            },
            {
              "title": "Design area: Security",
              "url": "",
              "excerpt": "# Design area: Security\n## Security in the Azure landing zone reference architecture\nSecurity is at the core of the Azure landing zone reference architecture. As part of the implementation, many tools and controls are deployed to help organizations quickly achieve a security baseline.\nFor example, the following are included:\nTools:\n1. Microsoft Defender for Cloud, standard or free tier\n2. Microsoft Sentinel\n3. Azure DDoS Network Protection (optional)\n4. Azure Firewall\n5. Web Application Firewall (WAF)\n6. Privileged Identity Management (PIM)\nPolicies for online and corporate-connected landing zones:\n1. Enforce secure access, like HTTPS, to storage accounts\n2. Enforce auditing for Azure SQL Database\n3. Enforce encryption for Azure SQL Database\n4. Prevent IP forwarding\n5. Prevent inbound RDP from internet\n6. Ensure subnets are associated with NSG"
            }
          ]
        },
        {
          "control_id": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
          "section": "Security",
          "question": "Diagnostics Coverage",
          "status": "Fail",
          "severity": "Medium",
          "evidence_count": 1,
          "risk_score": 4.73,
          "notes": "Diagnostics coverage is 2.1% (sample=94). Most resources lack diagnostic settings.",
          "references": [
            {
              "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
              "url": "",
              "excerpt": "# Baseline Microsoft Foundry chat reference architecture in an Azure landing zone\n## Monitor resources\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach aligns with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/architecture/baseline-microsoft-foundry-chat#monitoring).\nYou provision the following monitoring resources:\n1. Application Insights serves as the application performance management (APM) service for your team. You configure this service in the chat UI, Agent Service, and models.\n2. The Azure Monitor Logs workspace serves as the unified sink for all logs and metrics from workload-owned Azure resources.\nSimilar to the baseline architecture, all resources must send Azure diagnostics logs to the Azure Monitor Logs workspace that your team provisions. This configuration is part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Azure Monitor Logs workspace. In Azure landing zones, that workspace typically resides in the management subscription.\nThe platform team might have more processes that affect resources in the application landing zone. For example, they might use DINE policies to configure diagnostics and send logs to centralized management subscriptions. They might also apply [Azure Monitor baseline alerts](https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/HowTo/deploy/Introduction-to-deploying-the-ALZ-Pattern/) through policy. Ensure that your implementation doesn't block these extra logging and alerting flows."
            },
            {
              "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
              "url": "",
              "excerpt": "# Azure Virtual Machines baseline architecture in an Azure landing zone\n## Monitoring\nThe Azure landing zone platform provides shared observability resources as part of the management subscription. However, we recommend that you provision your own monitoring resources to facilitate ownership responsibilities of the workload. This approach is consistent with the [baseline architecture](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/baseline#monitoring).\nThe workload team provisions the monitoring resources, which include:\n1. Application Insights as the application performance monitoring (APM) service for the workload team.\n2. The Log Analytics workspace as the unified sink for all logs and metrics that are collected from workload-owned Azure resources and the application code.\n[![Diagram that shows monitoring resources for the workload.](https://learn.microsoft.com/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg)](/en-us/azure/architecture/virtual-machines/media/baseline-landing-zone-monitoring.svg#lightbox)*Download a [Visio file](https://arch-center.azureedge.net/baseline-landing-zone-monitoring.vsdx) of this architecture.*\nSimilar to the baseline, all resources are configured to send Azure Diagnostics logs to the Log Analytics workspace that the workload team provisions as part of the infrastructure as code (IaC) deployment of the resources. You might also need to send logs to a central Log Analytics workspace. In Azure landing zones, that workspace is in the management subscription.\nThe platform team might also have DINE policies that they can use to configure Diagnostics to send logs to their centralized management subscriptions. It's important to ensure that your implementation doesn't restrict the additional log flows.\n### Correlate data from multiple sinks\nThe workload's logs and metrics and its infrastructure components are stored in the workload's Log Analytics workspace. However, logs and metrics that centralized services, such as Azure Firewall, Microsoft Entra ID, and Azure Bastion, generate are stored in a central Log Analytics workspace. Correlating data from multiple sinks can be a complex task.\nCorrelated data is often used during incident response. If there's a problem with correlating data from multiple sinks, make sure the triage runbook for this architecture addresses it and includes organizational points of contact if the problem extends beyond the workload resources. Workload administrators might require assistance from platform administrators to correlate log entries from enterprise networking, security, or other platform services.\nImportant\n**For the platform team:** Where possible, grant Azure role-based access control (Azure RBAC) to query and read log sinks for relevant platform resources. Enable firewall logs for network and application rule evaluations and DNS proxy because the application teams can use this information during troubleshooting tasks."
            }
          ]
        },
        {
          "control_id": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
          "section": "Security",
          "question": "Diagnostics for Identity (Entra ID)",
          "status": "Fail",
          "severity": "Medium",
          "evidence_count": 1,
          "risk_score": 4.73,
          "notes": "Low diagnostics coverage (2.1%) suggests Entra ID logs may not be centralized.",
          "references": [
            {
              "title": "Identity and access management considerations for the App Service landing zone accelerator",
              "url": "",
              "excerpt": "# Identity and access management considerations for the App Service landing zone accelerator\n## Design recommendations\n4. Use system-assigned [managed identities](https://learn.microsoft.com/en-us/azure/app-service/overview-managed-identity) to access, with enhanced security, back-end resources that are protected by Microsoft Entra ID. Doing so allows you to control which resources the App Service solution has access to and what permissions it has for those resources.\n5. For automated deployment, set up a [service principal](https://learn.microsoft.com/en-us/entra/identity-platform/app-objects-and-service-principals) that has the minimum required permissions to deploy from the CI/CD pipeline.\n6. Enable diagnostic logging AppServiceHTTPLogs access logs for App Service. You can use these detailed logs to diagnose problems with your app and monitor access requests. Enabling these logs also provides an Azure Monitor activity log that gives you insight into subscription-level events.\n7. Follow the recommendations outlined in the [Identity management](https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/app-service-security-baseline?toc=/azure/app-service/toc.json#identity-management) and [Privileged access](https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/app-service-security-baseline?toc=/azure/app-service/toc.json#privileged-access) sections of the Azure security baseline for App Service.\nThe goal of identity and access management for the landing zone accelerator is to help ensure that the deployed app and its associated resources are secure and can be accessed only by authorized users. Doing so can help you protect sensitive data and prevent misuse of the app and its resources."
            },
            {
              "title": "Landing zone identity and access management",
              "url": "",
              "excerpt": "# Landing zone identity and access management\n## Design recommendations\n5.2. When you grant access to resources, use Microsoft Entra-only groups for Azure control-plane resources. Both Entra-only users and groups, and those synchronized from on-premises using Microsoft Entra Connect, can be added to an Entra-only group. Add on-premises groups to the Microsoft Entra-only group if a group management system is already in place. Using Entra-only groups helps protect the cloud control plane from unauthorized modification of on-premises directory services. Note that *Microsoft Entra-only* is also known as *cloud only*.\n6. Create [emergency-access](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access) accounts, or break-glass accounts, to avoid accidentally being locked out of your Microsoft Entra ID organization. Emergency-access accounts are highly privileged and are only assigned to specific individuals. Store the credentials for the accounts securely, monitor their use, and test them regularly to ensure that you can use them if there's a disaster.\n  For more information, see [Secure access practices for administrators in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning).\n### Microsoft Entra ID recommendations\n1. [Integrate Microsoft Entra ID with Azure Monitor](https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs) so you can analyze your sign-in activity and the audit trail of changes within your tenant. Configure a diagnostic setting to send sign-in logs and audit logs to the platform central Azure Monitor Logs workspace in the management subscription.\n2. Use the entitlement management feature of Microsoft Entra ID Governance to [create access packages](https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview) that control group membership via automatic approval processes and regular access reviews for privileged group members.\n3. Use [Microsoft Entra built-in roles](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference) to manage the following identity settings from a tenant level:\n  | Role | Description | Note |\n  | --- | --- | --- |\n  | Global Administrator | Manages all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities. | Don't assign more than five people to this role. |"
            }
          ]
        },
        {
          "control_id": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
          "section": "Networking",
          "question": "Public IP Governance",
          "status": "Fail",
          "severity": "Medium",
          "evidence_count": 1,
          "risk_score": 4.41,
          "notes": "1 public IP(s) detected. Review for policy alignment.",
          "references": [
            {
              "title": "Implement controls and principles in SLZ",
              "url": "",
              "excerpt": "# Implement controls and principles in SLZ\n## Management Group hierarchy in SLZ\n| Management Group | Parent Management Group | Data classification most suited | Networking model | Controls| \n|  --- | --- | --- | --- | ---  |\n| `Public` | `Landing Zones` | Public/General | Internet only, no Layer 3 connectivity to other application landing zone subscriptions | ALZ defaults + Organization specific |\n| `Online` | `Landing Zones` | General/Confidential | Internet, with controlled connectivity via the connectivity hub to other application landing zone subscriptions | ALZ defaults + L1 + L2 + Organization specific |\n| `Corp` | `Landing Zones` | General/Confidential | Internal only, controlled connectivity via the connectivity hub to other application landing zone subscriptions | ALZ defaults + L1 + L2 + Organization specific |\n| `Confidential Online` | `Landing Zones` | Highly Confidential/Secret | Internet, controlled connectivity via the connectivity hub to other application landing zone subscriptions | ALZ defaults + L1 + L2 + L3 + Organization specific |\n| `Confidential Corp` | `Landing Zones` | Highly Confidential/Secret | Internal only, controlled connectivity via the connectivity hub to other application landing zone subscriptions | ALZ defaults+ L1 + L2 + L3 + Organization specific |\n\nTip\nYou can find information on defining your organization's data classification model in the [Well-Architected Framework: Architecture strategies for data classification](https://learn.microsoft.com/en-us/azure/well-architected/security/data-classification).\n#### Public\nAs most sovereign controls apply to business workloads, the Public management group is introduced to host publicly available information. Publicly available information shouldn't be restricted by sovereign controls such as data residency or encryption at rest or in use, which is why this management group has only standard security policies. While services hosted in this management group are less restricted, it's recommended not to allow any private network connectivity from these workloads into the Online/Corp and Confidential Online/Confidential Corp services. Any required communication should follow a zero-trust principle. In some cases, it might be possible to use private endpoints from services hosted in these management groups to make them available to Public management groupâ€“hosted applications. Otherwise, API calls to workloads in Online and Confidential Online are also possible. These network restrictions help ensure full isolation between sovereign and highly controlled workloads and publicly available services.\n#### Online / Confidential Online"
            },
            {
              "title": "Design area: Azure governance",
              "url": "",
              "excerpt": "# Design area: Azure governance\n## Design area review\nThe [Azure landing zones Bicepâ€”Deployment flow](https://github.com/Azure/ALZ-Bicep/wiki/DeploymentFlow) repository contains Bicep deployment templates that can accelerate your greenfield and brownfield Azure landing zone deployments. These templates have integrated Microsoft proven-practice governance guidance.\nConsider using the [Azure landing zone default policy assignments](https://github.com/Azure/ALZ-Bicep/tree/main/infra-as-code/bicep/modules/policy/assignments/alzDefaults) Bicep module to get a head start on ensuring compliance for your Azure environments.\nFor more information, see [Brownfield environment considerations](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/brownfield-considerations).\n## Design area overview\nYour organization's cloud adoption journey starts with strong controls for government environments.\nGovernance provides mechanisms and processes for maintaining control over platforms, applications, and resources in Azure.\n[![Diagram that shows the landing zone governance design.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/media/lz-design.png)](../../enterprise-scale/media/lz-design.png#lightbox)\nExplore the following considerations and recommendations to make informed decisions as you plan your landing zone.\nThe governance design area focuses on design decisions for your landing zone. For information about governance processes and tools, see [Govern in the Cloud Adoption Framework for Azure](https://learn.microsoft.com/azure/cloud-adoption-framework/govern/)."
            }
          ]
        },
        {
          "control_id": "61623a76-5a91-47e1-b348-ef254c27d42e",
          "section": "Governance",
          "question": "Platform Management Group",
          "status": "Fail",
          "severity": "Medium",
          "evidence_count": 1,
          "risk_score": 4.1,
          "notes": "No Platform management group detected under root.",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "excerpt": "# Management groups\n## Management groups in the Azure landing zone architecture\n| Management group | Description| \n|  --- | ---  |\n| **Connectivity** | This management group contains a dedicated subscription for connectivity. This subscription hosts the Azure networking resources, like Azure Virtual WAN, Azure Firewall, and Azure DNS private zones, that the platform requires.You can use various resource groups to contain resources, such as virtual networks, firewall instances, and virtual network gateways, that are deployed in different regions. Some large deployments might have subscription quota restrictions for connectivity resources. You can create dedicated subscriptions in each region for their connectivity resources. |\n| **Identity** | This management group contains a dedicated subscription for identity. This subscription is a placeholder for Active Directory Domain Services (AD DS) virtual machines (VMs) or Microsoft Entra Domain Services. You can use various resource groups to contain resources, such as virtual networks and VMs, that are deployed in different regions. The subscription also enables AuthN or AuthZ for workloads within the landing zones. Assign specific Azure policies to harden and manage the resources in the identity subscription. Some large deployments might have subscription quota restrictions for connectivity resources. You can create dedicated subscriptions in each region for their connectivity resources. |\n| **Landing zones** | The parent management group that contains all the landing zone child management groups. It has workload-agnostic Azure policies assigned to ensure that workloads are secure and compliant. |\n| **Online** | The dedicated management group for online landing zones. This group is for workloads that might require direct internet inbound or outbound connectivity or for workloads that might not require a virtual network. |\n| **Corp** | The dedicated management group for corporate landing zones. This group is for workloads that require connectivity or hybrid connectivity with the corporate network via the hub in the connectivity subscription. |\n| **Sandboxes** | The dedicated management group for subscriptions. An organization uses sandboxes for testing and exploration. These subscriptions are securely isolated from the corporate and online landing zones. Sandboxes also have a less restrictive set of policies assigned to enable testing, exploration, and configuration of Azure services. |\n| **Decommissioned** | The dedicated management group for canceled landing zones. You move canceled landing zones to this management group, and then Azure deletes them after 30-60 days. |\n\nNote\nFor many organizations, the default `Corp` and `Online` management groups provide an ideal starting point. Some organizations need to add more management groups.\nIf you want to change the management group hierarchy, see [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz)."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "excerpt": "# Independent software vendor (ISV) considerations for Azure landing zones\n## Management groups\nThis management approach is similar to the [testing approach for enterprise-scale landing zones](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/testing-approach#example-scenarios-and-outcomes). However, rather than creating *Contoso* and *Contoso-Canary* under the **Tenant root group**, in this approach the example company would create the product-specific *Contoso-SaaS-Product-01*, *Contoso-SaaS-Product-02*, and *Contoso-SaaS-Product-03* top-level management groups under it instead. This scenario is illustrated in the following diagram:\n![Diagram that shows top-level management group options with a single management group and separate management groups for each of the SaaS products](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/media/isv-landing-zone/isv-top-level-management-group.png)\n### Platform management group\nIn the [Azure landing zone resource organization hierarchy](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-alz), the **Platform** management group contains all Azure subscriptions that host components and shared services used by workloads in the landing zone subscriptions. Examples of components deployed into the platform and shared services subscriptions include centralized logging infrastructure (such as Log Analytics workspaces), DevOps, security, automation tooling, central networking resources (such as hub-VNet and DDos Protection plans), and an ISV's control plane services.\nThe **Platform** management group is frequently partitioned into **Identity**, **Management**, and **Connectivity** child groups to provide convenient separation of roles and policies for enterprise customers.\nIn your organization, you might have a single team that manages all shared platform components like identity, networking, and management. If so, and if you have no plans to separate that management across multiple teams, then consider using a single **Platform** management group.\nIf you instead will have separate teams that manage different parts of your centralized platform, you should deploy further levels in the management group hierarchy under the **Platform** management group. This allows you to assign separate policies for each part of your centralized platform.\nThe following diagram illustrates two potential implementations of the **Platform** management group. Option A shows a more comprehensive scenario, where the **Platform** management group contains three child management groups: **Management and DevOps**, **Identity and Security**, and **Connectivity**. Each child management group contains a subscription with the relevant resources. Option B shows a more simple scenario, where the **Platform** management group contains a single platform subscription.\nNote"
            }
          ]
        },
        {
          "control_id": "92481607-d5d1-4e4e-9146-58d3558fd772",
          "section": "Governance",
          "question": "Landing Zones Management Group",
          "status": "Fail",
          "severity": "Medium",
          "evidence_count": 1,
          "risk_score": 4.1,
          "notes": "No Landing Zones management group detected.",
          "references": [
            {
              "title": "Management groups",
              "url": "",
              "excerpt": "# Management groups\n## Management groups in the Azure landing zone architecture\n| Management group | Description| \n|  --- | ---  |\n| **Connectivity** | This management group contains a dedicated subscription for connectivity. This subscription hosts the Azure networking resources, like Azure Virtual WAN, Azure Firewall, and Azure DNS private zones, that the platform requires.You can use various resource groups to contain resources, such as virtual networks, firewall instances, and virtual network gateways, that are deployed in different regions. Some large deployments might have subscription quota restrictions for connectivity resources. You can create dedicated subscriptions in each region for their connectivity resources. |\n| **Identity** | This management group contains a dedicated subscription for identity. This subscription is a placeholder for Active Directory Domain Services (AD DS) virtual machines (VMs) or Microsoft Entra Domain Services. You can use various resource groups to contain resources, such as virtual networks and VMs, that are deployed in different regions. The subscription also enables AuthN or AuthZ for workloads within the landing zones. Assign specific Azure policies to harden and manage the resources in the identity subscription. Some large deployments might have subscription quota restrictions for connectivity resources. You can create dedicated subscriptions in each region for their connectivity resources. |\n| **Landing zones** | The parent management group that contains all the landing zone child management groups. It has workload-agnostic Azure policies assigned to ensure that workloads are secure and compliant. |\n| **Online** | The dedicated management group for online landing zones. This group is for workloads that might require direct internet inbound or outbound connectivity or for workloads that might not require a virtual network. |\n| **Corp** | The dedicated management group for corporate landing zones. This group is for workloads that require connectivity or hybrid connectivity with the corporate network via the hub in the connectivity subscription. |\n| **Sandboxes** | The dedicated management group for subscriptions. An organization uses sandboxes for testing and exploration. These subscriptions are securely isolated from the corporate and online landing zones. Sandboxes also have a less restrictive set of policies assigned to enable testing, exploration, and configuration of Azure services. |\n| **Decommissioned** | The dedicated management group for canceled landing zones. You move canceled landing zones to this management group, and then Azure deletes them after 30-60 days. |\n\nNote\nFor many organizations, the default `Corp` and `Online` management groups provide an ideal starting point. Some organizations need to add more management groups.\nIf you want to change the management group hierarchy, see [Tailor the Azure landing zone architecture to meet requirements](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/tailoring-alz)."
            },
            {
              "title": "Independent software vendor (ISV) considerations for Azure landing zones",
              "url": "",
              "excerpt": "# Independent software vendor (ISV) considerations for Azure landing zones\n## Management groups\nPlease note that the **Security** management group that was recently added to the Azure landing zone is currently not show in the below diagrams. However, it is recommended to include a separate **Security** management group under the **Platform** management group for ISVs, just the same as the **Management** management group.\nThe **Security** management group will be shown in future updates to this document and associated diagrams.\n![Diagram that shows two management group hierarchies. Option A shows separate platform management groups for management, connectivity, and identity. Option B includes a platform management group option with a single management group.](https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/media/isv-landing-zone/isv-platform-management-group.png)\n### Landing Zones management group\nThe **Landing Zones** management group contains the Azure subscriptions that host your SaaS solution's actual subsystems and workloads.\nThis management group contains one or more child management groups. Each of the child management groups under **Landing Zones** represents a workload or subsystem *archetype*, with consistent policy and access requirements that should apply to all subscriptions. Reasons for using multiple archetypes include:\n1. **Compliance:** If a subsystem of your SaaS product needs to be PCI-DSS compliant, consider creating a **PCI DSS** archetype child management group under **Landing Zones**. All Azure subscriptions that contain resources within the scope of PCI-DSS compliance should be placed within that management group.\n2. **Tiers:** Consider creating separate landing zone archetypes for your SaaS solution's *dedicated* tier customers and *free* tier customers. Each of the child management groups contains different Azure Policy settings. For example, the policies in the free tier might restrict deployments to only enable specific virtual machine SKUs, and the policies in the dedicated tier might require resources to be deployed into specific regions.\n### Environment-specific management groups\nSaaS ISVs often organize their cloud environments by modeling their software development lifecycle environments in a sequence. This commonly requires deployment first to a *Development* environment, then to a *Test* environment, then to a *Staging* environment, and finally to a *Production* environment.\nOne common difference between the environments is their Azure RBAC rules, like who can access each group of subscriptions. For example, the DevOps, SaaSOps, development, and test teams might all have different levels of access to different environments.\nImportant"
            }
          ]
        }
      ],
      "grounding_context": {
        "initiatives": [
          {
            "title": "Establish platform and landing zone management group hierarchy",
            "checklist_id": "A01.01",
            "references": [
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Monitor Azure platform landing zone components",
                "url": ""
              }
            ]
          },
          {
            "title": "Centralize diagnostics and security visibility",
            "checklist_id": "E01.01",
            "references": [
              {
                "title": "Design area: Security",
                "url": ""
              },
              {
                "title": "Protect your resources with Defender CSPM",
                "url": ""
              },
              {
                "title": "Prepare your landing zone for migration",
                "url": ""
              }
            ]
          },
          {
            "title": "Apply baseline governance policies",
            "checklist_id": "F01.01",
            "references": [
              {
                "title": "Management groups",
                "url": ""
              },
              {
                "title": "Design area: Azure governance",
                "url": ""
              },
              {
                "title": "Azure landing zone frequently asked questions (FAQ)",
                "url": ""
              }
            ]
          },
          {
            "title": "Implement hub-spoke network topology with centralized egress and DDoS protection",
            "checklist_id": "D07.01",
            "references": [
              {
                "title": "Hub-spoke network topology in Azure",
                "url": ""
              },
              {
                "title": "Network topology and connectivity",
                "url": ""
              },
              {
                "title": "How to deploy hub-and-spoke topology with Azure Firewall",
                "url": ""
              }
            ]
          },
          {
            "title": "Expand Defender coverage and enforce security baseline",
            "checklist_id": "G01.01",
            "references": [
              {
                "title": "Design area: Security",
                "url": ""
              },
              {
                "title": "Protect your resources with Defender CSPM",
                "url": ""
              },
              {
                "title": "Prepare your landing zone for migration",
                "url": ""
              }
            ]
          },
          {
            "title": "Integrate centralized identity logging and Entra ID diagnostics",
            "checklist_id": "B01.01",
            "references": [
              {
                "title": "Hybrid identity with Active Directory and Microsoft Entra ID in Azure landing zones",
                "url": ""
              },
              {
                "title": "Landing zone identity and access management",
                "url": ""
              },
              {
                "title": "Landing zone identity and access management",
                "url": ""
              }
            ]
          }
        ],
        "gaps": [
          {
            "control_id": "a56888b2-7e83-4404-bd31-b886528502d1",
            "question": "Centralized Security Visibility",
            "references": [
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Ready your Azure environment for workloads",
                "url": ""
              }
            ]
          },
          {
            "control_id": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "question": "DDoS Protection",
            "references": [
              {
                "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
                "url": ""
              },
              {
                "title": "Azure Landing Zones Platform Landing Zone Connectivity with Hub and Spoke Virtual Network",
                "url": ""
              }
            ]
          },
          {
            "control_id": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "question": "Azure Firewall Presence",
            "references": [
              {
                "title": "Azure Landing Zones Platform Landing Zone Connnectivity with Virtual WAN",
                "url": ""
              },
              {
                "title": "Independent software vendor (ISV) considerations for Azure landing zones",
                "url": ""
              }
            ]
          },
          {
            "control_id": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "question": "Hub-Spoke Topology",
            "references": [
              {
                "title": "Hub-spoke network topology in Azure",
                "url": ""
              },
              {
                "title": "Virtual WAN network topology in an Azure landing zone",
                "url": ""
              }
            ]
          },
          {
            "control_id": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "question": "Defender CWP Coverage",
            "references": [
              {
                "title": "Deploy Azure Landing Zone for Nonprofits",
                "url": ""
              },
              {
                "title": "Design area: Security",
                "url": ""
              }
            ]
          },
          {
            "control_id": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "question": "Diagnostics Coverage",
            "references": [
              {
                "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": ""
              }
            ]
          },
          {
            "control_id": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "question": "Diagnostics for Identity (Entra ID)",
            "references": [
              {
                "title": "Identity and access management considerations for the App Service landing zone accelerator",
                "url": ""
              },
              {
                "title": "Landing zone identity and access management",
                "url": ""
              }
            ]
          },
          {
            "control_id": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "question": "Public IP Governance",
            "references": [
              {
                "title": "Implement controls and principles in SLZ",
                "url": ""
              },
              {
                "title": "Design area: Azure governance",
                "url": ""
              }
            ]
          },
          {
            "control_id": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "question": "Platform Management Group",
            "references": [
              {
                "title": "Management groups",
                "url": ""
              },
              {
                "title": "Independent software vendor (ISV) considerations for Azure landing zones",
                "url": ""
              }
            ]
          },
          {
            "control_id": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "question": "Landing Zones Management Group",
            "references": [
              {
                "title": "Management groups",
                "url": ""
              },
              {
                "title": "Independent software vendor (ISV) considerations for Azure landing zones",
                "url": ""
              }
            ]
          }
        ],
        "target_execution_units": [
          {
            "capability": "Management group hierarchy",
            "phase": "",
            "references": [
              {
                "title": "Management groups",
                "url": ""
              },
              {
                "title": "Manage application development environments in Azure landing zones",
                "url": ""
              }
            ]
          },
          {
            "capability": "Platform team establishment",
            "phase": "",
            "references": [
              {
                "title": "Deploy Azure landing zones",
                "url": ""
              },
              {
                "title": "Azure Integration Services application landing zone accelerator in an Azure landing zone",
                "url": ""
              }
            ]
          },
          {
            "capability": "Policy baseline",
            "phase": "",
            "references": [
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Monitor Azure platform landing zone components",
                "url": ""
              }
            ]
          },
          {
            "capability": "Hub-spoke network topology",
            "phase": "",
            "references": [
              {
                "title": "Hub-spoke network topology in Azure",
                "url": ""
              },
              {
                "title": "Virtual WAN network topology in an Azure landing zone",
                "url": ""
              }
            ]
          },
          {
            "capability": "Defender for Cloud coverage",
            "phase": "",
            "references": [
              {
                "title": "Deploy Azure Landing Zone for Nonprofits",
                "url": ""
              },
              {
                "title": "Design area: Security",
                "url": ""
              }
            ]
          },
          {
            "capability": "Centralized logging workspace",
            "phase": "",
            "references": [
              {
                "title": "Baseline Microsoft Foundry chat reference architecture in an Azure landing zone",
                "url": ""
              },
              {
                "title": "Azure Virtual Machines baseline architecture in an Azure landing zone",
                "url": ""
              }
            ]
          },
          {
            "capability": "Diagnostic settings coverage",
            "phase": "",
            "references": [
              {
                "title": "terraform-azurerm-avm-ptn-aiml-landing-zone",
                "url": ""
              },
              {
                "title": "terraform-azurerm-avm-ptn-aiml-landing-zone",
                "url": ""
              }
            ]
          },
          {
            "capability": "Entra ID logging integration",
            "phase": "",
            "references": [
              {
                "title": "Incorporate Zero Trust practices in your landing zone",
                "url": ""
              },
              {
                "title": "Landing zone identity and access management",
                "url": ""
              }
            ]
          }
        ]
      }
    }
  },
  "delta": {
    "has_previous": false,
    "count": 0,
    "changed_controls": []
  }
}